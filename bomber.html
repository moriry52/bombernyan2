<!DOCTYPE html>

<html>

<head>

    <title>Bomber Nyan</title>
    <meta name="viewport" content="width=400,user-scalable=no">
    <meta http-equiv="content-type" charset="utf-8">

    <style type="text/css">
        <!--
        html,
        body {
            position: relative;
            font-family: arial;
            overflow: hidden;
            width: 100%;
            height: 100%;
            background: linear-gradient(#80ff00, #208000);
            background-size: cover;
            padding: 0px;
            margin: 0px;
        }

        div {
            padding: 0px;
            margin: 0px;
            border: none;
        }

        .field0 {
            background-color: transparent;
        }

        .field1 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAANlBMVEWCrTiLtDqErziHsDmOtzt9qDZ/qjeIsjqAqzd6pjWRujyApzZ0nzN7oTSWvD1/pDV2ozRvmjLp3R8uAAAAv0lEQVQ4y+3SuZEDQQwDQIDgN8/qyT/ZO3mq2RRksdogCgZgCYtsy4GAUKexsXLRTUUwwk6jKM6Hu3N+vvI02FjL6hOdr6adRnYswMYOPo2t0wA4p3Wa5F5eN2sjKZkiMNA8jTS5sbCva4z3ttPoWVQJBBxyO422GB3jWv6gInUaXW0X9QToitfNn+uPqXReAVfc7NOJiI7/VgvbTgNeY1m8u5IYsptZLSmtmnROPw0GLHY8E4WX4ebfHn57+PYfTScURR+VsCQAAAAASUVORK5CYII=");
        }

        .field2 {
            background-color: #011533;
        }

        .field3 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAADFBMVEV/cm6UhYFgTUxWRkaAbKUrAAAAc0lEQVQY02PgVBH5AsIMKZz5qSDMcIFpijQIM0yQZGAEYYanKQyMIMwQN9OBHYQZeN2nRoIwAydD/QMQZmALnTgBhBkY9zmkgDAD67SAvSDMEOX4LQyEGb4wRTKCMNBkXjBmSE1gcwNhBvkLjDNAeLC5BwCIqlOBww2NEQAAAABJRU5ErkJggg==");
        }

        .field4 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAALVBMVEVrohh4ryVtoxpmnhOCti9XiAx6silglgxcixdgjhqAsy9+tStjkhtilxBPew1rT+xYAAAAe0lEQVQI12M40dE5c2ZHxzwGIUZhBgbFZFMGgURBA6VEQQhDAcwwczdgMNsLZLAXMzDwFrMyCCgwgIAqQ4ICAxOYIcDEoARkAqUUhZUYFIWBDEdBA4aNaaZIDBN3BgYTd6CUOtAcdaA5SUpKCgxKSqoMXi4uq1a5uPgAAAhTF5Bx0dvQAAAAAElFTkSuQmCC");
        }

        .field5 {
            background-color: #C0C0C0;
        }


        .punch,.punch_icon {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAArlBMVEUAAAD9/f3////9/f3////////////////////39/f////9/f3////9/f3////////////////////////////////////////+/v7+/v77+/v8/Pz6+vr5+fn////39/f////////////+/v7////////////////////////////////////9/f38/Pz////8/Pz////////////////////////////+/v7///9Hklv5AAAAOXRSTlMAAv0L+fK0nzsYB0tGQBD15d7Uy7+8pJN+bjcyKyMfBe/ZuK6okIaBWC/r58bEqp1zZFlSiXh0Z2WofbqXAAABSklEQVQ4y5WR6ZKCMBCEMyByIyiiyOV638e617z/iy0hhiNI1e73gxqqOzPJNPkfoK3Vyaxbj/sS5gR6x/GbggwvfaXrYywZym1dc7FGAKJ+H2Ad6SGMn0rY5E1u6OumKq1sGer6pqn3dqB9qFsr44Zvof+VsImeyfRUEQbEcY9VA7bUq3i/auSK6o4iGPpkycsRNVjYMgS8XFLDu2iYO3be1Avzz7QyjNVB2cEguq0ZTp5NRA0JUkJIA6l4g2rsx6Flblx6hYIzUk427Ncjr2+CdeTvfe4hUdjvwjIIkHTS47NUvm57joyD749KGc9VXvEQ2/hydCktMu9bsXK0A30QZ3ZqBroFk15tX8v8UZsznMFX0TMiNbKdL7G07kayKCo3Iw0g+Zmonxro2+dab+Q1F2Qssg6DfmRZyqSLyM1DnQLpRg93Dvkbv/6jZh1PGQtHAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
            position: absolute;
            width: 50px;
            height: 50px;
        }


        /*
        block0 --- 平地
        block1 - block99 --- アイテム
        block100 - block 899 --- 通り抜け地面(平地と同じ扱い)
        block900 --- hurryブロック白
        block999 --- みそぼん通り道
        block1000 - block1999 ソフトブロック＋アイテム(100ごとで下2桁はアイテム番号)
        block2000 - block 2999 --- ハードブロック
        block3000 - block 3999 --- 貫通ソフトブロック＋アイテム(100ごとで下2桁はアイテム番号)
        block4000 - block 4499 --- 貫通ハードブロック
        block4500 - block 499 --- 爆弾落下ブロック
        block5000 --- 爆弾
        block6000 --- 通り抜けブロック屋根(平地と同じ扱いだが、他のキャラが下に隠れる)
        */

        .block0,
        .block999 {
            background: transparent;
        }

        .block5000 {
            background: rgba(255, 0, 0, 0.5)
        }

        .block1 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABelBMVEUAAAAAAADMczbKcjYAAADPdDe/ZinOaicAAAAAAAAAAAAAAAAAAADyrX7roG3vqHdzNAr0sYMAAAAAsFC0q2//wAD0sYPxrHyJgjRpgi/+vwAArk/ylgABp0wCn0jZTAAArE6gMAf9uwD5rAALhzxATh/8uAD2pQD1nwDlbgDjZgDhXQDgWwDOQAAEm0YGk0IKiz8JfzkLejeSKwa9MwHthwDncQAAqUwBpEoJejcnZSxsNxCFKwmcLgW0LQK/NAH5sADpewDndQDjYwDdVQDUOADHNgDWomoBokkUfTgZeDUZcjMdai4qYiooXCgvWic1ViRIRRtBQBlYQRdFOhZ0MA18MwyKLgioLgSsKgK1LgH7tAD1owDznADwkQDvjgDqggDrgQDiYgDiXwDdTQDVQQDPOwDkr34Kj0GVgTYOcjMNcTMTcDIbYStETB5PQBdjPxZdOxVeOBNqMQ9uLAtyKAt2JwmDJQiiLwasMwTBOQG8KgHqfgDTRQAv01FBAAAAE3RSTlNgF+7sAOniZFwmEQcB9/TznYJERZtyhQAAAZpJREFUOMuV0WVvwkAAgOGyde7SyVVpKVVs6Bguc3fDZe5u/30dkAwKZdn76ZJ7cgoNjWk30AHDUN/ZpGZzbV290PjEiGajLVD3X0BXC1DzfHNg2V7FmwGCDewtUdrA7fWTphkD2gCglumpqemr3S+XGLy5UMY2ohZQXp9er983CYmU7HhVhvdW1QqLfjIXzQqYMeQUo1GpeGtWncG6S2YS/PERAhiex1zvLK4C5i1TOAQAgiAAAF5881IqgLMOgUPK0VjMvqC+puVuVjgGZWDE5P011RYEeygljUgl5pNU3qsa4Cv+WJoBSCWad5Xe6xfYnuNyGGPo0jQ44lJC/mOTqAKGDfssKWY4unyEiFwI7KxWA5RYVIiE0cBII6E0ebizZsVrb4F6Ln15J8MlMYaLFLetVP1verYKEadLyoadomO50Xej60FJNgUcZC5mN6hAueWD+MHM+rUvGH80NwSGp4eVU/f8Avuy6WkIiHOL+2cr3GajVKC+f4H+uVHNTtoV0NHWqln7YKcOgrsg7TqHeyC4t1unXQ/8DfQhb2uQdjntAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block2 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABtlBMVEUAAAAAAADAajAAAADKcjYAAAAAAAAAAAAAAAAAAADmsH/0sYPyrX7roG3tpHLOdDe7YyayXCF1NQr0sYPMaCTLZR8AAAAAAAAAsFD0sYPxrHy3sXa0q2+JgjRpgi9jY2VERERFRUUAp0xlZWcArk9CQ0OXl5lfX2EArU7MzM5oaGpQUFEDr09MT09JSUoCm0gjpUU8PT01Njdra21ZWVsBqk4Cl0YDkkQ2PToKWS4YQSwNPyURMSG1tbednZ+ZmZuVlZeUlJaLi416enx3d3lvb3FVVVZUVFVsWFIOrEtHR0cLfkA/Pz84nj4qSDksQjhbkjMgPC4MRyiqqqyioqSWlpiSkpSNjY+BgYN9fYBzc3VwcHJiYmRyYVgHp04ugEwEjkM3Rz9AmzwJdDoKcDkMXTIQUS8UTC4mMCbwmAXJycvDw8XAwMK9vb+CgoTZpnDYomtek2pliWh9cGVahGEbplcRrlZTcVRcaFMVn1AmnlAuiVBaXk4KrU1IbE0Ao0omhEoXqUkBnUg2ckgIh0IwoUE4Qz4+nDyVgTYtODRvjS1+kCgMRCeJjCWsnyKcmx6tgBr8wgIxldbNAAAAGHRSTlMXWN9g7AAmEAcB/fz39PPp3tSdgmVkVEFR/hV9AAABvklEQVQ4y3XTZXPbMBjAcbebC2OehpJsy47tOHYazhaGhmFlxhXGzIxl+MbVpdcXdeT/K7343emeeyTu8ukbjp27yvPcmbW7jj3v7Orlbt4BAPwsAla3Oju6D0GjCiyLCbgWcLuLjep/QA9sYG0Ut1f35t+9/PbmLRN8tRqr+zufXhW+FD58ZF5hVTd3p6YKv6d/vH7vZoG/8+7pmZnPgdnIykok5GoHrQLmUs2jG7i2ZAZYQIjUjVw6NSYqnvpDoR18j3gnEgNxOZXRJvU+KuwgFNYGVPVpXB7xiX68HrQDYVkffaI+UgfltA9CnSwHbGB2zjcSU9XHcTmtQTFP6qHjwHUPZROJWGxwSM5MQrEfeR9INkAmhuVkUpafaZANEMwODyVTo/QCUSnhdlDRxfFMNgdhbkzrJ6iydRxIi/88CmzlG/cjYswtSLYxm+RI5BFBYk2wjekqh3HJUBTF78EEKcYfyQaAGa1ghGkEIX8++qt9WaGoFyMaxiUcDbLWHSw3w320cLMcBCwAJHPxPm3BdHgwNJdAk4AjYP+Lsy9uO3bqIgVXzp907MKlaxzHd51wruN6D8f3dnPO9fAHJ1SJO06Gx6gAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block3 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAADMczbKcjYAAADyrH3roGy/ZikAAAAAAAAAAABzNArzr4HMaCTMaCQAAAAAAAAAAAAAsFDNzc3xrHy0q2+IgjTMzMy+vr7AwMAMDQ2dxrABAgHGxsa3yr8qKiqUlJR6enpkZGQAq07EzMi2xbx8fHwCsFEApUtDQ0PIy8mnp6dxcXFaXFsMslhQUFAArk8Cp00Cl0YDj0MAeDYAIxAKCwsGBgbIyMjAxcLCwsK7vbykxrSwsbCqqqp6wJuWmZhXuoV+fn4xt23ZomtdXl5AfFsai01LS0s9UkYFgT03NzcAczQuNjEAYi0iIyIKKxkQHxYALRQUFBQIGhC/x8O8ycKvxLizura0tLSgwK+TxaqlsKqiqKWUtaOHw6KioqKDw6Cfn5+bm5txwJWSkpJrv5F8o45rto1wroxhvYuLi4t2nIeCgoJkoYBUsX7kr35AuXdhjnVXgmsltWcjtWVjZGMjrWIkqmEyjlwRsloTqFcQqFVEVEsAnEcQiUcjckctXEIxU0AAiT4yTT46Qz4jXj08PDytgTs6OjoMbzkZXzklUDgdVjcAbDEeKiMMNiAfHx8OIhcADAW0OXfUAAAAEnRSTlNgF+7sAPb04hEHAZ1xZWNEJybifC8zAAABjElEQVQ4y4XSZVcCQRSA4VXXbq46grOuKyAN0na3UoLd3d3d3fqHXfADuxwG38/PmXvnnEtlJOYRS8qiaSrxsYBYS3xuGpVXICGWH0+l/Afi/sBEcahmIigCWOE47sxCBlJPGd+CkQgKuyHYi5wEqj7WS/kcahKAsfESvnviC6EmO9saY4CZ7g4daNvJgK0DYDif2agiAG5Jqmf1dQeK4mNVVMBcXjVVAHMNVbeKmq0oACpRkN0dPRkAlFYRGJEKqh5VVkqHekXA6JUJ8n0GZDK7eASKrF8tArOFEVUbRCNUzZ1OjP0aD8aY1TgwdmhYtwCopgCGzYd9gDbUiwiUJ6cDAPMCsAtNpdBWz2h0g12KEhNsNyLTnPYiDPbQmh4eVitMtbVexbQBWndQawPzLdihHkGDs10JTId9WQs62XMNoP2f8jAof2WxXW51+fG75I11BtQW1xd2C78pt9n4S7H0WHncZTNLJOc9N4IliYVAUks+sc1kHmQmkEtO5wGdQ8UoO5Wi01LiyKXSvya7bfYzE8LzAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block4 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACjlBMVEUAAAAAAADQeT3KcjYAAAAAAAAAAAAAAADyrX7roGzvp3bTej7OdDe/Ziq/Zyx0NQr0sYPMaCTPbSoAAAAAAAAAAAAAsFC0q2+EPAz////0sYPxrHyJgjRpgi9ERERkZGYAq02Wl5h+foBiYmRPUFADrU8AqEwAnkgBlEQAYCwVCwP9uQDdWAD6+vrS6NyYmJpgYGJdXl5aWlsJrU0ApUsAokpISkoAm0dGRkYCjUFBQUAnSTcAUyYETCIERyCAOgsOEAZHIQX6vQDqhADqfwDkbgDVQQDPPgDNOgDT6d2xsbOqq6yJiYuCgoR7e314eHptbW/WompnZ2lraWhTcmFVfltSUVIdkk4BmUYlpUQFfTxEmjoAgTodVzg2NjcAcTQuNjIWTzEGYzApNS9PRiwBKBIGHAx9OQukfQpgLAlXKAjVmgdOJwVGJwRNIgQcCwMnCQH5rQDwkwDvjQDTagDgYADHOACyLgB4GgBoFgBREABCDAD8/Pz09PTz8/Pf39/U6d7Kysy918nHx8nCwsS+ycO9vb23t7mnp6eioqSLiIeCioV9h4Lkr35xfndieGxhdFtGcVlkZ1cdqVY6dVVcVlQMpVB2fE49dk0BpkxMTEw2dkoBnkkuaEgcpkcVfkUXdEE0oEAAiT4Mdj1RmDc4NzeVgTYhRzNsgS4vLyxMOCuEeiaNjiQjIyMiISEAQR0APx1jMxl0UBYAMBYZNBXCpBOYYA8FGwx5Nwt4NwtpMAlkLglPPQcxJwdrHQeqOwZGIQZvJgU5GgUEBQNkRQLvsAGGZQF+XAFcGwH2uAD2pADfoQDymADDkwDmdQB9VgDbUQDYTADQTAC3MgB9KwCTIwCAHABwGABbEQA4CgAiGI0aAAAAFnRSTlMXYPLsAF0RB/f08+vp4uCegmVkRCcmsdWVbgAAAg5JREFUOMtiEJDCDbiEWFgYOJbJysquXiGLDQRyi7IwSMuIiYlFzos2FsME4kysbGAF0Quz10wODZ2GqYCRAazAeMnW6ZNmz5igilNBpGp4uGXiykQNVawKQCAiVkXJV9ksdg4OBTOt/dq9FZXkVZYrYFew2MirsVnfR97QKgqrAlNrpc4WL30lZWULazWYtOp8hAL1BH9FRX2fIHkDi2QTqLzClCZkBYb+vn5BAQFhcjAFJhNrPREKNq+dpSwvLx9sJKeybntamh1QS4iuJJKCDfuszIwMDFTkzKbud3evsBHT6NeVlNRDKEiq3GglBwQWYZucnXWqYhb1SUqiKLCsvrQtJS5uaUrGSe3iiwXx3ZJoChQA03JzPpqxZ++xs07aLh6HFSXBoAGhIKbAzUX7eKb9zqyc8yUHOyQhoBWuwNzhsuspJ0cJENjhGAyV906CKVBIvVpapO10QAICMrtA0jU9UfCgtr3poXOuqPCIPVRFVpukZF2IBiIuzO3yr7nruJzOlYCCVbr1c9VQIsvcNr/ctTA7Nx2iYLfhAowEo3m99ExxSd4uiAo7zBRlWX3BVafM44ojyBB7WzQFkKAqq3TQqig/cSgnb0sEpgKx1BsOmmqmNlpV6zXUsSVaMU1NcFIytYlHS3KcgeI4QS8fUIEgDzNOwMvPysDAIsLKiBOwCrMzsLCwMeAG7CwAQh6xZ3GodIQAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block5 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABSlBMVEUAAAAAAAAAAADMcza/ajAAAADsom/MZiIAAAAAAADmsH/yrX7PdDe7YybGbTGyXCJ0NQr0sYMAAAAAAAAAAAAAsFD/AAD0sYPxrHy3sXa0q2+HgjVqgi7///8ALRQAGQv7AAD0AACVAAA8AAAAoUkAnUcAhTwDFQoGDwcZAwPuAABVAAAeAAAAq04AlEIAkEEAiT4AbTEAXisAJBANCgQDBwTlAADMAADGAAC6AAChAABnAABMAABDAAAnAAD8/PzAwMCSkpIAqEwAdDUAYSwAUCQATCIeEREUBgPhAADaAADWAADJAACqAACMAACIAAB9AABrAABhAAAzAADo6Ojc3NzY2Ni9vb2tra2lpaXZpnDZomxbW1sAgjsAgDqVgTY1NTU0MzNrgi4rKysARyAAPx0APxwaHBsZHBoUGBbpAADdAADBAACvAAD1mNG9AAAAFXRSTlMWYFfu3QD0ZFoH/fbp3t3UnYJCJybbpL1JAAABXElEQVQ4y5WSVXvCMBiFO+mAuWballIX3IbDcLe5u+//367tWJ+1NOzhvT1vki/JQVbmtqDM2FAU2bzZhXIxv64IextQdqYmkDEFFueJgBsqHJTSX2StF6QhAhNMkEChjVsLXj4OfpAKVoIvFAMDIiF6WPCG9sEvn9QzbRZoTl/vTFKdXqVoEh47+nqX5ARATAYMAiOQupDSzqoSBsHfBTqyqB0UNgglF9ChYsAZBe/GHYqq0KqquZgWUnICxJ8MQl5Sp5PbJKj3W2QjouxzbRDcnDpZJCHI6SZQiROma7KVhjaaCDSi5YeC6SV9/J85o0L28M1j+gsGT9UHebOcxbDL/NB3+/nuhxLXpLtjDMNuWYvCBLh+kgrnMkp+QrgtO+lhvXhOyY9erqClZbizzOmrf0SrPcEw7hun9vf/CDPn21BmFxTBtjgNZWnZjiDomn0SzqoDQVFkBA70Gw8mZU4IyU8QAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block6 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACdlBMVEUAAAAAAAC/ajAAAADyrH3pnGcAAAAAAAAAAADpr4DGbTDGbDCvWh+vWR91NQrzr4DIYRvIYRoAAAAAAAAAAAAAsFDxrHy3sXaJgjSHgjUAr0+fr8GUpbmKm7B+kKi6yNipuMmywdFyhqBnfJhbc5HO2+nCz95PaovS3+zc6fXW4+/I1eQAoUlEYoUAqUzUQQDY5fJ7g4xsdH4Aq01CR00ElkTF0+HBztuap7U6W4FdYmhTWmNYXF9NU1kArE5GSk0SiT03cS8BUSYERCQ4HRB2NAXhagDXSADL1+O+y9ilsLyjrbeYoqyTnKSKlaB9ho92fYQyVHpAWXdmbXTcp3I9TmNNSksBpUoAnkgBnUcAkkIyOEEMjkArRTscLTsZhDoAczQudzMyczE6bC0AYy1EaSsAWyklLyRWWiJrThqaQw9hOgzBPAVaHwWGKATPPwJ1IALneADaUADT4O22xNOuvMyxvsutusiuucOaqbuZqbqSoLGbpa2Rnq2ImKqRnKiVnaaDk6aMl6SHj5dhdY93f4hueYVfb4Voc4FCXoFfbX5hbXxpcHgtUXe2rnVjaW9GWG9NWmyejGGph2AjN04Hm0YWLURQTEI/PkIAjkAZLUAAiD41OTysgTtDPDsBfDgifDaHgzUhejUuMjUcLzVINzMAbDEKazAVRS0YKSwOJytLaSo2YykSPClNYicETiYCSSRYWyNcWyIEOSIeICJeWSFMLh9nVB1MKRxYRhgVFxhXOheBShWCSRVBJRVyRRQvLxSKPxGGNAyoPguxPQlcKgbGPASSKgRyOwOZKwIPDAI6GAGpcADabADiZgDdWQCMUQC6TwAT9dUdAAAAFXRSTlNXF94A9vRSEQf63d3R0Z1xZmM/JyYlifJ4AAACHUlEQVQ4y3XSdXPTYBzA8XSZ4ZoVkrIkQEKMurt37q4wd8Pd3d3d3d3d7R3RsXZ5WJfPXe6eP76XR+4HjYtPkZQwAYah+BNTpZwpGjUZhlKmIBGlAhpdRhbyOCgJCOra6kp1FSiCCqfnotFAJgbOR6HuV9WaywZvc89z5TCB0PYr+DCNLfSvZvMCZcME7o8/fy9nWUcey2Z3VcUGaL3qxyG1et5xTq22d7qqjw0JlO43fZ8Xc9y6bI4zPc3k0m6BASqcfdIR+mNlGMrFMIw9i2EyG4BA52k/uSvQ+8xEUZocisqwUhRV0urWicGDC0be/l3L8+l6I290pfN81rfHL1sMg1uc2kDTGV8X0nShmaZzc2kav7/dpPlybWc0uLgKx/FzOL7IiuPz9eG1Q4vjJa3C4B8azCRJOsLfApLU5pCkxkaSa18fEG/RZCYIwkb8oyWIFXqCwJqrgGt6l2EYthGLWKJfimGHL6FAMGezArBmpUJh66oFH8p5I3Xaf7YFVB4wQCoqU0Fb23tDd8EtUN+m6YA9H4LBvhdK8AzFM0TrK3u6VSrVuzIxMFyZKdrtf3u9vvFmy51yMVA2nS+YFVHc+b42PJb9wEMK3pqC2f22+DsGBjZmospv1+RbLJb9nxqdSEwwwOA7uiP/qkeJxAZRR+4d9KHI0CChSC7at1cOGjEmHIwfGSdp9NhEGQRPgqQlTkyGYDhJJi0Z/gv7UKp/LpEmcwAAAABJRU5ErkJggg==");
            background-size: 100% 100%;
        }

        .block100 {
            background: transparent;
        }

        .block101 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAHlBMVEUAAADUuYDCqGuOgSi1pjCLa0RsTCe1onCchFRYPDy+VJwUAAAA0ElEQVQoz42QMQ6DMAxFbaXAWli6Rz0ACrATpUNHIkS6dqESB6g4AfduMA5BYqnfZPPzhR5gDofJr+eDvnVxv+RfeLretLyLxzJC3XSlMNu0lRlADJVpSyCEaTpIPhATpXv7DquAE1gvI5VahQSVXppsFqYnXrNZO1Bm8wYWvgMAJRYeuQLr0EKncJBMsSfiiQ+B85OYOJcWewLz43+QQv5KOVJo9wd4Z4WaE6zQqiBIB4WafbBCjAnFCpH5W2HigsLEkcJ0StxGOoEfOhG0/gB1C0SfNU7AFgAAAABJRU5ErkJggg==");
            background-size: 100% 100%;
        }

        .block900 {
            background: white;
            opacity: 0.5
        }

        .block1000 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAABTVBMVEUAAAADAwFRWlFAQEA0XikGCQY9ZS0HCQQVKhMVGg8ABQBAZCsiIiI9aCwICwYSEhJehDVHcC8wWyo4ZCk0XCYjQR0dJRQTIREQHg4yXCeqv6MFBQUAAABVeUMHBwcLCwtoaGhnV0tZSj92mz5OeTNrkTstVShfT0Q5UiwwWSdMPTQiORwpSyAuTB9TdzRXe0gZLhcnHhpqjjMkPx0AAACqv6VMZTpsWUxvljxmiDRNeDQ2YSs6MClagjVURTwkNxhbfkwtWyNvlFQhPB0zUiJ9nlhskjwyXChTdUwkHhoAAABLdDI5VR5MWUBxk1VghjJPd0s+RjaiuaJtlDpnjjhiiTdwljuApT93nD2DqEFXgDQ7ZSx8oT9RejJymTxJci9qkTlagzV0mjxfhzZBbC15nz4+aC1OdzJdhTZUfDNFby43YStMdjEyXipDWDJy3OOOAAAAU3RSTlMASwkE9lP+PYdoMRMP+Vod7u7t69u5nXpwSkg4KyokFxb+/vb28e7n5+HIyMWzraKRim9pQzD+8Ofe1s7Dvbq4tLSuqZ+dmpiHgXpwb2RjUjohFvMd03QAAAK8SURBVEjH7ZRFk1sxEIRjx/baTjYbZmZmZmaeEeuJHj978/+P0SFVqUqVleTuvunwaaZbXdqw1FJLLbXUUn+qf2v//v23vv83d+hyCE22umPfxn8b8/nV86dX3n7dcOhEAIR8Pl/9TSbHYInGFjtuvAQuBPccip3DA2v9v3AbHwkoAbJcDrZSI0riIa8pnNy289mmJLhpKzChEXSrMsNLyrGlQImRtnuQJF8z1AxzSZpiljPgAmTJBQNpUL1JgacoF3FmXtdKUcgRcud03Jhw321fSYS0FQz3jKIGuQ7AggMGJQfa+KZQ47XF4IloEJGADn4mkTR5i1Q4JpyUdn18cDF4l7tScEAqu3kZUFaVNNQbIExjtXu6GLzfUheAgsw0Bwc+y4rclQ6xNO1sT8LkhxYabLCTEkshQq6hUI5xDiTrRnt7mxcX4IotKhmD8IQKnkeb9cxSg0QSO9ibivXonh1dKJEUVUYNg7iqKuqWWGtHL3oxnMXqndIAiFnWdZyhAzJbVxJkoQZ7VpKFvYGcxSVL3invCGdQWEINMbZbHR9OcN/ucRSaeIKZsoAUakUYMIMe28EkUddPmmoNjGeZVdYEUtcdAhOBmDBXuxIjPxLU1DFASipF/JxYo5HFtFri1bkEeJ0JigTywOh85uuqGiEyAYLFLqjt0wSotRMakPJMqZE6feEJDQEahk7QejBcDH5pc2co5ZjV1e1jxx++3x0zpoC50WBPJ8BN26K7kBNLanVh97vhcEKBMMYBca529hLvse+kLQrfRnO7tvSitmzzATk4IpvqXArcOLk4mI3U9ovjYW9lc78/vSRRNhILaQdXk507cmBy5tjx83HYtB+P/d6l1UpFx7PB1Zt/+WA3T65di2uu/Tod2Lvr7I8fZ8dbbh5Jc3HdI2tHj/Z/X7Ty+M6Z88PpHx3/CX6d45GN5KrnAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block1100 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEUAAAC1onCLa0SchFSLeE7UuYDCqGtsTCcQPoVBAAAAAXRSTlMAQObYZgAAAG5JREFUKM/dzTEOgCAMBVCvULwBi7OFEyCJMyawt/c/hAIJLXF1sn97+W2Xv03C1QCuKGCgRgM9QFOjkW4wmKSA6xJ92yhMTLqROV+Zi4DDGrQD7NajGj4c6AUypASwuwGxz/vG9CUGd8pKaGlwA0ODIXT8T5xZAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block1200 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEUAAAD/////q16MWSq9dDMZGRkAAABkNxBefSETAAAAAnRSTlMAGRL4ZfgAAABiSURBVCjPYxhuQMQFDBzhAk5KKi4uSkoqCIEgl9AQJ1UkASWXIBVXJWQB1SAXFAGgftdQdAElVAGlUDQBFSDGpyUIpAXFHWCAEAiB+MUVLlBsDAZmCIFkMN8MXQWmAJlmAADvuCIURn5oLAAAAABJRU5ErkJggg==");
            background-size: 100% 100%;
        }

        .block1300 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcBAMAAACAI8KnAAAAGFBMVEUAAAD////r6+3Z2d25uMSOgSi1pjDYwVk51K3bAAAAAXRSTlMAQObYZgAAAGpJREFUGNNjGDZAyRiFJyiExGcSFBRUMoBzFQUFhZTh0myCIFnnACg3SQjIFTINhWk1BHGVYbLpiiDFJqnIBivBZZNAao1NYHrZFIGyyq4ODDBpJSUlY1MYj9mtxNjELQQuy2Bs4uyCzWcAlJIOIV1CqSMAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block2000 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABiVBMVEUAAAAAAAAAAAAFBQUAAAA8ZDwnJydvmG9fSjsJBgYmRiIuJB4sYiQVFRAXFxc5cTlbRTklRiQkOSQnXSAZKBcfIBQLDwsjWydEbjwJCQk4ZiUpPigxbSUoXBwkWiAtYSElRiQ5KCUmUh8oXx8/ciUxZiInYBwtYyEcMxslUyEbExEwYy0RFxE3gDIiVh9MaEh2nW9gimBkTj9TPzcpTiU5cSJtpDAsUCJDeCRpmixHMypSPzI4KyJGNisnVSAmTyRELyYlPyQ0JyEoSigfUhwoUiMfMB49KyMqRigmRyQUIxQjVyoyeiYmTCMTEBBCc0IODgtyhW5ah1ApYyMWMxZEeCc8cSVJfSk1aiSFtDZgki5Thyt0pDJ5qTRmly9YiyyCsjYvZSN2pjNwoDFcjy1/rzVPgypBdSYqXiIpVCSJuDdjlS5tnjFqnDBMgCh7qzRRhStFMClGeyg6biVomTBajS0qYSJ8rTU0Nic8Lic/dCYqSyYyaCMoWiI4bSQqUSVrVkhNOC4rRSmu43QHAAAAVXRSTlMAMi02JgcNCv4++LF5YRYS/ujJspGARDsiHP78+vj08O7s5+Pcz7+0nJlpWllRSkAnGP399/Ty7efm5eLf3d3bzs3EtK+npKCRfnNta1dSSUhBMywjo5ZbHgAAArpJREFUSMftkldT20AURi3bgGmmkwCh9xIC6b333rZoV73LsuVu4w788qx5tUzITB45DyvN6HxXd3dv6JJLLvnv9B0c/ot+ZXMNLE7sX9j/tQYQtfD85tDVC/lDdxMaATCfQ83ViyR+PkjwZlkCUtLI4afbh38rv3FHT/C8SKw0X04hp/X6fP+6X7Q8UdQ0QtO8KaC6u/TjPP9gnVJoEUGiCKTSYhHgkjP/rbu/e1/ntaIFMhACaHlFZBEK1Td93fyRVS3R7h9CQ9Al34bVpJLygLvbNbBIlISiCIAqCssZOarxWsF2n90I9nu2HasgJVOyb/J8glcEWTJ5wcireCE4MeQThHwjqTOP19LpJE1pOrFwEzfeBza0rvOSZaRZT54oaLqXAZRkEFSx6rzqCQh8LpGyZgiKqUkZKhMjA+owZ1fzmAUGPgQM9EYeyEWaYj6yAcj5oGljO5eRKQs5KyOdI33NkxGQZSODAKWUkKKRlKmnC1IGQHWhcwo/qT4FyYRSyCGvIIhCQZIE3Wu/EASbzn7nFDkqtsWEUjaKoqmYppgiuphKsodVherK785bmAB21TNFXSbsDspmWpcl2WdtAQhxbbI3FLCJKvQJkZGVLhcE3aAAMRfZUMWlsemAQN+EU5u1bQDysoQYEKt1XIdN1W3UxvtnQgGJL1v3ZjGGGKMchFAtqfl6qV5qnc69nebioSDCw2PubdepOTiP3VrLKbUajYHx8ckIF+4JDMQje1sfJ8cG5tyGWztly8DSi6lIhOO4aJd55drsPa4cHR1V2svgd2Yzwr2hYKIcY/pJLHuSzVaylcryzpkfZQ0F0xtmn6dit06OY6PZ0Wx2efisfqg7vdEwFxkevHkcO87GRl9+7WflZ/pC59ETD3PD73aeP5oafDjI/I7zCfxLONrfH4lEojPxjt3+ATVW29bLEcz8AAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block2001 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAMFBMVEUAAACQtB+WvCBfWDqr0DxEQC5VTzo4NCV9c0yIqx1rY0FwmgSbj15waku1onB9dV8YvSvnAAAAAXRSTlMAQObYZgAAAbBJREFUSMftkL9Lw0AUxwOCODiFLNUp0KW4CEeOEF1y6CAuwpGLxLGcB05CSboKVQjqYtFBHOOPIjhI4mCdhUwuboL0H+hf4KLvuqi8QDdx6JcLn+E+9/LeMyaZZJL/nsWOQfZmjEND08CZ2ixJ+lDyXPO5QnCXVopifWGlgJMfLKL7Wfe0y0wGp9tlFrlCwsuRbzd8216zNfsZEoZbplWzrJrJNOc6SCgv4Xndhmjm+BeHj+a5ZXatWk3zzMEVRi1ARqwHuMlTxqAHGEJzHlc4vtfvG/Bp9jkS0tESTCihWVHBHbcH8nsPWHD3x+wh/es95BV7OPq5hwtcwSP+id/w6426DayYgpRL7IlZhVWY7Gk9whWWh04eXfazVV4U0QHHgls6zuaV53JPk+AxB68yocqjCQFKGSLhPZOxUE0QVCBU0EbCG1FchlwGTSVUGGPhQ4DQbik1YoXwKYLb7ThRNNFsY2Egkx5cShprhli4u+Ep5UpS1UqpqBCmbna0IK4VMAl3kTDtuD0aySRTwBgEFBl5jkdbHQXUQ+AIIl0QpCAqNCrTlD0aZNLY3jC+8wURGbNfHEIrZwAAAABJRU5ErkJggg==");
            background-size: 100% 100%;
        }

        .block2002 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAMAAADyHTlpAAABm1BMVEUAAABNQjdKPzUBAQBGRkaLi4RMQjcFAgINDQsODg4ODg41NTCnp6drX087MioAAAB7bVxKPTNCOTBmWkxgU0chHRcJCAgDAwNnXEx9b1x0aFdeU0ZKPTNjWUhaTkFKQTVIPTJGPTFUSTxNQjdmXExZTUFZT0A5MSk1LiciHRciHRl8c2sWExAQDQsODAocGhYEBAQLCwsAAABgV0hhV0eMfGaHdWKCc19bUEJgV0Z3aVpRRDZ5alpqW09jWktfV0dWTj9cUUJSRTxJPzNBNy5QRzxYT0JBOS1VTkFKRDdbUEJQRTkxKyIqIxssJyEjHBgzLimAdW1gV0g3MClSRzuEe3ERDg6ln5hHR0ekpKRkWUqWhnBRRjqXh3JrYFBZTkBXTEBPRDl1aFdzZlWGeGSDdmJ8blx6bFpiV0lWSz5USTyNgGp4allcUUSainSRgmyPgGuBc2B9cF1rXk9oXU1gVUZMQTaMfmmOfWl0aFZhVkdeU0ZTSDtOQzeUhG+Sgm2IeWV/cV9uYlJnXExbUEJWSj6LfGdyZVRlWkuFULUpAAAAWnRSTlMA/v4wBQX9NCEYDgsJ/bUp/PPfuHRnPR79/Pz8+vn49u7j0MrHwLqpfGxhVU5FQDo4KCUgGf39/f38+/j29fPy8erj2tfFxL+wr62tjYR1dWRiVUVBNjElEg7qyk3pAAAB8ElEQVQ4y+2TVVcjURCEd2ZCBIgb7u6wrLu7+5077hZ3V+Bnbw6PmUzgHer5O32qqrtvXOtaV0kj45cEx7ffr377dxny19ocoOzLP20Xjvyz5OaTUgv6t4d7PA69fqrfntR4KWNf3B8dgt5cmcjSnJivJZqSgQbCTmsyeKdRlLMCTuB8qoSgLyNWc8eCgqYJ7YxQ66GcrKIzn44ssn1/eCsez6c7XL7ekEigoOji7tHIIPJ4ZTJRSzTalSxbZNOgXFEZ1LPrGoSGpoRC/ESkVNo4I0GnUpFpZGbdMTag0Lf3BT4vghKb5CijC3NQgSji/4KZo/1+5tOLybaI43hdpKs5NMcwDIJ4HObGtmanWiTQCSIWw313GZWiVIWGSODAa1rUR9k9Md1he2SMYEsUK+hlVTaqCxHM1o9+vifLFMXGCYLQmqQi8qkyQxtV/47DZPZwiVJg+fSk55WIn9IgxRkMhLnAAWbuYN/zAAIuWajjCYlUFBLQCGJf2MQGNGs7DD9Ps5LUTBXTWch0aSY379k5L8DMRjcetchMJk2KKQ50YdW+HsGiNou7Dj0GZ5msXkjo5LR9/s0e5rK+7R8fngA1qRU4d+nFpiM6OuwPnFuv5nwa755dDnv7opsdu76uBtfebeyZyEH668Qwr6s/z38ISYZWerniuQAAAABJRU5ErkJggg==");
            background-size: 100% 100%;
        }

        .block2003 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAGFBMVEUAAAAiIiIVMj06YIFUhKp/utiizeLF4O26zNoVAAAAAXRSTlMAQObYZgAAAS1JREFUSMftkUFOw0AMRSsEB0hOwHwX2Htc2KKxQw+QpOxbKDdIrk+mmzYai4hVN/1y9BZ5mXx5VrfccssfuTcRMzE1M3103ndMZDyNRIt4L4RGA+oYEEE8PVIIxqGqME2oA1CXgiJU54AKoePqUsD/BQ0zgZeEuPCLuixpc6HsEMNMcDtcfQ88LxmdExb2oKgus1zyGh3aJWGfSyJPHeDdpmpAzQExgCOcTUoHIgYpoEqO8NGxRGZRhml0hGaT1uMhEUums6hdl79m2ZzoCMeWeiUeT4QjDOnpKH27PdG0FHrQ4WXoTSc+951zm5BE415S5ndyhHWfKCGmTK9kanYtJVKe6Ap348CUNi0musLq8wBqfr6wnch4LIWmBb0NDElZWJV5UOBVkQXw+YBfSJ5fXxmrfcEAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block2004 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAJ1BMVEUAAAD///+jo6br6+3Ly8uLi4vZ2d25ubl4dn6YmJiwsLJsbGxkYmmMRZbzAAAAAXRSTlMAQObYZgAAAKBJREFUKM/dzjEKwzAMBdAOvUCqG3jzaP4JDCbZAwZnDBh3NhS6FwrpmmN079bD1VpkdekBaiwwD1n6h387xxLydQxnAUIlhwoBUHWA7zAMdeASyGXMlxKKQAXBE0EBaAU68ATfSqBNaDmmSeXwDuRJgCe4rxxu5RwngacxdtlN0mB28wusjelu06Y6ltbz0F/mBrMCe+M9HeIrbu2++f0BBOAqwOm1kxEAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block2005 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAADFBMVEUAAAC2ZR0AAABqPBHMlsqrAAAAAXRSTlMAQObYZgAAACxJREFUGNNjGCAQFhoWioOxCgjAjFCgECYDroZoc/7/+/8Pk4Gq5h9QCBsDADKyLoMA7mTGAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block2006 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAElBMVEUAAAC2ZR0AAABtPRH/1KuZf2dCgfITAAAAAXRSTlMAQObYZgAAAG5JREFUKM/Vz9EJwCAMBNCuEHEBr+0CZoJIJlDcf5WmP6IB6XcDB+F9HNzx84uqWqLKACGiIBQ+oHgISCtY774DBhdNoHAgCsgCpGWBAKRi2W9pzJwb5z3A4OYJOhy0DrQFuFcHnC0YkIGzWt7/AYTXHEZW4LK6AAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block2007 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeBAMAAADJHrORAAAAIVBMVEUAAADr6+3Z2d3///8xMjO5uMQvPzc3TEVGalMpSTYtUDuba2MiAAAAAXRSTlMAQObYZgAAAINJREFUGNNjGJlAUEgBhWtsjCzAaGxsKCiE4AsFKwspKyIUCGssCgwMCkAoNwwUWqqqBOMzGRoaGwZNhBvAKSRkrKSoBOczaqgqNQmLqsLVizYaqgqGhcD4LJrChpKBpSkwPptbkXh4apoL3P6UtLI0txQHOJ/NJSUlBSQNN8HFBcoFAHA8FQDw8tZlAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block3000 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAOVBMVEUAAABliwRNfyV6qQSr0Dz////Lfv+DAAJskwTVmP/Z2d2tAACwPf/F/wD8VVbpyv//AAC5ubn/7ACrTkvqAAAAAXRSTlMAQObYZgAAAItJREFUKM/tzzsOAyEMBFCbnwF7WbL3P2wsEgmBgDpF0BTgh4uB//ntE8JRUwoHvEO4tx9EXVXWioiSksBG7eVQJFqzcxcdXm7nYEx0FgEqEc/mW4yuFuJKdUSfWwCUmbjQuJz98/jcrlRL4Yn9y2s+/YgnRcyQNd9+1gz9+mzdr896v0Xn/upymr0BPR4EQpntIloAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block4000 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAMAAACf4xmcAAABlVBMVEUAAAB6mjR9nTaQtzp8ozR5jD6KszmGsjd+pjR6ojKFrjeErjZcYThwpXVzoTGArTSLszaFsjeDrTR5pTGOuDufv2B1jH5qZEJogDx4qTiGrjORuDl+qDR8ojR3oDOPuTqCqjWKszZ4njCIsDeIszp9qTKJrj6UvFFor6tkradfqqBZp5ljrKRqsK5WpJVusrE6hHJ5b1CAqjhRoZFKl4eBpDqErTl1kTh+pjZztrhws7R9p5pFkoNSkYJzaUhmXTyKsjpfVDdwq6B1sJ9gpZdxoJNOnYxKjn5DjHtoaE91bU5bYEpuYUJ1gTpiYjV4ozN5tq+StauLrqKZrZ1qppqAo5Zpn5GRoo+VoIhbnIhXl4hpm4eOmYd3q4F/kX8+iHaJiXN+q3FeiGuElGWAfmVvc1uKqVp8mFZ3kEt4dUp9g0ZoXkN+jUF1dEB9mz1YVDt1iThpazdRSjVQUzBKQy2lvbN/saVao5R1p5J2mo2Pknpxfm14nWeHrWWJm2J5kWGCqliDh1JrdUuKsEaAnUJ/lUBoczYuN4+4AAAAKHRSTlMA/v79/f79/PXw5dr+/f369e+ymGwI/v7++/jt6OHZ2Mq8pph8VikTCPk3AAAAAaVJREFUOMtiGAWjYMQAQBl02ZwwDMYB/AoMnbu7NGnL2o7KhttwmLv7cJu7fu4l3O1NyEVe5Hf/J3na21SPSCWTOcEVTwu5UkJpaR0d6ySZSUfpEsmqN+OK97iica/gKmpaBywkM4i6hLdcLUQONveOziMZQXCXNHoDybSyUvHGDnY3nLzTbl++2RPc7qyiIZlKNZbP10PhUMjhcNh2NpZXI9FrpZlk4m/hKegM2+asDGO1Wu8Cayub10WZZFIlFtypIQgZBs2AM3jmlkjWG3vgHUhByLKA5mjIQN9qNEuyxu7DQ6wwml2Y5QCE/pWzBpJ9rvM2hqVpGjmOQydgl26P6tipnV+EqBiALACAxolLvq069ooZAizAgdzCPBprj2mS5bd4G/4ARAylcfh99x8mkhkvT8JziKE07PDynf6MkMwsvu8uMhAHcVxtZ/fzGjPJ2mTx6mSbwUVBraj/TaGah0lm6Vdl6WV/OwABbov/+ELSGy2TJJsaHzJptZ7vq+OmpufLiy81RRknOmdI1jXd0T6o1xrUlNTnEeWUp0Vn7uj6v/0DailfJapOU+sAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block4500 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAARVBMVEUAAAAAAAAuKxw9OCVFQCopJxk2MiEjIRYeHRNPSDAVEw4bGRIzMCBbUzdkXD0nJBpXUTVyaEZFPitrY0Gr0DxwmgRfWDquDzh0AAAAAnRSTlMAqdmZ1nQAAAGPSURBVFjDYhgFo2AUjIJRMApGwSggBACNkduu6jAMBYXvdpK2FNj//6nHQefJL0ZUaUZizSDxen9er7/3ff993p/3/arcCnyS05qU56Q5V+VWQLRo7cf3bXrlVjDXcz7XzuZtEVVuBXg4PA8EdCDPo/IvAnw6EjoCJVTuBZk5MFM5hOPphXtBZiiDOfjWvXAvOOUUPOk66SAhwsqtQEhyc10ie4xSuRVc2Tnlytz+yFm5FdAle3NcJ+b4PAv3AkFwV3AE0JWXyq0ARBcqIOSxHLByK3BQxwyDw85i4Z8EKKDgCwGzXrkViDEwGzmJQb4rtwIwZhYTEjY2k8qtgFlY9gP7ZlC5FWTr/+/+VrlyK1CEcaMOhcGQR+VfBHqDsoIOTqjcCzKDminMBd5QuBdkhjOYg28dCveCsDANnsHIxqyVW4Gx5WZOsz1Wq9wKZnbCZub2x6JyK+Bpe4MzNMcRhXuB6QCIATpGSF4q9/+ChWgMHXkIjKjcC0aA5mzENxuFe0HE46EWlq8H51m5fv8fyiseK6gPIC4AAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block4501 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAQMAAACQp+OdAAAABlBMVEUAAAAAAAClZ7nPAAAAAXRSTlMAQObYZgAAABNJREFUKM9jGAU4wH8gGGUQYgAATCKDfQLz5fIAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block6000,
        .block6001,
        .block6002,
        .block6003 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0AgMAAAC4FvN4AAAADFBMVEUAAACX2RAblwYAAADKzb8cAAAAAXRSTlMAQObYZgAAAElJREFUKM9jGFyA/z8EfADzeEMhoADM41sVGrUKCDZA5KJCI7NWrZxZgMRblVowCORQ/cAA5UE9eHVpWNSqZeHIvJXTh5HcYAEAkTiHC0lyX+MAAAAASUVORK5CYII=");
            background-size: 100% 100%;
        }

        .block6001 {
            transform: scale(1, -1);
        }

        .block6002 {
            transform: rotate(90deg);
        }

        .block6003 {
            transform: rotate(90deg) scale(1, -1);
        }

        .block6004,
        .block6005 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0AgMAAAC4FvN4AAAADFBMVEUAAACX2RAblwYAAADKzb8cAAAAAXRSTlMAQObYZgAAAB1JREFUKM9jGGTg6tKwqFXLwpF5K6ePyg0ZucECAKHlflHyLJiLAAAAAElFTkSuQmCC");
            background-size: 100% 100%;
        }

        .block6005 {
            transform: rotate(90deg);
        }



        .player0 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACABAMAAAAG8nGJAAAAKlBMVEUAAABPQi/n3c7cxqTRsH3////T0uDrlOvt7fKojWXgwjCukSW6dbqZjXy7XoXlAAAAAXRSTlMAQObYZgAAA/ZJREFUWMPtmL/KFDEUxee+wb2TKPinmRsXRaskA9aZGbRWWMFyVURLtfABBLG1ULC1tLS1Eixt9IlMFpwke8nKaiffhSnOnN85+80OX7KkO5u/H0zXCQDYdAm/DegrmC7hNwH1HLv+BQq/BcDt54Gml0H4LQBuOu/dTSv8FqAdpxlR+A1AMTEPvUHhNwDF55g3Wde+BEDxF+Ybnw0Jvwl8Yr7+sVUgAe14e+4uj7KgAcC8uf90a0LLr4E0dOvNm9cBhS+AlaA00m8Cyjx+/NCIgiYAbtpu7062XbC4CPAK6LGPWo+4FnDUYygCCZiGNRCSpmUN8JQKyodOQL8GANVma5DeroF9AXZ5EkBY6GWZ6cLbtXDvU1cBy4UyYMlf+JBv6Fhw4UOR6AcKsa8KlI0QiCk15ABUf6IOsJS6I2AEKhu7agA7Orjj8QD401B3Nv++P9BJAAQYUfptABYyQfjHgG/heSakL4Hv6qUh4bcB7fgmjyj8FgCO01jhtwBipqivoPAbwDnmO1EbFH4DuMRpff9hZEEDuMj86UiBBPRuyxG4IgsaALx/dzc/pPAl0NGTV94H6Qsg34iD0m8C3fknbKQvAMx6y5M98EMV2A6MYAtt4mIO60OkAoNVoDcyoNbvOerA1UfeYYtQbDEPvLJ1wLoyADuvSReBZQ5Eec+iB35U1Wq90KIXzIHgw+LLAj8SdpQ1xRvUVQGqtqRYEIqPXFCN1ddGSyXBeyRfIJQy9epeSUh5Ijy6/h/mz+bfB7DDkwBtIUi/DcA86CD9NqDds+Wr8NsAqKsvLn8VvgSyf9XxiNKXgFzepS8BHcXQ84DCbwAq6bu8QeE3ADX8jL/++YYsOAJc/8jXZUED0BHgzZ1HskAC+SG3799KvwF0NHv/Zid9AdTLu/QlkJ/q2uNjPsw1AG7a3MsaRYHiCNCKd8CqCIDt+iHqsnCYN/f0+i2iCCg+VwesrwNeuV22Q0duyIGEaO92lP+7iOalXOtJK1sUYEfajwUwj2G2odw9dNALFoVLmH39FqoAxEKrQ7G7WFTeHizvWEmPOhSFmIhjy3ukAU/ZAOBse/hPz5cYu96g8FsATBwoXsJvAeDYe8dW+hKQx0PSl4Di/RgUvgCO61YAfmsSfgtwe+1lQQPQfu+PsqABwOzTBOkLYP1N6f0YUPgCEMdDwm+eLzGbY+dLVAPgJmaebLtA9RFwQz5fSro4X2IX9RxyoE+AYlzXuaTz+VJv9gXFQ+8DtAYIFbNBWu1h7yc7L+AJKHac3s7Zh31BvSn6YcasiAz5EsgFeUcoNxDPFqoATMFVgX6Ag9cCCxayv5Kf8M/nS9qxoVPOlyC95d8FvwDcekTOQ8AgsgAAAABJRU5ErkJggg==");
            background-size: 300%;
        }

        .player1 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACABAMAAAAG8nGJAAAAJ1BMVEUAAACSkpxPQi+BgYpsbHPrlOtKQTS+fun///+6dbpISE2YSs9waWSuLmVcAAAAAXRSTlMAQObYZgAAA7hJREFUWMPtmL2u1DAQhaN5g4kvP4JmMrb4KWOHB4hjGjpAPAANPRU1NR2ioQTxAnS08GTEC8T2PfIifirESCkm5ztnN7t3Pboz/K/fL8nXLwDk8wV6H3AXki/Qu4B9KMP0WEDvAXT/YdT1SQS9B9C9OYT5nge9B7iZcy0Cegew/HRvnxoBvQNYfsZ8tfStjgBZ/sR8/aNR0LvAC+Zrz3sBCOT3PDEvGNABaOMbD9hE1AH4XppCWKKADsBBaC7Uu4A1KW0GAroAzSszr74fkGbe6wDcMu2tK38aJ3mJlSED63gYYu41HQZec0D90BmYDgOJZTai8TCcAuqfXAbqGzalTUuknnQdGiC52uA1uFRuuD3ApcoxjRrj0BrqRIrKmhOKgZq36CJltZQSC2mdODRFMuilO0EuAT8rHf7Xn88H/SWAIi2Ceh+gpCaCfg54Ex8WAnUE3tonRlFHoBzX93gnUEeg/OjZg94DJuare38hoHeAW5zPdzYCege4w/yK+YvBgA5wm/nFmQAEXGTegQsM6AD04V15SNQRGHQLIUTUASg39hLUATjKbWxQB0BKf4yHosfGwCML+ao3+2FOx0PkACONYTJosMfnvPeRm5cc2QtVI2YN1rcGP9cGisGpq2fSFlXLzNI1LLZ5S0mTS1IHxBTqgLCoDFp63W/o0Bi0GUl7QKxeMoldmo9NU9NSCKKhQjR72tO9aSn7VeXs+X/Z/7/+vEgG+SXAeYqo9wHaRhdR7wNufpReg94HyF55fPc16AgU/crMi6COAB7vqCPg+Nv5LqB3AJv7p3xVQO8AdvzMN1/ydQw4A1x7ztcwoAO4HWAeEwYAUD/kh/eoAwDHO+h/az5YNumcTlsL0LzyRekFAizvgB74QGwrA/lhGvmiCRw3vnDHpyhgsDy1Bh9aQ7BzLHIcdB6LISMuzFHLr0t1S/VZr876qpdBXX0y07bEzcd6erjoklSBKW6h/RYaA+2B3sVqunixwV863qVpg7hYBUomzh3vO03yKwOA/o+Hf3S/xDJMRkDvAbRy1P0CvQfQzCHM7FFHANdDqCNg+VRGQAfgfN8z0I9eQe8B86kPGNABXDjpCwZ0ANpCrog6ALAeAv2v7ZeYzbn9ktYA7pcwwE47MI/d/RLPe7/FYpgyYFk6+6XJTJf2S9MJOAz6fb90yOPl/ZLzmoFq4kx+KzqdAtqhGMYC0KZqNNRACSgToR4ggT01Blrj3BimkS59LZSkaqeL8oQ/3y+5mY3+yn6JVPX4/+IrkE4jtrcK09AAAAAASUVORK5CYII=");
            background-size: 300%;
        }

        .player2 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAMAAADDApyIAAAANlBMVEUAAABPQi/iqSP////KiBXIlSKfeiCyeBTT0uDo5++OYhPrlOtLzv81kLhQQi26dbqEhIyLZCJp7vmyAAAAAXRSTlMAQObYZgAABLFJREFUaN7tmouu0zAQRJmtd/0Ilwv//7PsxgkVWjurWCoPqVORgMZzPLcVsEnz5a23/qxwnl8EAOM8R/klAIQE5znKrwDAG+0+bYyFfASAbJsmofltE4T5GODzTJn1RewIYT4GQJiIkr30zIIofxeAnIi+ER3HjDB/F8BqPMj00AUcF7gHgAE+PtQkPRkAUX4B8PUrPR4PPS0UiAFNCWpDF2i+xQUigP8Uq6a/l+96rHIvHwM6o5RqKsXSUT4EeOGpL2F+BZCpFlOlHBYIAIyhLY8uGe4Avi6AInwAUmJ4mxsOH40LPD+lw2cx2xPKCRBljOzTB4onwHJd3XbCE2AbeFvfpd3O+js0+A2eBab/J+4+A5j4UkoR80XgGzzzM0DeAQ0y8zNghyYNI7/t+QxpguECSgAKjrT3K1vNOm9YACQCJhX2936a7h90P8wEdIhRhg3rPNvz58Erhrjsmgzy1lt/T7BfeB0AAvv3DlF+GQARgFgQ5ZcBnyLYbEGUXwV8foI3XQBE+SUAGidKvO1jVZRfACCT2tTFiPK3Afh2TOaUTA1RfghIcwAefTIfE+ICMeCjT+YG+IGU4wJ3AV/7ZL5YIAb0uYwsb4AWFwgAfoFN5qaVfAzo43ntEqgd5WOAl5vOg3wM8G9D1YZZ/SgfAzD03dXBMC/dnwBApD4yJn5FonEDnAUSTxsYPxkbPN9AF/kG5nZfQLpotoGmGZZvGC+otc+G4NkGjNo3GAIsLef87/1WCgtM7BsAVoBzw5TfpADSjuHbC4KseWmcBUO/MLNgMiSjqMWavZr/mQswX8C9gDx/Rjf+Z7bTREBR92p0Z1YGOHMTDOLnNnMBF+6v7WF6xXyP98XBW/+AADu8DgBh6AGLeQ/wNgEiWMx7gLc3tT/jAksAQO2NbUoP8ysAtJxo20f0hii/ANB0V9JXRpS/DUBLJjru4X9DnI8BPm92n9Mxz6dRPgbkhB8G6PfwP+ICq4B+D/9rXOAuoBnACGqjlLhADPAE8/o9/Nt5D3ACpHYVODvKx4B4PI/z8fVB1obVfvzFvDjA8BuEoY+4ADidAIzzlFAnGyDDFhBO30uzBOmAglFew/MNGLYqEa42qODJBj2/XxuM82i2AKwdJhtYHi2zAQCfZ5iES2mY3YyCWIcRfyfueeYiY8A+L7ec0X1fQZr+Aoq0ST/pAL76O1CYUeYLJKsP8SsUzkrGFzDXiuvxHBcuZ9gJ436/EIvj+YkGggn//dXBW/+z3s8XBQAw0e4TMeJ8DPB5ogag6VkQ5e8DkBMdj/dQygjzASB+vijIrzxflBIdr+QIYT4GMD0BSogL3ANAAWZ01wCI8rcBTH2Fnfh2gRjQMtMpzi0uEAL84KJiZjvJvXwM6AwRNom4dJCPAfHjPXE+BuSUk0nPCwXMvwQgk1CXUMZlAcaQn3EAmNL4+aLUNX6+KBGfBXg8ANMJsMd8RvedzwKwP/jHVvKZP2xf4QkYbADYm2DKGIxwFnnmMbtbBUwAOL4WIYbwMP5bgbFgI3YywGx3UAbyBOAKTK8BMNudkmZRLwCSGnKa+/bWBxfR+6c9cymJ+/zWny/y34ZTBl71fBG6POQn8Qc3zq483X0AAAAASUVORK5CYII=");
            background-size: 300%;
        }

        .player3 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAMAAADDApyIAAAANlBMVEUAAABPQi/h39J7b3NaUVRsYmXT0L3Hw6vrlOs4SD////+6dbo7NzjSkZtHtJKWjn42im29XGtZxiBxAAAAAXRSTlMAQObYZgAABDNJREFUaN7tmo1u2zAMhHcmKXrr1m3v/7IzKbvpIMkHCeh+gBwQu+jpPtIJ6jCpPj311J8VrvMHAWC4ziy/BICK4jqz/AoAtkv6shtofh4A3fcjiSO/7wqa54A2b1sJbdYQaJ4DoLZtUrVtpmD5WQDSfiwAzc8CyiafP4cZp63wBuYACP/Hl/S//AwfLL8AeH1N/9u3hQY4wEuayGNx3sAEIFUXfNWvaU/mOaAy1EKaaZangFZ46BPNrwDKVjx0nGkDBGDo2Lb5VuWDBfcNQLVsp6R7q1Ccdv7c8uWKFw27JbwBVAQ9+/KBDgEievppt8IDEAVaO57EUMEnQNEWuPKjF+EBAPq+ecjQvwQ88kOABkChI9+AOOjgOVAPVb+7QARAw28KjDtUICGDFvK5H6Uzr6iHkYAKCcqgw093ylQTJZAGMK0W8tRTf0+IBz4OAEXcrsDyywCoAmIKll8GvKhijwUsvwp4eYHtxwKA5ZcA8Hg/sV3EHCy/AIDVuTkPBSw/DYBUbVUOlp8F4PM1macKaH4W8KVO5uF/R+PTPAe81sl8tQEOUIWEKsB5AxOAFHIyX8pzQApQsxKK8ZzmOaAVmc5JngDSdy+1PZrnAHT97ZCL4T7v4w7fRmsYBn6BSL8DnA1sNx0k32iB7gJo9T0RowJpIlf3F5QCs9sCBXZzCZF2ADoo4G6KkLULgGygOIZ8dU+2Xvy2SbOwzQYNHE5xDIbkQMMiezP/pz1eYLUBfVxjM/6bxWkgNBfX8O1gwPoU4CozFnDjvpVH6CPmezw/HDz1DwiIw8cBoIbjAJangLEtgCpongHG9n7YL7yBJQBw2LvFlE7zKwC4iezWfVfneQ5AOUdzOWRg+WkAfKuSKrA8B7T5tD/XOR00zwCtj+/h/6hzOm9gFfBa53TewCzAT0AIqrwBChgR8jv82TwH5OhZQmaKsEmeA/h4zvMc0DZZ3MNfyvs9ACZ1PkfPjAfNbycA/bwISvq9MOqC9Ed8gVeAos3zAhVxV8BQbgtYLOjnM4JaYfwUwUsCgDZvCKm5DwoocH28GH7pDS9mOgAcjsYRitHcm1XcddCfVoDd/Q1kgfGCjEN7Fap1Dvj34zlu3Aj37xOhN8TieH6hATLhP/918NT/rOf+IgKAiaQvYuB5DmjzciRxnnmeA9q8WCklz6D5WQA0fr+Fwlew/CwAJe1rQQHNzwLK9l6FNzAHQOOD5acB5b093QAHeCnvbOcNUEA7uT7kk3kOqAyvZqZZngDY9h6SX95ftIWW9xfhBCzvL7pvADCcgCKysL9IpFwNhN0IkAuQ90W2v6jlG8j+InkAOgV+31/UuwCQ/UV1xh4AYMiDGNz68fcN9JXTtwRgVD34w80xpIEQUopR9bzPnwXG77omY18Oj3yIzld75Ipo8/qt7y9q327EgI/aX4SqFvILhGIugf1wDVEAAAAASUVORK5CYII=");
            background-size: 300%;
        }

        .ghost0 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACABAMAAAAG8nGJAAAAG1BMVEUAAAD///+Xl5nr6+3JycvZ2d0uHiJcLgCSiozJiQerAAAAAXRSTlMAQObYZgAAAnpJREFUWMPtmD1u4zAQhQXeYKzsTzkeUQeIGR9gKeoAluT022y/Veptcu6VJSZjz5AEggABEmi6h+/L68IXpfo0Z4joLYKxzj2Q5AXB3gPAA0qeFUwH89VecS0wZ0NxLTQAi4GKpwXzK2aveFowJ1hvUDwj3Md8UFwLMf8B+P6bM/Oc8AjwjTPzrPAM8DNXwIJuVDwrPAH8+JsoyArr6YKM4NZY64KMMO7vAO6gGRTPCN1+B7CDxiueFqq2OczZtah4Wqjs0DjnaEJCwaUQs+ndfEdPwQsuhZccxjlPIXhCwYWAscOG83mOAQWnNbPg/YuxnBc8NrDACi0hYi6wC2eB6FUh4sAFxldCkCc5Vttt+/AV9oGz4EnhMVOQFZ4LBSzoRsWzwlOmICtAoUALbQd1YR+00DawX/KgeFqwzQ6GE4DziqcF0x7q/cyPqLgSojGSm29CIsGFoPchoOBCkM97IBJcCN6I519ylO+/RX7eU9zL9z9gcR9o5SwYKu9DZfGN+2Cq7bZ9+PT7ALnvBy1wPiUKisK/TAELulHxvMB//gueFwBUQfn7oYa6R8kzwrjgfd2i4mmhmyuH0662uiApVO2lstkdSfOEYAjt5e09NJPm8W4EGzzF513xmOlaMGRDWJ93r/liGCFc8vK8Y/QFt5YFNq7XRHAbrgW9DtYLboiF1ONvUfHyOpjIt0+HbR++0D6k8vYD7/r/UsyD4hmhWyudVzwtVO2aj6h4UiCy41I4oeLxbgTTO+ovBu+DLDA3AlEHK/eSx4yNEOw4c3cOGH3BzcE5YGFZhLOb4+2vD3PTTT0Leh/MkfrxhhMV98EM5X3Qhx+8D/8BDzN/wQMxqvoAAAAASUVORK5CYII=");
            background-size: 300%;
        }

        .ghost1 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACABAMAAAAG8nGJAAAAG1BMVEUAAAB/f39LS0x1dXZkZGVsbG4uHiJhW11NQ0U7Jn1dAAAAAXRSTlMAQObYZgAAAohJREFUWMPtmFGO2jAQhiPfwGSlvg4T5wDgRfS1jjkACVyB9rVaqT1ApZ67JvHWML9NtC+VqDJvv75vf7FIzASqpxnFzB8RlLH2lYGXBbPRWr8S8JKgOh2mdsBRSDwZwFFo9Dg1Ac8L6kvMDnheUEc9TQ+8IGxi3gIvCJv9W+j7udkCLwj297eN/nz5hQUFYX+5fNc/Ll+xAIT5PN+IHIXy/1QS4vuOBQVhWL9o/aKbHnhB6NYrrVe6ccDzQtU225BtS8DzQmX6xlrLJ2ISXAoxq4MNs3PsneBSeM9+CPnkvWMSXAgUO4w/n0P0JDhPOQnOvRvjOMFjQxKSwmOIOBWYkSeB+a/CnEIqUK4SAozgVC2z3Idnvw96/xYz8LxQh2WaLSgJn8K6LhegUM5zjcjnXzNyFNpO12m9A0ehbfR6zD3wvGCale6PWlsHPC+odluvA98RcBCiMbANcyJmwYWA98GT4EKQ690zCy4Ep8T6l5zk/jeU1nuOO7n/PT28D+xJ7H9+fB8qQx+8D6paZrkPT38fxgfhR/cBhfConSsoC+FhvlSAQjnPNiKff83IUbDju67rAwHPC4O+zrpuCXhe6EJlf1zVBguyQtVeK5vVjpFnBMVkrrt325yQx7kTjHcc1zvyafhWUGy8n9a7Qz4aSgjXPK53ir7gxiQhGbfXRHDjbwW8DsYJrjgJueVvSHAhwKjIl68Oy334f+5DNi9/EAZ+XwJeEIaYe+AFoZsqrQOeF6p2yjsCnhWYzTAWngh4nDtBHSwfNlfucnxU7gTmTk/cAZ+GGiGYIXB79hR9wdXWWp2E8SKcbYj3H5/EVXc6JAHvg9rxYbjjzA/vg+pn7gMM/eP78AdGHacGVfOacwAAAABJRU5ErkJggg==");
            background-size: 300%;
        }

        .ghost2 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACABAMAAAAG8nGJAAAAKlBMVEUAAAD/22L///ynhTqPjIr/zVresE3r6eLRzsPxwFMuHiJcLgDZ2d2SiowgL01nAAAAAXRSTlMAQObYZgAAAz1JREFUWMPtmLFqG0EURQ2TH3hIcuEkjRq1I4Yd2E4iBqk16y1UD1pQKwTyByzYrVkkUJnWXWpXadOlzddkdmfsZ+2dWWNMUhg9jOHqnH3luyudRebycsIhLnC83ZYT4ChwHA5H/gPkKHyysf4AeEyYr4f13EyAg8DcGcBBYO4N5CjMnvJ2ghwFu3A7HA3t32hbIkfB5nK9WQ83681tCTwo3E1n09nI/pvjgqBQXvWpv6E+XeMCFOx8u6IHml58p2wCHAU74op+EX2xGTkIPv8h+sqZeVR4ILoILYgKj0SffwQWRAU3uCAi5C4OcEFE2I3Pic4pqYBHhOW4R9SjxAAHwU2aZDbnqQQOghtdJXmeq71UMshZ8FmscjsLowoT5Cw85WJn874ojJIhzoL0O3RxONhYyBb3T7BgzJPRjGlxv4EFVlQTPOYFuuEsKPWsKMWBFwj7AAo4zFn5d3Pqhw/YD1ubgaPA531+UyJHgc97v8QFIPB5J6JLXAACn3c72QQ4Cv68u4w8JjxwBh4UHiMLogJ1LEAhXdKgox9QSBMaN7kCHhZ00qPqnig3wMOCSLPB2PKFBA6CN3Yqt2P7QYU4C9gPhQxxFtrnvVAqxFkwonX+21y277+WfN5D3LTvfyE7+0E5zoJQ3f1wpuUb+0EAiM+pH079YHPn9wcU7m749R94SChLfv0HHhLKKZF//QcOgu8DOxc/KUOOgh3h8m/KkKPA2W4EHhf49R94WIC+eP37w4AGKwk8LOwaPB6kEnhYWNqV1X1voHEBCM2k9cqkt1DIA4JQUte3N0v2yP0cCbowyp935G7US0EoXRTuvBvkjSFaQp2b8y693+Jas8DGyzZpcV28FLAdtGlxoVgIHX8tgXe3g2D+xjn1w8frh+dcAkfh9YzC3cwXyBwfCArltS+Qa1wAgrvWvkCyCXAQ3Gn0BZIhbwt8S+sSyYCDAMcXOAjR/K4H3v/7ks8V8IiwdCtzAxwEN6nLCwk8KCild83CvQTuhwX37q9WtcH90F4gjgSlluS4Ae5GJiz4hZbnh0J6v8VFlufEQtMIh9xG46PzmYvlfsUC9oNYqNXuiCvV2Q+i6u4HHPmf++EvuA0lfZxwF0UAAAAASUVORK5CYII=");
            background-size: 300%;
        }

        .ghost3 {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACABAMAAAAG8nGJAAAAHlBMVEUAAACA2vFMgZF2yeBlrMBtutEuHiJ2w9dhlKRNZXBxOF/6AAAAAXRSTlMAQObYZgAAAo5JREFUWMPtmEFu2zAQRQ3egFaAdDkeUQewGaPdlqIPEEm+gtEus0uX3TQ9QXvd0hJTxvNJC9kUcKG/+3jPAyFBZhSvbiaKmd8jKGPtAwMvC2artX4g4CVBtTqkcsBRSDwZwFGo9ZiKgOcF9Tl2BzwvqEc9pQNeELax74AXhO3zi9b3P592wAvCx19fn/S3028cUBA+nU7f9Y/TFxwAwlyfnYh8/pmRo2Djzx0HFIR+c6f1na474AWh3ay1XuvaAQdhSlPvQrcNAQdhiulqay0PxCS4FGJXBxuyd+yd4FJ47b4PffDeMQkuBIozjD8eQ/UkePxEEpx7NcY4weOEJCSFxxJxGmBGngTmvwpzKmmAcishQASn1ZLlPtz6fdDPL7EDzwv3YZlmB5SED2FdlwegUO5zE5HPPzNyFJpWV2m9A0ehqfVm7B3wvGDqte7CL8s64HlBNbtqE/iegIMQjZ5tyEDMggsB74MnwYUg17tnFlwITon1LznJ/W8oGmOQO7n/PV29D+xJ7H++fh9Wht55H9RqyXIfbv4+jC/C1+4DCuFVOzegLISX+dIAFMp9diLy+WdGjoLVIZWuDgQ8L/T6nE3VEPC80IaR3eO6MoQchZDGBl6v94w8Iygmc969u3pAHnMhGO84rnfkU/itoNh4P613h3w0lBDOfVzvFH3BjUlCMt5eE8GNfyvgdTBOcMVJyC1/Q4ILAaIiX/51WO7D/3Mfsn35QAh8vwS8IPSxd8ALQjuNtA44CFOaqe8JeFZgNv04cCDgMReCOlg+bM/cIZ+iLgTmVk/cAZ9CtRBMH7g9eoq+4GpnrU7CeBGONtTLP5/EVTsckoD3Qe350F9w5qv3QXUz9wFC//g+/AG4TbiOdP1LXAAAAABJRU5ErkJggg==");
            background-size: 300%;
        }



        .bomb {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAAAgCAMAAABzRoe3AAAAP1BMVEUAAABkZGZERESXl5kQEBL/XwB9fX/IJwAyMjTJycuIGwD/uwD/WDMgBgD/7ABYPDz6MQBwVlRkFAD/qJefh4ElQHfgAAAAAXRSTlMAQObYZgAAAvtJREFUWMPdl9Fu2zAMRRPHVtQ0blKn//+to0S5B8p1QHgr+jBuaR8OKZ4roUB7+M2a+GzRqAG8e3HcETU1PtEm49M0vdvX8pmkUed/OERcbX3x4zRQ1X+3/+UzTa4bzv+7fvyy9JgYcspM/cM/pSue1/r6vH1t7y5jcK368PH1f98vWcFF/aOURwjm1d0+t0/7t7nb5uBbDdYRJ7DdplgV9IDJEGVN9c6DecrutsrdLMnmbrhCb+heSJs8JXITyDcYHFut/vE8VW63fr9tLleu8/JCes3uh1wP83CsNeRXLXMtoJQvOPwNlxfSMsPmJ2oFHtPpdEqpZigtojkvl7PVZZnDBRHfHxDD1Q/7Sg16eYJhXBH65/v1er2XDC2C6iWbV8WYxwExTO73TE9vb2+agJqr/prgMuuCqtfmB8Yj3ge0IoIaSgLSGYWzAv/r4/HoEojfugHDmMcB1TCpX66HE8Afsr//RykCPCfIbHCDHHHxL1QTqGHCj3h9AIm42AMQoCZY5IIRFIOY5+cbzs4xhONHvFP/M7DeEQ/QB+AJuGAEGQ85/iuGI9gbJvy4HcpwayDicjZx9yfA0l8wGxiPueZTQTXsD4gDzBcL0IoAl7kX1PNjDk7cMPv7cebhjIODAO6vAZKeH3HB2gAHC1esAe74vwhwTN16xiMOVkEdB8MVa4CW4I7/U4ByRvL5lDg/4hgQEEEZd5rgin1Dqg0EKAmsXP++GYDoZZrxiIMRJCGcSnDBrwNQlkMCHHI7g+s75kPIEQRvJsydYfPPYA3Qb1gsANX8F2eq4NvTuINn8HZCMHwUTBXeGvQJ3P88N4jCgN6QMizm44rp4FdmfUEOAIt/17C0BPjfFydcQldpGEOuCShbP3acgBygmI5j3zAXZ+zNX38d7fYzHXNNYC55xwUoxp8ElPirAusjDh5z/sZ51Avo8qEnWBo0AX8OPCt6obeLj3Aa4gtQvN0wLyRY5p/9ox5Mw84LANOgEbzQ/93afwEaodbhv6o/t+U469lVpz8AAAAASUVORK5CYII=");
            background-size: 600%;
        }

        .burst {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABlVBMVEUAAAAKAAC7HwAAAAAUAgAHAAAMAAARAAAHAACmIQB/FABuDwB/EwAgAwA8BQADAAAtBAABAAAeAgAAAAAAAADINADHLwCrIAC+JwB/EQC7IQCFEQCrIAC1HACVGAB6EwCaGwCWGgCOFgBsEABDCABdDABuDgB2DwBlCwBYDAA5BgBtDQBOCQBZCwBRCQBWCwBJCQBVCQAWAwAtBAAKAAA1BQAiAwAlBAANAACuIgCcFQCaFABkDgBhDQB3EgB2EgApBQAlAwArBQAqBgAbAgAZAgAyBQAwBQD/wAD+vgD7tQDbUwD5rADrgQDdWQDRNQD6sQDrgwDXSAD9uwDqfgDiaADWRQD8uAD1oQDxlwDlcADkbQDeXAD3pgDshgDhYwDaUgDaTwDZTADONADALgC5KQD3qAD2owDymwDwlADwkwDujQDtiQDmdgDlcwDfYADcVgDXRgDVQQDQOwDOOADNMQDOLADMKACyJAC6IQDznQDvkQDtigDpewDjagDdWAD5rgDneADeWgDRPQCzHQCKFgCGEwB8ADvZAAAASHRSTlMAevMFRhwhDwv96OXelnhrQDQxJQf+/v78+/f39fPv7uzr087Dwb+7ubCspqOhnZGRhWJcS0pJPRT+/v7y797eqaWOin15Z2VQa1GfAAAB8klEQVQ4y62SVXfbQBCF1dqOGeMwMzOWuRVYYFmSZUlmZqZg+XdXrlVZjU7ylO9p9ty7Z3buDvDYaA4PNQ8atGaz9iGHa2V8fMV1v67bna4x07u6+3S9baFRDtcXbPq7ypD9SQ+rZaRyjWIjFuvfo31INjhXZ56KTI5Gi5mLb8joZO80s+oc9N5KkhEEQW65LOwPlDCxjJDJrcFb3AfGGId6vd7LrxBE5MQCLUWNB25A5st8jQ94PB7CB4IQIRYZrjr/WZnPYiOc9YMy/gBdX9QqDMNrCeyKGBjgvJBYG1bOuZ6MoCnonw55QpXkusJgsM3Wy1ce2QAS+fCPWZtB/sIjUxyjggMdhFKo0DAduSX9bCkRKWZ8oALfxTWSWDrT9B+w8YyhQyzsU+gwG6LJzkY/7E8TLQbjqWwQhqQGcDCA8gLTmvjYD2HH1MFJjPOyful+OsQJJN4x7UhR6E6257p4jM7B4m2oFxMfw7tz2yc6eQy9Y3MKFwoEBKfERkS+jE9tOvT/7967NkKx6RxKXaZZtNJ6q1on+0+yVKD479gNVSjGunaVwfm7Fr7ByHi8ekvTzC+nymB4hUercaPFYmwyUfylAVCx3G6Ovd47Pd17M9ZsLwNqPrww7zvOAeDcsW9+/h5Qc2x16aVuLusx8Hj8AZoqh5lfxK/HAAAAAElFTkSuQmCC");
            background-size: 100%;
        }

        .burn {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAAAgBAMAAAC2tmq2AAAAGFBMVEUAAAD/7AD/uwD/XwD/jwD//ADHPQD//9ieuLG9AAAAAXRSTlMAQObYZgAAAcxJREFUSMfskrFOwzAYhIOCMvNH4gHiVsxVHXlGrdWdIWK1cNU3QHl97r/adQgpgs69pTo3/j/f2dVNak5QWPaUhf41UQdMnKVOxXsI/lY10UIuJBttb6C9dcn3ntonby85fu0gFGPtzpi1teFs4TqRFiuBHvP1FwT6uozZXG2kx9eXxLE3VDph5HwSHD3nk+BmU+vFE3MEhO1Ug/kCgRBoMf+pqh6kxQID5H2MUIYSlktmxdnlCkLGCUUkLeYrgQvRv+aNj97NaqnzfK3kQjjmCg4pgMgAifDEFv9WFL7ANWqAEmEZEL1eonc5QCfPw/AmLSPU204GStrVBjwGYAQlNj0DpAgscS7sOXee/q2NzleC2bCSDnYcsdCikga8vBHE0PgpwC8DvDF6hz6khvKJ2VFUO0K64DQQAzACItV+Osr/fJjlFvOz+egYQE/8AmsBeFfAJwAWH0vZKWsXvwPcMuB8qQmwLYCV9gc7UljYh2imAOOO2lDp6DCLUKeHTUB65zsZkmQdtPMCQOdRGyod/REg1FUAGmJHd8DXyLFgUEQybZMp1TMazYsKehd2NC+uaV7h0LzKpHmlT+tmC80bXrRuOg6axi8lzXcAzu0erDyjLN4AAAAASUVORK5CYII=");
            background-size: 600%;
        }


        .dialog {
            position: absolute;
            background-color: #FFFFFF;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #aaa;
            box-shadow: 2px 2px 4px #888;
            display: none;
        }

        .btn {
            display: inline-block;
            padding: 0.2em 0.2em;
            background: #206020;
            color: white;
            box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
            font-weight: bold;
            font-size: 14px;
            text-align: center;
        }

        .grey_btn {
            display: inline-block;
            padding: 0.2em 0.2em;
            background: grey;
            color: white;
            box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
            font-weight: bold;
            font-size: 14px;
            text-align: center;
        }

        .pressed {
            transform: translateY(2px);
            box-shadow: 0px 0px 0px !important;
        }

        .btn:active {
            transform: translateY(2px);
            box-shadow: 0px 0px 0px;
        }

        .titlems {
            position: relative;
            top: 10%;
            left: 9%;
            width: 250px;
            font-size: 35px;
            font-weight: bold;
            background: #206020;
            color: white;
            box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.4);
        }

        .titlems::before {
            position: absolute;
            content: '';
            top: 100%;
            left: 0;
            border: none;
            border-bottom: solid 15px transparent;
            border-right: solid 20px rgb(149, 158, 155);
        }

        .drum {
            position: absolute;
            display: none;
            border: solid 0.5px;
            border-color: black rgba(200, 200, 200, 0.2);
            background: linear-gradient(to bottom, rgba(200, 200, 200, 0.5),
                    rgba(255, 255, 255, 0) 10%,
                    rgba(255, 255, 255, 0) 90%,
                    rgba(200, 200, 200, 0.5));
            width: 60px;
            height: 100px;
            overflow-x: hidden;
            overflow-y: scroll;
            text-align: center;
            z-index: 10;
        }

        .chara_outer_frame {
            position: absolute;
            display: block;
            padding: 1px;
            border: solid black 0.5px;
            font-size: 25px;
            font-weight: bold;
        }

        .chara_inner_frame {
            display: inline-block;
            border: solid blue 0.5px;
            width: 30px;
            height: 30px;
        }


        .arrow {
            color: white;
            display: inline-block;
            width: 75px;
            height: 60px;
            background: gray;
            border-radius: 5px;
            box-shadow: 2px 2px 2px 2px rgba(0, 0, 0, 0.2), -2px -2px 2px rgba(0, 0, 0, 0.4) inset, 2px 2px 2px rgba(255, 255, 255, 0.4) inset;
            position: relative;
        }

        .Left::after {
            content: "";
            display: inline-block;
            width: 0px;
            height: 0px;
            left: 14px;
            top: 10px;
            border-top: 19px solid transparent;
            border-right: 38px solid white;
            border-bottom: 19px solid transparent;
            position: absolute;
        }

        .Right::after {
            content: "";
            display: inline-block;
            width: 0px;
            height: 0px;
            left: 20px;
            top: 10px;
            border-top: 19px solid transparent;
            border-left: 38px solid white;
            border-bottom: 19px solid transparent;
            position: absolute;
        }

        .Down::after {
            content: "";
            display: inline-block;
            width: 0px;
            height: 0px;
            left: 17px;
            top: 15px;
            border-top: 30px solid white;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            position: absolute;
        }

        .up::after {
            content: "";
            display: inline-block;
            width: 0px;
            height: 0px;
            left: 17px;
            bottom: 15px;
            border-bottom: 30px solid white;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            position: absolute;
        }

        .bombkey::after {
            content: "";
            display: inline-block;
            left: 27px;
            top: 13px;
            position: absolute;
            width: 0px;
            height: 0px;
            border-radius: 50%;
            border: 17px solid white;
        }

        .punchkey::after {
            content: "";
            display: inline-block;
            left: 27px;
            top: 13px;
            position: absolute;
            width: 32px;
            height: 32px;
            background-color: white;

        }

        .arrow:active {
            transform: translateY(2px);
        }

        .bomb_button {
            position: absolute;
            display: block;
            width: 40px;
            height: 40px;
            border-radius: 100%;
            background-color: white;
        }

        .bomb_button:before {
            content: "";
            position: absolute;
            top: -20%;
            left: 55%;
            display: block;
            width: 99%;
            height: 99%;
            border: 3px solid transparent;
            border-top-color: white;
            border-radius: 50%;
            transform: rotate(-60deg);

        }

        .bomb_button:after {
            content: "";
            position: absolute;
            left: 55%;
            top: -3%;
            display: inline-block;
            width: 30%;
            height: 20%;
            border-radius: 15% 15% 100% 100%;
            background-color: white;
            transform: rotate(25deg);
        }

        .playername {
            position: absolute;
            display: block;
            opacity: 1;
            color: white;
            font-size: 15px;
            text-shadow: 2px 2px 2px black;
        }

        .bomb_icon {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADGSURBVChTjZErDsJAFEU7sIEGJKZLqMNiWAC7YBkobHeAwyBJ0Og6HIYEBY6PgxCScu4bmiDaGU5y+z6986adSf6hqqqVYseqABhzwslXETDPvwvCkzGlhIFzbqe61YyxTxijtTV+0RQ0RVtUogcSxdfioZGjvb1qZlgbe+hgrXZuKJV5ZmWcwvE4skFm24S5y/wm6fo6yEtHd/V5lLPMG59HKfWDmb4+gk7DrlwLRtZqRsaJGWto6GIW6IKeSKYl8hOTJPkAHDMZyVlk9lIAAAAASUVORK5CYII=");
            background-size: 70%;
            background-repeat: no-repeat;
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            top:-1px;
            left:0;
        }
        .bomb_num {
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            color:white;
            top:0;
            left:16px;
            font-size:15px;
        }

        .fire_icon {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHHSURBVDhPlZJLL0NhEIbPOSipIm5JaVwSRCVEY2/jD9hJRCLBxsZGxMrOhqXLxsYP8CP4Cy6NSkpUWrXRqksiglPPe/q1lJCY5OnMOzPfdM75jvWXua47A1NG/s/y+fwwhxOQJo6Y9A+zjS8zDjTCAUi6dsFG4clr+GLeABrHYFWhNKYBlfgYKBfmsPIZ/WAOegX2HZM4hX4O+cCGHPoSriAhyGVNzYfugzh8PgLPekbxjlD/+qiU4zjJQsntxFdAALRNE7UBYqu4gewY/FBJQ4qGQ2JtkSA+IqdhGqKeKHjmDeCfa3AhoM+uwmtNbXMOF5CFKlPT1iG2Uk9pg3WGBPFJ/DWNt8Qv8A5vipWjljY9regNYsth0ixMEKdJ3itHQzO+zdAur0OqwQPccGYcpnUdHUDOCtHUiw/ju/EN0APKNZDrUs3oEGde8R3F76AFt4CfgxzFE3ScWG8daetWetFDxPWwi97GZ0rXKKNhkrXWCPXWc2gNJvSev444wo0so/fUL/s+IAhR0LdQDd4A0Et95qC+gRFIoT0rGyBjgxgD/DS5yB38K3oefMSPbDBY6PzFGLAJSxyoNSltFiC3CFsmZcyyPgDjJP3kcu8NzQAAAABJRU5ErkJggg==");
            background-size: 95%;
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            top:0.5px;
            left:32px;
        }
        .fire_num {
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            color:white;
            top:0;
            left:48px;
            font-size:15px;
        }

        .speed_icon {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAF/SURBVDhPldPBK8NhHMfx/XZQhEZpsaIpB8kcHbRSyrKjf8E4kJLawcVFzUlu7g6S4qBcRGsOtKWEHIyy+AMcWC3J7/H+bL9fbew3+dSr7/M8+z3fPfs9zfIRY8wWJaRxVVKWZeWcsWfcBk+UMDZR0Bq5Q4YmpjJtEDWAMo/PKgfOI56pOQE1zjdGteYkz3zbGXtHDaC848VRQAp+57G6+flhK7qQZ+M6NYBn27Y7qN7hYfcEyg2SKKKEQ3QLjdSwJvWOF0Eee1hCE06R4H280mSUZlNoY60SJtUnUG6RhV2eGfOICaxhVQvkQXvdW9il9Gr8R3RbndBPKXKimNtggdL4Rf1OiQYb5RENzvDxTzva62egIx1hGi3owQrrCc2pQeoyFjVHO2aQhc/igWNqM8YYj3OsWcaDjjmMIA59kf50b0jiC2ld4zAbT6iXbB6g6hovNNdn0In0xjPoRx/0h9tHWL8/hnukEUAU18ggxL1HqDmcYwhB6J1dGWMmvwGtWF/OM8e/0AAAAABJRU5ErkJggg==");
            background-size: 90%;
            background-repeat: no-repeat;
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            top:1px;
            left:64px;
        }
        .speed_num {
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            color:white;
            top:0px;
            left:80px;
            font-size:15px;
        }

        .kick_icon {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAECSURBVDhPhZCxagJBFEV3LVIp+AUp0sZChYBVKqtUQnobfyABa/FXrFKlUghp8gURg1gKgWBjIVZJu543c92sO7t64O6bd9+d2d2JikiSZIBitYVUVPPU4jhOtC4k2MibHihz312AcBuN0QKtUUejcgjdoT3K8q1xOYQ+fDbgWZEAZlf2+HOxkFflTsC/RXO7nK23An5UU9jQpMzQjTUjlMf+ueXSgv5evrE7mkPfO5ao5waCvouyF7jXyIPxhKboBT1mvPytn/4Gxtb7KV/o1y9T7JC+tngwPt2oHDuoofg/mNdoY4kC3lBd0RAbondLZrDPqypyHoJ2KSttmsgWUXQATtCKZUpHBCAAAAAASUVORK5CYII=");
            background-size: 90%;
            background-repeat: no-repeat;
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            top:0;
            left:96px;
        }

        .punch_icon {
            background-size: 90%;
            background-repeat: no-repeat;
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            top:1px;
            left:112px;
        }

        .powerglove_icon {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAEKSURBVDhPhZEvT0JRGIfvHIEgG24Gihsbn8HGhk1tBD6AgVlNjM1kIxoMGOyOAkEYgYCbjeInMBkNBgNjhOvzO/d3ubrdO57t2XvOe973/Lk3Sonj+BifsI7v2PNSPhRcopjgHLd44uUMkof4hh1cozhzfHBZBskSqlA73qC4ww1+Y9mlgQMs4djxCF/xFgdYxS5Nz7gKzd5FV/hB0Xd8cVxgOr5QwywZxy3HpeNfdMUQ1XCajEOhjs4j3WTIFcPDH5P5XvS20FDBz5Aq5gtroUEw0dXSh+cxcmkGySbqqxXRdmkGyQYWXW/qsv+wcJ6s79Cp16ifmw+LH6oE/ae608VQdI9Xnpoo+gV91uFbKql6qQAAAABJRU5ErkJggg==");
            background-size: 75%;
            background-repeat: no-repeat;
            width:16px;
            height:16px;
            display:block;
            position:absolute;
            top:1px;
            left:128px;
        }
        -->
    </style>

</head>

<body onselectstart="return false" oncontextmenu="return false">


    <!-- ～～～～～～～～～～　ドラムロールとそのダイアログ　～～～～～～～～～～-->
    <div id="drumroll" style="position:absolute;top:190px;z-index:21;"></div>
    <div class="dialog" id="drumroll_dialog" style="position:absolute;display:none;top:175px;z-index:20;">
        <div id="drum_bar" style="position:absolute;border:solid 1px;border-color:blue transparent;left:9px;"></div>
        <div class="btn" id="roll_cancel" style="position:absolute;left:20px;bottom:15px;width:45px">Cancel</div>
        <div class="btn" id="roll_confirm" style="position:absolute;right:20px;bottom:15px;width:45px">OK</div>
    </div>

    <!-- ～～～～～～～～～～　ヘルプとそのダイアログ　～～～～～～～～～～-->
    <div class="dialog" id="help_dialog"
        style="position:absolute;display:none;top:175px;left:75px;top:155px;width:250px;height:200px;z-index:25;">
        <div id="help_message" style="position:absolute;left:15px;top:10px;width:220px;text-align:left"></div>
        <div class="btn" id="help_confirm" style="position:absolute;right:20px;bottom:15px;width:45px">OK</div>
    </div>

    <div id="whole">

        <!-- ～～～～～～～～～～　フィールド　～～～～～～～～～～-->
        <div id="field_layer" style="position:absolute;top:0;left:0;display:none;width:100%;height:100%;z-index: 1;">
        </div>
        <!-- ～～～～～～～～～～　アイコン　～～～～～～～～～～-->
        <div id="icon_layer" style="position:absolute;top:435px;left:230px;display:none;z-index: 2;">
            <div id="bomb_icon" class="bomb_icon"></div>
            <div id="bomb_num" class="bomb_num"></div>
            <div id="fire_icon" class="fire_icon"></div>
            <div id="fire_num" class="fire_num"></div>
            <div id="speed_icon" class="speed_icon"></div>
            <div id="speed_num" class="speed_num"></div>
            <div id="kick_icon" class="kick_icon"></div>
            <div id="punch_icon" class="punch_icon"></div>
            <div id="powerglove_icon" class="powerglove_icon"></div>
        </div>
        <!-- ～～～～～～～～～～　Hurry! フィールド　～～～～～～～～～～-->
        <div id="hurry_layer"
            style="position:absolute;top:180px;left:110px;display:none;width:100%;height:100%;font-size:70px;color:white;opacity:0.5;z-index:2;">
            Hurry!
        </div>
        <!-- ～～～～～～～～～～　タッチエリア　～～～～～～～～～～-->
        <div id="touch_area" style="position:absolute;height:100%;width:100%;display:block;z-index:3;"></div>

        <!-- ～～～～～～～～～～　コントローラーレイヤー　～～～～～～～～～～-->
        <div id="Controller"
            style="position: absolute;bottom:0;left:0;width:400px;height:124px;display:block;z-index: 4;">
            <div id="left_key" class="arrow Left" style="position: absolute;display:inline-block;left:0;bottom:32px;">
            </div>
            <div id="right_key" class="arrow Right"
                style="position: absolute;display:inline-block;left:154px;bottom: 32px;"></div>
            <div id="up_key" class="arrow up" style="position:absolute;display:inline-block;left:77px;bottom:64px;">
            </div>
            <div id="down_key" class="arrow Down"
                style="position: absolute;display:inline-block;left:77px;bottom: 2px;"></div>
            <div id="bomb_key" class="arrow bombkey"
                style="position: absolute;display: inline-block;right:20px;bottom:64px;width:90px;"></div>
            <div id="punch_key" class="arrow punchkey"
                style="position: absolute;display: inline-block;right:20px;bottom:0px;width:90px;display:none;">
            </div>
        </div>
        <!-- ～～～～～～～～～～　コントローラー消去ボタン　～～～～～～～～～～-->
        <div class="grey_btn" id="controller_nondisplay" style="position:absolute;left:175px;bottom:0px;z-index:4">
            Controller on/off</div>

        <!-- ～～～～～～～～～～　スライドコントローラー　～～～～～～～～～～-->
        <div style="position:absolute;width:100%;height:100%;z-index:2;">
            <div id="slidepadback"
                style="position:absolute;display:block;left:30px;bottom:140px;width:100px;height:100px;border-radius:50%;border:2px solid white;opacity:0.3;">
            </div>
            <div id="slidepad"
                style="position:absolute;display:block;left:57px;bottom:167px;width:0px;height:0px;border-radius:50%;border:25px solid white;opacity:0.3;">
            </div>
        </div>
        <!-- ～～～～～～～～～～　ボムボタン　～～～～～～～～～～-->
        <div id="bomb_button"
            style="position:absolute;left:300px;bottom:150px;width:80px;height:80px;border-radius:50%;border:2px solid white;opacity:0.5;z-index:4;">
            <div class="bomb_button" style="left:20px;top:20px;"></div>
        </div>

        <!-- ～～～～～～～～～～　パンチボタン　～～～～～～～～～～-->
        <div id="punch_button"
            style="position:absolute;left:215px;bottom:150px;width:80px;height:80px;border-radius:50%;border:2px solid white;opacity:0.5;display:none;z-index:4;">
            <div class="punch" style="left:15px;top:15px;"></div>
        </div>

        <!-- ～～～～～～～～～～　フェイドレイヤー1　～～～～～～～～～～-->
        <div id="fade_layer"
            style="position:absolute;width:100%;height:100%;background-color:black;opacity:0.5;display:none;z-index:5;">
            <div style="position:absolute;display:block;left:150px;top:200px;color:white;font-size:20px">Wait...
            </div>
        </div>

        <!-- ～～～～～～～～～～　フェイドレイヤー2　～～～～～～～～～～-->
        <div id="fade_layer2"
            style="position:absolute;width:100%;height:100%;background-color:black;opacity: 0.5;display: none;z-index:8;">
        </div>

        <!-- ～～～～～～～～～～　ダイアログレイヤー　～～～～～～～～～～-->
        <div id="dialogLayer" style="position:absolute;z-index:7">

            <!-- ～～～～～～～～～～　ステージ選択　～～～～～～～～～～-->
            <div id="stagescroll"
                style="position:absolute;width:270px;height:200px;top:90px;left:65px;display:none;overflow:hidden;border:1px solid black;z-index:21;">
                <div id="stage_roll" style="position:absolute;"></div>
                <div id="stage_bar"
                    style="position:absolute;top:-1px;left:60px;width:150px;height:200px;border:1px solid blue;z-index:1000;">
                </div>
            </div>
            <div class="dialog" id="stageselect_dialog"
                style="position:absolute;display:none;top:70px;left:50px;width:300px;height:340px;z-index:20;">
                <div class="btn" id="stage_left" style="position:absolute;left:15px;top:230px;width:40px">&lt;</div>
                <div class="btn" id="stage_right" style="position:absolute;right:15px;top:230px;width:40px">&gt;</div>
                <div class="btn" id="stage_cancel" style="position:absolute;left:20px;bottom:15px;">
                    &nbsp;&nbsp;Cancel&nbsp;&nbsp;</div>
                <div class="btn" id="stage_confirm" style="position:absolute;right:20px;bottom:15px;width:100px">ゲーム開始
                </div>
            </div>

            <!-- ～～～～～～～～～～　ニックネームダイアログ　～～～～～～～～～～-->
            <div class="dialog" id="end_dialog"
                style="position:relative;display:none;left:50px;top:50px;width:300px;height:300px;z-index:1">
                <br><br><br>
                <font size="5px"><b>
                        <div id="end_message">あなたの順位は...</div><br>
                    </b></font>
                <br>
                <div class="btn" id="end" style="position:absolute;left:130px;top:250px">&nbsp;&nbsp;終了&nbsp;&nbsp;
                </div>
            </div>


            <!-- ～～～～～～～～～～　タイトルダイアログ　～～～～～～～～～～-->
            <div id="title" class="dialog" style="left:50px;top:50px;width:300px;height:400px;">
                <div class="titlems">Bomber Nyan</div>
                <div id="code_help" class="grey_btn" style="position:absolute;left:85px;top:143px;">&nbsp;?&nbsp;
                </div>
                <div style="position:absolute;top:145px;left:115px">
                    対戦コード:
                </div>
                <div id="battle_code_input_num" class="chara_outer_frame" style="top:170px;left:35px;">
                    <div class="chara_inner_frame" id="battle_code0"></div>
                    <div class="chara_inner_frame" id="battle_code1"></div>
                    <div class="chara_inner_frame" id="battle_code2"></div>
                    <div class="chara_inner_frame" id="battle_code3"></div>
                    <div class="chara_inner_frame" id="battle_code4"></div>
                </div>
                <div class="btn" id="battle_code_input" style="position:absolute;top:175px;left:235px;">
                    変更
                </div>
                <div style="position:absolute;top:220px;left:10px">他Playerと同じ数値を入力してください<br>(好きな数値を決めてください)</div>
                <div class="btn" id="user_wait" style="position:absolute;left:115px;top:350px;font-size:20px">
                    &nbsp;&nbsp;Start&nbsp;&nbsp;
                </div>
            </div>

            <!-- ～～～～～～～～～～　ニックネーム入力ダイアログ　～～～～～～～～～～-->
            <div id="nickname_dialog"" class=" dialog" style="left:50px;top:50px;width:300px;height:370px;">


                <div id="player_help" class="grey_btn" style="position:absolute;left:70px;top:73px;">&nbsp;?&nbsp;
                </div>

                <div style="position:absolute;top:75px;left:100px">
                    ニックネーム:
                </div>
                <div id="user_name_input_num" class="chara_outer_frame" style="top:105px;left:80px;">
                    <div class="chara_inner_frame" id="user_name0"></div>
                    <div class="chara_inner_frame" id="user_name1"></div>
                    <div class="chara_inner_frame" id="user_name2"></div>
                </div>
                <div class="btn" id="user_name_input" style="position:absolute;top:105px;left:200px;">
                    変更
                </div>
                <div style="position:absolute;top:150px;left:10px">(他のPlayerと同一名でも対戦できます)</div>

                <div class="btn" id="enemy_cancel" style="position:absolute;left:20px;bottom:20px;font-size:15px">
                    &nbsp;&nbsp;Cancel&nbsp;&nbsp;
                </div>

                <div class="btn" id="enemy_wait" style="position:absolute;right:20px;bottom:20px;font-size: 17px">
                    &nbsp;&nbsp;参加&nbsp;&nbsp;
                </div>
            </div>

            <!-- ～～～～～～～～～～　参加者待ちダイアログ　～～～～～～～～～～-->
            <div class="dialog" id="join_dialog"
                style="position:relative;display:none;left:50px;top:50px;width:300px;height:300px;font-size:25px;font-weight:bold;">
                <div style="position:relative;top:20px;margin:auto;">参加者：</div><br>
                <div id="enemy_names0"
                    style="position:absolute;left:20px;top:70px;width:120px;display:block;font-size:20px;"></div>
                <div id="enemy_names2"
                    style="position:absolute;left:150px;top:70px;width:120px;display:block;font-size:20px;"></div>
                <div id="enemy_names3"
                    style="position:absolute;left:20px;top:140px;width:120px;display:block;font-size:20px;"></div>
                <div id="enemy_names1"
                    style="position:absolute;left:150px;top:140px;width:120px;display:block;font-size:20px;"></div>
                <br>
                <div class="btn" id="decline" style="position:absolute;left:20px;top:250px;font-size:15px">
                    &nbsp;&nbsp;Cancel&nbsp;&nbsp;
                </div>
                <div class="btn" id="join" style="position:absolute;right:20px;top:250px;font-size:15px">
                    &nbsp;&nbsp;ステージ選択へ&nbsp;&nbsp;
                </div>
            </div>

            <!-- ～～～～～～～～～～　スタート待ちのダイアログ　～～～～～～～～～～-->
            <div class="dialog" id="wait_dialog"
                style="position:absolute;display:none;top:175px;left:125px;top:155px;width:150px;height:100px;z-index:2;">
                <div id="help_message" style="position:absolute;left:15px;top:10px;text-align:center">
                    他の参加者待ち</div>
                <div class="grey_btn" id="start_cancel" style="position:absolute;left:45px;bottom:15px;width:60px">
                    Cancel
                </div>
            </div>

            <!-- ～～～～～～～～～～　ポーズダイアログ　～～～～～～～～～～-->
            <div id="pause" class="dialog" style="left:50px;top:60px;width:300px;height:350px">
                <br>
                <div style="font-size:35px;font-weight:bold;">Pause !!</div><br>
                <div class="btn" id="ControllerSwitch">&nbsp;コントローラー&nbsp;<br>&nbsp;&nbsp;on/off&nbsp;</div>
                <br><br><br><br>
                <div class="btn" id="TouchSwitch">&nbsp;タッチ操作&nbsp;<br>&nbsp;&nbsp;on/off&nbsp;</div>
                <br><br><br><br>
                <div class="btn" id="Pause_end">&nbsp;&nbsp;もどる&nbsp;&nbsp;</div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script>

    <script>
        var socket = io("/bomber");
        var debug_F = false;

        stage_roll = {
            display: function (width, num, callback) {
                let offset = 95;
                let scrollstart_x, scrollmove_x;
                this.scroll_size = width;
                this.scroll_offset = -offset;
                this.scroll_x = -offset;
                let move_x;
                this.scroll_max = Math.floor(((-width * num + offset - this.scroll_offset) + (this.scroll_size) / 2) / (this.scroll_size)) * (this.scroll_size) + this.scroll_offset;
                this.callback = callback;
                document.getElementById("stage_roll").style.left = this.scroll_offset + "px"
                document.getElementById("stageselect_dialog").addEventListener('touchstart', function (event) {
                    event.preventDefault();
                }, { passive: false });
                document.getElementById("stagescroll").style.display = "block";

                document.getElementById("stagescroll").addEventListener('touchstart', function (event) {
                    scrollstart_x = event.targetTouches[0].pageX;
                }, { passive: false });
                document.getElementById("stagescroll").addEventListener('touchmove', function (event) {
                    scrollmove_x = event.targetTouches[0].pageX;
                    move_x = stage_roll.scroll_x + scrollmove_x - scrollstart_x
                    if (move_x > stage_roll.scroll_offset) {
                        move_x = stage_roll.scroll_offset;
                    } else if (move_x < stage_roll.scroll_max) {
                        move_x = stage_roll.scroll_max;
                    }
                    document.getElementById("stage_roll").style.left = move_x + "px";
                }, { passive: false });
                document.getElementById("stagescroll").addEventListener('touchend', function (event) {
                    stage_roll.scroll(move_x - stage_roll.scroll_x);
                }, { passive: false });

            },
            scroll: function (offset) {
                let move_x = stage_roll.scroll_x + offset
                if (move_x > stage_roll.scroll_offset) {
                    move_x = stage_roll.scroll_offset;
                } else if (move_x < this.scroll_max) {
                    move_x = this.scroll_max;
                }
                let b = Math.floor(((move_x - this.scroll_offset) + (this.scroll_size) / 2) / (this.scroll_size)) * (this.scroll_size) + this.scroll_offset;
                document.getElementById("stage_roll").style.left = b + "px";
                this.scroll_x = b;
            },

            confirm: function () {
                let a = -this.scroll_x;
                let b = parseInt((a - this.scroll_offset + (this.scroll_size) / 2) / (this.scroll_size)) - 1
                document.getElementById("stagescroll").style.display = "none";
                document.getElementById("stageselect_dialog").style.display = "none";
                this.callback(b)
            }
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～～　ドラムロールで文字入力　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        drumroll = {
            display: function (characters, length, width, height, initial_value, callback) {
                this.scroll_size = height + 2
                this.scroll_offset = this.scroll_size * 1.5;
                this.characters = characters;
                this.length = length;
                document.getElementById("fade_layer2").style.display = "block";
                document.getElementById("drumroll_dialog").addEventListener('touchstart', function (event) {
                    event.preventDefault();
                }, { passive: false });

                char_roll = "";
                div_tag = '<div style="display:block;height:' + String(height + 1) + 'px">'
                for (let i = 0; i < characters.length; i++) {
                    char_roll += div_tag + characters.substr(i, 1) + "</div>";
                }
                drums = "";
                for (let i = 0; i < length; i++) {
                    drums += '<div id="roll' + String(i) + '" class="drum" style="display:block;left:' + String(i * width) + 'px;width:' + String(width) + 'px;height:' + String(this.scroll_size * 4) + 'px;font-size:' + String(height) + 'px"><b>'
                    drums += Array(4).join(div_tag + '</div>') + char_roll + Array(2).join(div_tag + '</div>')
                    drums += '<div style="height:' + String(this.scroll_size * 0.8) + 'px;"></div>' + "</b></div>"
                }
                document.getElementById("drumroll").style.left = String(200 - (width * length) / 2) + "px"
                document.getElementById("drumroll").innerHTML = drums;
                document.getElementById("drumroll").style.display = "block";
                document.getElementById("drumroll_dialog").style.height = String(this.scroll_size * 4 + 80) + "px";
                document.getElementById("drumroll_dialog").style.display = "block";
                document.getElementById("drumroll_dialog").style.left = String(200 - (width * length) / 2 - 10) + "px"
                document.getElementById("drumroll_dialog").style.width = String((width * length) + 20) + "px"
                document.getElementById("drum_bar").style.width = String((width * length)) + "px"
                document.getElementById("drum_bar").style.top = String(this.scroll_offset + 12) + "px"
                document.getElementById("drum_bar").style.height = String(this.scroll_size) + "px"

                for (let i = 0; i < length; i++) {
                    let rolltouch_F = false;
                    document.getElementById("roll" + String(i)).addEventListener('scroll', function (event) {
                        let timeoutID;
                        let top = document.getElementById("roll" + String(i)).scrollTop
                        if (top < drumroll.scroll_offset) {
                            document.getElementById("roll" + String(i)).scrollTop = drumroll.scroll_offset;
                        }
                        clearTimeout(timeoutID)

                        adjust = function () {
                            if (rolltouch_F) {
                                timeoutID = setTimeout(adjust, 100);
                            } else {
                                let a = document.getElementById("roll" + String(i)).scrollTop;
                                let b = Math.floor(((a - drumroll.scroll_offset) + (drumroll.scroll_size - 1) / 2) / (drumroll.scroll_size - 1)) * (drumroll.scroll_size - 1) + drumroll.scroll_offset;
                                document.getElementById("roll" + String(i)).scrollTop = b;
                            }
                        }
                        timeoutID = setTimeout(adjust, 500);
                    });
                    document.getElementById("roll" + String(i)).addEventListener('touchend', function (event) {
                        rolltouch_F = false;
                    }, { passive: false });
                    document.getElementById("roll" + String(i)).addEventListener('touchstart', function (event) {
                        rolltouch_F = true;
                    }, { passive: false });
                }
                char = (initial_value + Array(10).join(characters.slice(0, 1))).slice(0, length)
                for (let i = 0; i < length; i++) {
                    document.getElementById("roll" + String(i)).scrollTop = characters.indexOf(char.substr(i, 1)) * (this.scroll_size - 1) + this.scroll_offset
                }

                this.callback = callback
            },

            confirm: function () {
                let score_name = [];
                for (let i = 0; i < this.length; i++) {
                    let a = document.getElementById("roll" + String(i)).scrollTop;
                    let b = parseInt((a - this.scroll_offset + (this.scroll_size - 1) / 2) / (this.scroll_size - 1))
                    score_name[i] = this.characters.substr(b, 1);
                }
                document.getElementById("fade_layer2").style.display = "none";
                document.getElementById("drumroll").style.display = "none";
                document.getElementById("drumroll_dialog").style.display = "none";
                this.callback(score_name)

            },
            cancel: function () {
                document.getElementById("fade_layer2").style.display = "none";
                document.getElementById("drumroll").style.display = "none";
                document.getElementById("drumroll_dialog").style.display = "none";
                this.callback(null);
            }

        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　タイトル画面のヘルプ表示　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        display_help = {
            display: function (message) {
                document.getElementById("fade_layer2").style.display = "block";
                document.getElementById("help_dialog").addEventListener('touchstart', function (event) {
                    event.preventDefault();
                }, { passive: false });
                document.getElementById("help_message").innerHTML = message;
                document.getElementById("help_dialog").style.display = "block";
                let height = document.getElementById("help_message").clientHeight
                document.getElementById("help_dialog").style.height = (height + 60) + "px";
                document.getElementById("help_dialog").style.top = 230 - (height / 2 + 30) + "px"
                document.getElementById("help_dialog").style.display = "block";
            },
            confirm: function () {
                document.getElementById("fade_layer2").style.display = "none";
                document.getElementById("help_dialog").style.display = "none";
            }
        }

        button_set("code_help", function () { display_help.display("同じ数値を入力したPlayerと対戦できます。初期値はランダムですが2回目から前回のコードが表示されます。(数値は何でもかまいません)") });
        button_set("player_help", function () { display_help.display("他のPlayerの画面にこの名前が表示されます。(他のPlayerと同じ名前でも対戦できます)") });
        button_set("help_confirm", function () { display_help.confirm() });
        button_set("start_cancel", function () { game_decline(); });
        button_set("decline", function () { game_decline(); });
        button_set("user_wait", function () { user_wait() });
        button_set("join", function () { stage_select() });
        button_set("stage_right", function () { stage_roll.scroll(-stage_roll.scroll_size) });
        button_set("stage_left", function () { stage_roll.scroll(stage_roll.scroll_size) });
        button_set("stage_confirm", function () { stage_roll.confirm() });
        button_set("stage_cancel", function () { location.reload() });
        button_set("enemy_cancel", function () { location.reload() });
        button_set("enemy_wait", function () { get_enemy_names() });
        button_set("battle_code_input", function () { get_battle_code() });
        button_set("battle_code_input_num", function () { get_battle_code() });
        button_set("user_name_input", function () { get_user_name() });
        button_set("user_name_input_num", function () { get_user_name() });
        button_set("roll_confirm", function () { drumroll.confirm() });
        button_set("roll_cancel", function () { drumroll.cancel() });
        button_set("end", function () { location.reload() });
        button_set("controller_nondisplay", function () { controller_nondisplay() });

        active_button_set("left_key", function () { keyboard(37) }, function () { keyboardup(37) })
        active_button_set("right_key", function () { keyboard(39) }, function () { keyboardup(39) })
        active_button_set("up_key", function () { keyboard(38) }, function () { keyboardup(38) })
        active_button_set("down_key", function () { keyboard(40) }, function () { keyboardup(40) })
        active_button_set("bomb_key", function () { keyboard(32) }, function () { keyboardup(32) });
        active_button_set("bomb_button", function () { keyboard(32) }, function () { keyboardup(32) });
        active_button_set("punch_key", function () { keyboard(78) }, function () { keyboardup(78) });
        active_button_set("punch_button", function () { keyboard(78) }, function () { keyboardup(78) });


        function controller_nondisplay() {
            let display = document.getElementById("Controller").style.display;
            if (display == "block") {
                document.getElementById("Controller").style.display = "none";
                controller_display = "none";
                localStorage.setItem(game_name + "controllerdisplay", controller_display);
                punchbutton_adjust_y = 90;

            } else {
                document.getElementById("Controller").style.display = "block";
                controller_display = "block";
                localStorage.setItem(game_name + "controllerdisplay", controller_display);
                punchbutton_adjust_y = 0;
            }
            document.getElementById("slidepadback").style.bottom = (140 - punchbutton_adjust_y) + "px";
            document.getElementById("slidepad").style.bottom = (167 - punchbutton_adjust_y) + "px";
            document.getElementById("bomb_button").style.bottom = (150 - punchbutton_adjust_y) + "px";
            document.getElementById("punch_button").style.bottom = (150 - punchbutton_adjust_y) + "px";

        }

        function insert_chara(id, characters) {
            for (let i = 0; i < characters.length; i++) {
                document.getElementById(id + String(i)).innerHTML = characters.substr(i, 1)
            }
        }

        function get_battle_code() {
            drumroll.display("0123456789", 5, 50, 25, battle_code, function (input) {
                if (input != null) {
                    battle_code = input.join("");
                    insert_chara("battle_code", battle_code)
                    localStorage.setItem(game_name + "battle_code", battle_code);
                }
            })
        }

        function get_user_name() {
            drumroll.display("ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789._", 3, 80, 30, user_name, function (input) {
                if (input != null) {
                    user_name = input.join("");
                    insert_chara("user_name", user_name)
                    localStorage.setItem(game_name + "user_name", user_name);
                }
            })
        }

        function user_wait() {
            document.getElementById("title").style.display = "none"
            document.getElementById("nickname_dialog").style.display = "block"
        }

        function get_enemy_names() {
            document.getElementById("nickname_dialog").style.display = "none"
            document.getElementById("join_dialog").style.display = "block"
            my_username = user_name + get_date()
            users = { [my_username]: { users: 1, rank: 0 } };
            socket.emit("call", { [battle_code + "join"]: users });
            joining_F = true;
            console.log("my name", my_username)

            socket.on(battle_code + "join", function (doc) {
                if (joining_F) {
                    let write_F = false;
                    for (i in doc) {
                        if (doc[i].users == 0) {
                            delete users[i];
                            write_F = true;
                        } else if (users[i] != undefined) {
                            users[i] = doc[i];
                        } else if (Object.keys(users).length < user_num) {
                            write_F = true;
                            users[i] = doc[i];
                        }
                    }

                    users[my_username].users = Object.keys(users).length;

                    if (write_F) {
                        socket.emit("call", { [battle_code + "join"]: { [my_username]: users[my_username] } });
                    }

                    let usernames = Object.keys(users);
                    let userorder = usernames.slice().sort((a, b) => parseInt(a.slice(3)) - parseInt(b.slice(3)));
                    document.getElementById("enemy_names" + userorder.indexOf(my_username)).style.border = "1px solid black"

                    for (let i = 0; i < 4; i++) {
                        if (i < userorder.length) {
                            let user_list = '<div class="player' + i + '" style="display:inline-block;width:50px;height:50px;"></div>';
                            user_list += userorder[i].substr(0, 3) + "&nbsp;" + '<div style="display:inline-block;font-size:15px;">' + users[userorder[i]].users + '</div>';
                            document.getElementById("enemy_names" + i).innerHTML = user_list;
                        } else {
                            document.getElementById("enemy_names" + i).innerHTML = "";
                        }
                        if (userorder[i] == my_username) {
                            document.getElementById("enemy_names" + i).style.border = "1px solid black";
                        } else {
                            document.getElementById("enemy_names" + i).style.border = "";
                        }
                    }
                }

            });
        }

        function game_decline() {
            socket.emit("call", { [battle_code + "join"]: { [my_username]: { users: 0 } } });
            location.reload();
        }

        function get_date() {
            let dt = new Date();
            return dt.toJSON().replace(/\:/g, "").replace(/\./g, "").substr(-10, 9);
        }

        function shuffle_array(array) {
            for (let i = array.length - 1; i > 0; i--) {
                let r = Math.floor(Math.random() * (i + 1));
                [array[i], array[r]] = [array[r], array[i]]
            }
            return array
        }


        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　フィールド　　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        var field = function (layer_name, field_name, position_x, position_y, original_field_data) {
            let field_data = JSON.parse(JSON.stringify(original_field_data));
            this.layer_name = layer_name;
            this.field_name = field_name;
            this.position_x = position_x - field_data.block_size;
            this.position_y = position_y - field_data.block_size;
            this.field_size_x = field_data.field_array[0].length;
            this.field_size_y = field_data.field_array.length;
            this.block_size = field_data.block_size;
            this.display_size = field_data.display_size;
            this.softblock = field_data.softblock;
            this.ground_block = field_data.ground_block;
            this.background_block = field_data.background_block;
            this.wall_block = field_data.wall_block;

            this.hurryblocks = [];
            this.hurryblocks_time_ID = [];

            /* ～～～～～～～～～～　フィールドとブロックを生成　～～～～～～～～～～ */
            this.field_array = field_data.field_array.slice();

            let spaces = shuffle_array(this.get_spaceposition(0));
            for (let i = 0; i < Math.floor(spaces.length * field_data.softblock_rate); i++) {
                let [x, y] = spaces[i];
                this.field_array[y][x] = this.softblock;
            }

            let softblocks = shuffle_array(this.get_spaceposition(this.softblock));
            for (let i = 0; i < Math.min(field_data.items.length, softblocks.length); i++) {
                let [x, y] = softblocks[i];
                this.field_array[y][x] = this.softblock + field_data.items[i];
            }

            /* ～～～～～～～～～～　フィールド表示領域の生成　～～～～～～～～～～ */
            let field_tag = '<div id="' + this.field_name + '" style="position:absolute;width:' + String(this.block_size * this.field_size_x)
                + 'px; height:' + String(this.block_size * this.field_size_y + 0.5) + 'px">';
            for (let j = 0; j < this.field_size_y; j++) {
                field_tag += "";
                for (let i = 0; i < this.field_size_x; i++) {
                    field_tag += '<div id="' + this.field_name + String(i + j * this.field_size_x) + '" style="position:absolute;"></div>';
                }
            }
            field_tag += '</div>';
            document.getElementById(this.layer_name).innerHTML += field_tag;
            document.getElementById(this.layer_name).style.backgroundSize = String(this.block_size) + "px";
            document.getElementById(this.layer_name).className = this.background_block;
            document.getElementById(this.field_name).style.backgroundSize = String(this.block_size) + "px";
            document.getElementById(this.field_name).className = this.ground_block;
            document.getElementById(this.field_name).style.left = String(this.position_x) + "px";
            document.getElementById(this.field_name).style.top = String(this.position_y) + "px";
            document.getElementById(this.layer_name).style.display = "block";

        }

        field.prototype.put_array = function (x, y, block) {
            this.field_array[y][x] = block;
            this.draw_block(x, y, block);
        }

        field.prototype.set_hurryblock = function (time) {
            let hurryblock_start = time * 1000;
            let width = Field.field_size_x - 6;
            let height = Field.field_size_y - 6;
            let left = 3;
            let top = 3;
            let right = Field.field_size_x - 4;
            let bottom = Field.field_size_y - 4;
            let x = left;
            let y = bottom + 1;
            while (left < right && top < bottom) {
                while (y > top) {
                    y -= 1;
                    this.hurryblocks.push([x, y]);
                }
                top += 1;
                while (x < right) {
                    x += 1;
                    this.hurryblocks.push([x, y]);
                }
                right -= 1;
                while (y < bottom) {
                    y += 1;
                    this.hurryblocks.push([x, y]);
                }
                bottom -= 1;
                left += 1;
                while (x > left) {
                    x -= 1;
                    this.hurryblocks.push([x, y]);
                }
            }
            for (let i = 0; i < 3; i++) {
                this.hurryblocks_time_ID.push(setTimeout(function () {
                    document.getElementById("hurry_layer").style.display = "block";
                }, hurryblock_start + i * 1000))
                this.hurryblocks_time_ID.push(setTimeout(function () {
                    document.getElementById("hurry_layer").style.display = "none";
                }, hurryblock_start + i * 1000 + 500))
            }
            for (let i = 0; i < this.hurryblocks.length; i++) {
                this.hurryblocks_time_ID.push(setTimeout(function () {
                    this.draw_block(this.hurryblocks[i][0], this.hurryblocks[i][1], 900)
                }.bind(this), i * 400 + hurryblock_start + 3000));
                this.hurryblocks_time_ID.push(setTimeout(function () {
                    let [x, y] = this.conv_xy(player_array[0].position_x, player_array[0].position_y)
                    if (x == this.hurryblocks[i][0] && y == this.hurryblocks[i][1]) {
                        player_array[0].die_F = true;
                        call_emit(battle_code + my_username + "end", { died: true, items: player_array[0].items, player: my_username, ghost_F: false, position: [player_array[0].position_x, player_array[0].position_y] })
                    }
                    bomb_array.forEach((value, index) => {
                        let [x, y] = value.field.conv_xy(value.position_x, value.position_y);
                        if (x == this.hurryblocks[i][0] && y == this.hurryblocks[i][1]) {
                            value.misfire();
                        }
                    })
                    this.draw_block(this.hurryblocks[i][0], this.hurryblocks[i][1], this.wall_block);
                    //this.field_array[this.hurryblocks[i][1]][this.hurryblocks[i][0]] = this.wall_block;
                    this.put_array(this.hurryblocks[i][0], this.hurryblocks[i][1], this.wall_block)
                }.bind(this), i * 400 + 200 + hurryblock_start + 3000));
            }

        }

        field.prototype.draw_block = function (X, Y, block_number) {
            if (Y >= 0) {
                if (block_number >= 100 && block_number < 900) {  // --- 通れる地形 (平地と同じ扱い)
                    let field_tag = '<div id="' + this.field_name + "thru" + String(X + Y * this.field_size_x) + '" style="position:absolute;"></div>';
                    document.getElementById(this.field_name).innerHTML += field_tag;
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.zIndex = "0";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.width = this.block_size + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.height = this.block_size + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.left = X * this.block_size + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.top = Y * this.block_size + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).className = "block" + String(block_number);
                    this.field_array[Y][X] = 0;
                }
                if (block_number >= 0 && block_number < 1000) {  // --- 平地とアイテム
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = "0";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block" + String(block_number);
                    if (debug_F) {
                        if (this.block_size > 10) {
                            document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.fontSize = "10px";
                            document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.color = "white"
                            document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = String(block_number)
                        } else {
                            document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = "";
                        }
                    }

                } else if (block_number >= 1000 && block_number < 2000) {  // --- ソフトブロック
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = String(Y * 30 + 10);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size - (this.display_size - this.block_size) / 2 + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size - this.display_size + this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block" + String(block_number - block_number % 100);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = "";

                } else if (block_number >= 2000 && block_number < 3000) {  // --- ハードブロック
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = String(Y * 30 + 20);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size - (this.display_size - this.block_size) / 2 + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size - this.display_size + this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block" + String(block_number);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = "";

                } else if (block_number >= 3000 && block_number < 4000) {  // --- 貫通ソフトブロック
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = String(Y * 30 + 10);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size - (this.display_size - this.block_size) / 2 + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size - this.display_size + this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block" + String(block_number - block_number % 100);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = "";

                } else if (block_number >= 4000 && block_number < 4500) {  // --- 貫通ハードブロック
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = String(Y * 30 + 0);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size - (this.display_size - this.block_size) / 2 + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size - this.display_size + this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block" + String(block_number);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = "";

                } else if (block_number >= 4500 && block_number < 5000) {  // --- 貫通ハードブロック
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = "0";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.display_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size - (this.display_size - this.block_size) / 2 + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size - this.display_size + this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block" + String(block_number);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = "";

                } else if (block_number >= 5000 && block_number < 6000 && debug_F) {  // --- 爆弾
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = "0";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block5000";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.fontSize = "10px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.color = "white";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = String(block_number);

                } else if (block_number >= 6000 && block_number < 7000) {  // --- 通り抜けブロック(土管など)
                    let field_tag = '<div id="' + this.field_name + "thru" + String(X + Y * this.field_size_x) + '" style="position:absolute;"></div>';
                    document.getElementById(this.field_name).innerHTML += field_tag;
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.zIndex = String(Y * 30 + 61);
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.width = this.display_size + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.height = this.display_size + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.left = X * this.block_size - (this.display_size - this.block_size) / 2 + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).style.top = Y * this.block_size - this.display_size * 0.87 + this.block_size + "px";
                    document.getElementById(this.field_name + "thru" + String(X + this.field_size_x * Y)).className = "block" + String(block_number);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = "";
                    this.field_array[Y][X] = 0;

                } else if (block_number >= 10000 && block_number < 11000 && debug_F) {  // --- 爆風
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.zIndex = "0";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.left = X * this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.top = Y * this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).className = "block5000";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).innerHTML = String(block_number);
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.color = "white";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.fontSize = "10px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.width = this.block_size + "px";
                    document.getElementById(this.field_name + String(X + this.field_size_x * Y)).style.height = this.block_size + "px";
                }
            }
        }

        field.prototype.refresh_field = function () {
            for (let i = 1; i < this.field_size_y - 1; i++) {
                for (let j = 1; j < this.field_size_x - 1; j++) {
                    this.draw_block(j, i, this.field_array[i][j]);
                }
            }
        }

        field.prototype.collision_detect = function (x, y, offset_x, offset_y) {
            let ux = 0;
            let uy = 0;
            let [sx, sy] = this.conv_xy(x, y);
            let [tx, ty] = this.conv_xy(x + offset_x, y + offset_y);
            let c_block = this.field_array[sy][sx];
            if (this.field_array[sy][tx] >= 1000 && this.field_array[sy][tx] < 10000 && offset_x != 0) {
                ux = offset_x + x % this.block_size - (offset_x > 0 ? this.block_size : 0);
                c_block = this.field_array[sy][tx];
            }
            if (this.field_array[ty][sx] >= 1000 && this.field_array[ty][sx] < 10000 && offset_y != 0) {
                uy = offset_y + y % this.block_size - (offset_y > 0 ? this.block_size : 0);
                c_block = this.field_array[ty][sx];
            }
            return [ux, uy, c_block]
        }

        field.prototype.collision_detect2 = function (x, y, offset_x, offset_y) {
            let ux = 0;
            let uy = 0;
            let [sx, sy] = this.conv_xy(x, y);
            let [tx, ty] = this.conv_xy(x + offset_x, y + offset_y);
            let c;
            if (((this.field_array[sy][tx] > 0 && this.field_array[sy][tx] < 4500) || this.field_array[sy][tx] > 5000) && offset_x != 0) {
                ux = offset_x + x % this.block_size - (offset_x > 0 ? this.block_size : 0);
                c = this.field_array[sy][tx]
            }
            if (((this.field_array[ty][sx] > 0 && this.field_array[ty][sx] < 4500) || this.field_array[ty][sx] > 5000) && offset_y != 0) {
                uy = offset_y + y % this.block_size - (offset_y > 0 ? this.block_size : 0);
                c = this.field_array[ty][sx]
            }
            return [ux, uy, c]
        }

        field.prototype.conv_xy = function (x, y) {
            let sx = Math.floor(x / this.block_size);
            let sy = Math.floor(y / this.block_size);
            return [sx, sy]
        }
        field.prototype.std_xy = function (x, y) {
            let [sx, sy] = this.conv_xy(x, y);
            sx = sx * this.block_size + this.block_size / 2;
            sy = sy * this.block_size + this.block_size / 2;
            return [sx, sy];
        }

        field.prototype.put_block = function (x, y, block_num) {
            let [bx, by] = this.conv_xy(x, y);
            this.field_array[by][bx] = block_num;
            this.draw_block(bx, by, block_num);
        }

        field.prototype.get_block = function (x, y) {
            let bx, by;
            [bx, by] = this.conv_xy(x, y);
            return this.field_array[by][bx];
        }
        field.prototype.get_spaceposition = function (block_number) {
            let p = [];
            for (let i = 3; i < this.field_array.length - 3; i++) {
                for (let j = 3; j < this.field_array[0].length - 3; j++) {
                    if (this.field_array[i][j] == block_number) {
                        p.push([j, i]);
                    }
                }
            }
            return p;
        }

        field.prototype.softblock_position = function (softblock_num) {
            let x, y;
            if (softblock_num < this.size_x * 2 - 3) {
                x = softblock_num + 2;
                y = 0;
            } else if (softblock_num < this.size_x * 2 - 3 + this.size_x - 1) {
                x = (softblock_num - (this.size_x * 2 - 3)) * 2 + 2;
                y = 1;
            } else if (softblock_num < this.softblocK_max - (this.size_x * 3 - 4)) {
                let sx = softblock_num - (this.size_x * 2 - 3 + this.size_x - 1);
                x = sx;
                let sy = 0
                while (sx > (sy % 2 == 0 ? this.size_x * 2 : this.size_x)) {
                    sy += 1;
                    if (sy % 2 == 1) {
                        sx -= this.size_x * 2 + 1;
                        x = sx * 2;
                    } else {
                        sx -= this.size_x + 1;
                        x = sx;
                    }
                }
                y = sy + 2;
            } else if (softblock_num < (this.softblocK_max - (this.size_x * 2 - 3))) {
                x = (softblock_num - (this.softblocK_max - (this.size_x * 3 - 4))) * 2 + 2;
                y = this.size_y * 2 - 1
            } else {
                x = softblock_num - (this.softblocK_max - (this.size_x * 2 + 1 - 4)) + 2
                y = this.size_y * 2

            }
            return [x + 1, y + 1]


        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　スプライト　　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        var sprite = function (field, sprite_name, sprite_kind, position_x, position_y, off_x, off_y, size, zIndex, shape_array, shape) {
            this.field = field;
            this.sprite_name = sprite_name;
            this.sprite_kind = sprite_kind;
            this.position_x = position_x;
            this.position_y = position_y;
            this.original_off_x = off_x;
            this.original_off_y = off_y;
            this.off_x = off_x;
            this.off_y = off_y;
            this.original_size = size;
            this.size = size;
            this.zIndex = zIndex;
            this.z_adjust = 0;
            this.shape = shape;
            this.shape_array = shape_array;
            this.magnitude = 1;

            let sprite_tag = '<div class="' + this.sprite_kind + '" id="sprite' + this.sprite_name + '" style="position:absolute;"></div>';
            document.getElementById(this.field.field_name).innerHTML += sprite_tag;
            document.getElementById("sprite" + this.sprite_name).style.backgroundPosition = String(this.shape_array[shape][0]) + 'px ' + String(this.shape_array[shape][1]) + 'px'
            document.getElementById("sprite" + this.sprite_name).style.width = String(this.size) + 'px'
            document.getElementById("sprite" + this.sprite_name).style.height = String(this.size) + 'px'
            document.getElementById("sprite" + this.sprite_name).style.left = String(this.position_x - this.off_x) + "px";
            document.getElementById("sprite" + this.sprite_name).style.top = String(this.position_y - this.off_y) + "px";
            document.getElementById("sprite" + this.sprite_name).style.zIndex = String(Math.floor(this.position_y / this.field.block_size) * 30 + this.zIndex);
            document.getElementById("sprite" + this.sprite_name).style.display = "block";

        }

        sprite.prototype.move_to = function (x, y) {
            this.position_x = x;
            this.position_y = y;
            document.getElementById("sprite" + this.sprite_name).style.left = String(this.position_x - this.off_x) + "px";
            document.getElementById("sprite" + this.sprite_name).style.top = String(this.position_y - this.off_y) + "px";
            document.getElementById("sprite" + this.sprite_name).style.zIndex = String(Math.floor(this.position_y / this.field.block_size) * 30 + this.zIndex + this.z_adjust);
        }
        sprite.prototype.z_index = function (z) {
            this.z_adjust = z;

        }

        sprite.prototype.rotate = function (r) {
            document.getElementById("sprite" + this.sprite_name).style.transform = "rotate(" + r + "deg)"
        }

        sprite.prototype.scale = function (magnitude) {
            this.magnitude = magnitude;
            this.size = this.original_size * this.magnitude;
            this.off_x = this.original_off_x - (this.original_size - this.size) / 2;
            this.off_y = this.original_off_y - (this.original_size - this.size) / 2;
            document.getElementById("sprite" + this.sprite_name).style.width = String(this.size) + "px";
            document.getElementById("sprite" + this.sprite_name).style.height = String(this.size) + "px";
            document.getElementById("sprite" + this.sprite_name).style.left = String(this.position_x - this.off_x) + "px";
            document.getElementById("sprite" + this.sprite_name).style.top = String(this.position_y - this.off_y) + "px";
        }

        sprite.prototype.jump = function (x, y) {
            this.off_x = this.original_off_x + x;
            this.off_y = this.original_off_y + y;
            document.getElementById("sprite" + this.sprite_name).style.left = String(this.position_x - this.off_x) + "px";
            document.getElementById("sprite" + this.sprite_name).style.top = String(this.position_y - this.off_y) + "px";
        }

        sprite.prototype.change_kind = function (shape) {
            this.shape = shape;
            document.getElementById("sprite" + this.sprite_name).style.backgroundPosition = String(this.shape_array[shape][0]) + 'px ' + String(this.shape_array[shape][1]) + 'px'
        }
        sprite.prototype.change_spritekind = function (sprite_kind, shape_array, shape) {
            this.sprite_kind = sprite_kind;
            this.shape_array = shape_array;
            document.getElementById("sprite" + this.sprite_name).className = sprite_kind;
            this.change_kind(shape);
        }
        sprite.prototype.visible = function (visible_F) {
            if (visible_F) {
                document.getElementById("sprite" + this.sprite_name).style.display = "block";
            } else {
                document.getElementById("sprite" + this.sprite_name).style.display = "none";
            }
        }

        sprite.prototype.erase = function () {
            let child = document.getElementById("sprite" + this.sprite_name);
            child.parentNode.removeChild(child);
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　爆弾生成と消去　　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        var bomb = function (field, position_x, position_y, size, player_num, burst_distance, bomb_id, display_size, ghost_F) {
            this.field = field;
            this.position_x = position_x;
            this.position_y = position_y;
            this.player_num = player_num;
            this.burst_distance = burst_distance;
            this.bomb_id = bomb_id;
            this.destroy = false;
            this.timeout_ID = [];
            this.kickedtime_ID = [];
            this.size = size;
            this.display_size = display_size;
            this.ghost_F = ghost_F;
            this.bomb_id = bomb_id;
            this.kicked_F = false;
            this.punched_F = false;
            this.burstwait_F = false;
            this.die_F = false;

            let s = -this.display_size * 2;
            let s_array = [[0, 0], [s, 0], [s * 2, 0], [s * 3, 0], [s * 4, 0], [s * 5, 0]]
            this.sprite = new sprite(this.field, "bomb" + bomb_counter, "bomb", this.position_x, this.position_y, this.display_size, this.display_size * 1.2, this.display_size * 2, 1, s_array, 0);
            let [x, y] = this.field.conv_xy(this.position_x, this.position_y)
            //this.field.field_array[y][x] = this.bomb_id + 5000;
            this.field.put_array(x, y, this.bomb_id + 5000)

            for (let i = 0; i < 5; i++) {
                this.timeout_ID.push(setTimeout(function () {
                    this.sprite.change_kind(i + 1)
                }.bind(this), 500 * (i + 1)))
            }
            this.timeout_ID.push(setTimeout(function () {
                this.die();
            }.bind(this), 3000))

        }

        bomb.prototype.die = function () {
            if (this.punched_F) {
                this.burstwait_F = true;
            } else {
                if (singlemode_F) {
                    this.burst();
                } else {
                    if (this.player_num == 0 && this.die_F == false) {
                        this.die_F = true;
                        call_emit(battle_code + my_username + "burst", [this.bomb_id, this.position_x, this.position_y]);
                        this.timeout_ID.push(setTimeout(function () { console.log("auto burst", this.bomb_id); this.burst() }.bind(this), 500));
                    }
                }
            }
        }

        bomb.prototype.burst = function () {
            while (this.timeout_ID.length > 0) {
                clearTimeout(this.timeout_ID.shift());
            }
            while (this.kickedtime_ID.length > 0) {
                clearTimeout(this.kickedtime_ID.shift());
            }
            this.field.field_array.forEach((value0, y) => {
                value0.forEach((value1, x) => {
                    if (value1 == this.bomb_id + 5000) {
                        this.field.put_array(x, y, 0);
                    }
                })
            })
            this.sprite.erase();
            this.destroy = true;
            [this.position_x, this.position_y] = this.field.std_xy(this.position_x, this.position_y);
            burst_put(this.field, this.position_x, this.position_y, 5, this.field.block_size / 2, this.burst_distance, this.player_num, this.bomb_id, this.ghost_F)
            bomb_erase();
        }

        bomb.prototype.misfire = function () {
            if (singlemode_F) {
                this.vanish();
            } else {
                if (this.player_num == 0) {
                    call_emit(battle_code + my_username + "vanish", this.bomb_id);
                }
            }
        }

        bomb.prototype.vanish = function () {
            while (this.timeout_ID.length > 0) {
                clearTimeout(this.timeout_ID.shift());
            }
            while (this.kickedtime_ID.length > 0) {
                clearTimeout(this.kickedtime_ID.shift());
            }
            this.field.field_array.forEach((value0, y) => {
                value0.forEach((value1, x) => {
                    if (value1 == this.bomb_id + 5000) {
                        this.field.put_array(x, y, 0);

                    }
                })
            })
            this.sprite.erase();
            this.destroy = true;
            bomb_erase();
        }

        bomb.prototype.kicked = function (speed_x, speed_y) {
            let offset_x = this.field.block_size / 2 * Math.sign(speed_x) + speed_x;
            let offset_y = this.field.block_size / 2 * Math.sign(speed_y) + speed_y;
            this.field.field_array.forEach((value0, y) => {
                value0.forEach((value1, x) => {
                    if (value1 == this.bomb_id + 5000) {
                        this.field.put_array(x, y, 0);
                    }
                })
            })
            let [collision_adjust_x, collision_adjust_y, c] = this.field.collision_detect2(this.position_x, this.position_y, offset_x, offset_y);
            if ((collision_adjust_x != speed_x || collision_adjust_y != speed_y) && this.player_collision(this.position_x + offset_x, this.position_y + offset_y)) {
                this.kicked_F = true;
                this.position_x += speed_x - collision_adjust_x;
                this.position_y += speed_y - collision_adjust_y;
                let block = this.field.get_block(this.position_x, this.position_y)
                if (block >= 4500 && block < 5000) {
                    this.misfire();
                    return;
                }
            } else if (c >= 10000 && c < 11000) {
                this.kicked_F = false;
                this.position_x += this.field.block_size / 2 * Math.sign(speed_x) + speed_x;
                this.position_y += this.field.block_size / 2 * Math.sign(speed_y) + speed_y;
                [this.position_x, this.position_y] = this.field.std_xy(this.position_x, this.position_y);
                this.die();
                return

            } else {
                this.kicked_F = false;
                [this.position_x, this.position_y] = this.field.std_xy(this.position_x, this.position_y);
            }
            this.sprite.move_to(this.position_x, this.position_y);
            let [x, y] = this.field.conv_xy(this.position_x, this.position_y);
            this.field.put_array(x, y, this.bomb_id + 5000)
            if (this.kicked_F) {
                this.kickedtime_ID.push(setTimeout(function () { this.kicked(speed_x, speed_y) }.bind(this), 25));
            }
        }
        bomb.prototype.player_collision = function (x, y) {
            let [x1, y1] = this.field.conv_xy(x, y)
            return player_array.every((value) => {
                let [x2, y2] = value.field.conv_xy(value.position_x, value.position_y);
                return x1 != x2 || y1 != y2;
            })
        }
        bomb.prototype.punched = function (distance_x, distance_y) {
            this.punch_counter = Math.abs(distance_x + distance_y);
            this.punched_F = true;
            this.field.field_array.forEach((value0, y) => {
                value0.forEach((value1, x) => {
                    if (value1 == this.bomb_id + 5000) {
                        if (x < 2 || x > this.field.field_size_x - 3 || y < 2 || y > this.field.field_size_y - 3) {
                            this.field.put_array(x, y, 999)
                        } else if (x > 2 && x < this.field.field_size_x - 3 && y > 2 && y < this.field.field_size_y - 3) {
                            this.field.put_array(x, y, 0);
                        } else {
                            this.field.put_array(x, y, this.field.wall_block);
                        }
                    }
                })
            })
            this.jump(distance_x, distance_y, 18, 50, 25, function () {
                let block = this.field.get_block(this.position_x, this.position_y);
                if (block >= 4500 & block < 5000) {
                    this.misfire()
                } else if (block > 0) {
                    this.after_jump(Math.sign(distance_x), Math.sign(distance_y));
                } else {
                    this.punch_end();
                }
            }.bind(this));
        }
        bomb.prototype.after_jump = function (distance_x, distance_y) {
            this.jump(distance_x, distance_y, 6, 20, 25, function () {
                let block = this.field.get_block(this.position_x, this.position_y);
                if (block > 0) {
                    this.punch_counter += 1;
                    if ((this.punch_counter > this.field.field_size_x - 5 && this.punch_counter > this.field.field_size_y - 5) || (block >= 4500 && block < 5000)) {
                        this.misfire();
                    } else {
                        this.after_jump(Math.sign(distance_x), Math.sign(distance_y));
                    }
                } else {
                    this.punch_end();
                }
            }.bind(this))
        }

        bomb.prototype.jump = function (distance_x, distance_y, n, h, t, callback) {
            this.sprite.z_index(1000);
            let tx = this.position_x;
            let ty = this.position_y;
            [this.position_x, this.position_y] = this.cal_position(this.position_x, this.position_y, distance_x * this.field.block_size, distance_y * this.field.block_size)
            for (let i = 0; i < n + 1; i++) {
                this.timeout_ID.push(setTimeout(function () {
                    let oy = -(h - h / n / n * 4 * (i - n / 2) * (i - n / 2)) + distance_y * this.field.block_size / n * i
                    let [x1, y1] = this.cal_position(tx, ty, distance_x * this.field.block_size / n * i, oy);
                    if (distance_y == 0) {
                        y1 = ty + oy
                    }
                    this.sprite.move_to(x1, y1);
                }.bind(this), i * t))
            }
            this.timeout_ID.push(setTimeout(function () {
                this.sprite.z_index(0);
                callback()
            }.bind(this), t * (n + 2)));
        }
        bomb.prototype.punch_end = function () {
            this.sprite.z_index(0);
            this.sprite.move_to(this.position_x, this.position_y);
            this.punched_F = false;
            let [x, y] = this.field.conv_xy(this.position_x, this.position_y);
            this.field.put_array(x, y, this.bomb_id + 5000)
            if (this.burstwait_F) {
                this.burstwait_F = false;
                this.die();
            }
        }

        bomb.prototype.cal_position = function (x, y, ox, oy) {
            let x1,y1;
            if (this.ghost_F) {
                x1 = (x + ox )
            } else {
                x1 = (x + ox + this.field.block_size * (this.field.field_size_x - 6)) % (this.field.block_size * (this.field.field_size_x - 4)) + this.field.block_size * 2;
            }
            y1 = (y + oy + this.field.block_size * (this.field.field_size_y - 6)) % (this.field.block_size * (this.field.field_size_y - 4)) + this.field.block_size * 2;
            return [x1, y1]
        }

        function bomb_put(field, x, y, size, player_num, burst_distance, bomb_id, display_size, ghost_F) {
            let block = field.get_block(x, y);
            if (block > 0 && block != 999) {
                return;
            }
            let bx = Math.floor(x / size + 0.5) * size;
            let by = Math.floor(y / size + 0.5) * size;
            if (bomb_array.every((value, index) => bomb_array[index].position_x != bx || bomb_array[index].position_y != by)) {
                bomb_array.push(new bomb(field, bx, by, size, player_num, burst_distance, bomb_id, display_size, ghost_F));
                bomb_counter = (bomb_counter + 1) % 100;
            }
        }

        function bomb_erase() {
            bomb_array.forEach((value, index) => {
                if (bomb_array[index].destroy) {
                    bomb_array.splice(index, 1);
                }
            })
        }

        var burst = function (field, position_x, position_y, size, display_size, burst_distance, player_num, bomb_id, ghost_F) {
            this.field = field;
            this.position_x = position_x;
            this.position_y = position_y;
            this.size = size;
            this.display_size = display_size;
            this.burst_distance = burst_distance;
            this.player_num = player_num;
            this.bomb_id = bomb_id;
            this.ghost_F = ghost_F;
            this.destroy = false;

            let ox = [0, 1, 0, -1];
            let oy = [-1, 0, 1, 0];
            this.bursts = [];
            if (this.field.get_block(this.position_x, this.position_y) < 999) {
                this.bursts = [[...this.field.conv_xy(this.position_x, this.position_y), this.field.get_block(this.position_x, this.position_y)]];
                this.field.put_array(this.bursts[0][0], this.bursts[0][1], this.bomb_id + 10000)
            }
            this.burns = [];

            for (let i = 0; i < 4; i++) {
                let count = 0;
                let [sx, sy] = this.field.conv_xy(this.position_x, this.position_y)
                let burn_F = false;
                while (count < this.burst_distance && burn_F == false) {
                    sx += ox[i];
                    sy += oy[i];
                    let block = this.field.field_array[sy][sx];
                    if (block == 0) {  // --------- 平地
                        this.bursts.push([sx, sy, block])
                        this.field.put_array(sx, sy, this.bomb_id + 10000);
                    } else if (block >= 1 && block < 999) {   //------ アイテム
                        this.burns.push([sx, sy, 0])
                        burn_F = true;
                    } else if (block >= 1000 && block < 2000) {   //------ ソフトブロック
                        this.burns.push([sx, sy, block % 100]);
                        burn_F = true;
                    } else if ((block >= 2000 && block < 3000) || block == 999) {   //------ ハードブロック
                        burn_F = true;
                    } else if (block >= 3000 && block < 4000) {   //------ 貫通ソフトブロック
                        this.bursts.push([sx, sy, block]);
                        this.field.put_array(sx, sy, this.bomb_id + 10000);
                        this.burns.push([sx, sy, block % 100])
                    } else if (block >= 4000 && block < 5000) {   //------ 貫通ハードブロック
                        this.bursts.push([sx, sy, block]);
                        this.field.put_array(sx, sy, this.bomb_id + 10000);
                    } else if (block >= 5000 && block < 6000) {
                        burn_F = true;
                        bomb_array.forEach((value) => {
                            if (value.bomb_id == block - 5000) {
                                value.die();
                            }
                        })
                    }
                    count += 1;
                }
            }
            document.getElementById(this.field.field_name).innerHTML += '<div id="burst' + this.bomb_id + '"></div>'
            for (let i = 0; i < 4; i++) {
                setTimeout(function () {
                    document.getElementById('burst' + this.bomb_id).innerHTML = this.burst_html(this.bursts, this.burns, this.field.block_size * (i * 0.25 + 0.25), this.field.block_size, i + 1);
                    this.player_collision();
                }.bind(this), (i + 1) * 50)
            }

            setTimeout(function () {
                this.player_collision();
                this.bursts.forEach(value => {
                    this.field.put_array(value[0], value[1], value[2])
                })
                this.field.field_array.forEach((value0, y) => {
                    value0.forEach((value1, x) => {
                        if (value1 == this.bomb_id + 10000) {
                            this.field.put_array(x, y, 0);
                        }
                    })
                })
                this.burns.forEach(value => {
                    this.field.put_array(value[0], value[1], value[2])
                })
                let child = document.getElementById('burst' + this.bomb_id);
                child.parentNode.removeChild(child);
                this.die();
            }.bind(this), 400)
        }
        burst.prototype.player_collision = function () {
            if (player_array[0].die_F == false) {
                this.bursts.forEach(value0 => {
                    let dx = Math.abs((value0[0] + 0.5) * this.field.block_size - player_array[0].position_x);
                    let dy = Math.abs((value0[1] + 0.5) * this.field.block_size - player_array[0].position_y);
                    if (dx < this.size + player_array[0].size && dy < this.size + player_array[0].size) {
                        player_array[0].die_F = true;
                        document.getElementById("punch_button").style.display = "none";
                        document.getElementById("punch_key").style.display = "none";
                        if (singlemode_F) {
                            player_array[0].die();
                        } else {
                            call_emit(battle_code + my_username + "end", { died: true, items: player_array[0].items, ghost_F: this.ghost_F, player: user_names[this.player_num], position: [player_array[this.player_num].position_x, player_array[this.player_num].position_y] })
                        }
                    }

                })
            }
        }

        burst.prototype.burst_html = function (bursts, burns, size, original_size, num) {
            let burst_tag = '';
            for (let i = 0; i < burns.length; i++) {
                burst_tag += '<div class="burn" style="position:absolute;width:' + original_size + 'px;height:' + original_size + 'px;left:' + burns[i][0] * original_size + 'px;top:' + (burns[i][1] - 0.125) * original_size + 'px;background-position:-' + num * original_size + 'px;z-index:' + String(burns[i][1] * 30 + 41) + '"></div>';
            }
            for (let i = 0; i < bursts.length; i++) {
                burst_tag += '<div class="burst" style="position:absolute;width:' + size + 'px;height:' + size + 'px;left:' + ((original_size - size) / 2 + bursts[i][0] * original_size) + 'px;top:' + ((original_size - size) / 2 + bursts[i][1] * original_size) + 'px;z-index:' + String(bursts[i][1] * 30 + 11) + '"></div>';
            }
            return burst_tag;
        }

        burst.prototype.die = function () {
            this.destroy = true;
            burst_erase();
        }

        function burst_put(field, x, y, size, display_size, burst_distance, player_num, bomb_id, ghost_F) {
            burst_array.push(new burst(field, x, y, size, display_size, burst_distance, player_num, bomb_id, ghost_F));
            //burst_counter = (burst_counter + 1) % 100;
        }

        function burst_erase() {
            burst_array.forEach((value, index) => {
                if (burst_array[index].destroy) {
                    burst_array.splice(index, 1);
                }
            })
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　燃え尽きるブロック生成と消去　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        var burn = function (field, position_x, position_y, size) {
            this.field = field;
            this.position_x = position_x;
            this.position_y = position_y;
            this.destroy = false;
            this.timeout_ID = [];
            this.size = size

            let s = -size * 2;
            let s_array = [[0, 0], [s, 0], [s * 2, 0], [s * 3, 0], [s * 4, 0], [s * 5, 0]]
            this.sprite = new sprite(this.field, "burn" + burn_counter, "burn", this.position_x, this.position_y, this.size, this.size, this.size * 2, 11, s_array, 0);

            for (let i = 0; i < 5; i++) {
                this.timeout_ID.push(setTimeout(function () {
                    this.sprite.change_kind(i + 1);
                }.bind(this), 50 * (i + 1)))
            }
            this.timeout_ID.push(setTimeout(function () {
                this.die();
            }.bind(this), 300))
        }

        burn.prototype.die = function () {
            this.field.put_block(this.position_x, this.position_y, this.field.get_block(this.position_x, this.position_y) % 1000);
            while (this.timeout_ID.length > 0) {
                clearTimeout(this.timeout_ID.shift());
            }
            this.sprite.erase();
            this.destroy = true;
            burn_erase();
        }

        function burn_put(field, x, y, size) {
            let bx = Math.floor(x / size + 0.5) * size;
            let by = Math.floor(y / size + 0.5) * size;
            if (burn_array.every((value, index) => burn_array[index].position_x != bx || burn_array[index].position_y != by)) {
                burn_array.push(new burn(field, bx, by, size));
                burn_counter = (burn_counter + 1) % 100;
            }
        }

        function burn_erase() {
            burn_array.forEach((value, index) => {
                if (burn_array[index].destroy) {
                    burn_array.splice(index, 1);
                }
            })
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　Player オブジェクト　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        var player = function (options) {
            this.field = options.field;
            this.player_num = options.player_number;
            this.sprite_kind = options.sprite_kind;
            this.off_x = options.offset_x;
            this.off_y = options.offset_y;
            this.size = options.size;
            this.block_size = this.field.block_size;
            this.display_size = options.display_size;
            this.initial_status = options.initial_status;
            this.ghost_status = options.ghost_status;
            this.ghost_F = false;

            [this.position_x, this.position_y] = [this.initial_x, this.initial_y] = this.field.std_xy(options.position_x * this.block_size, options.position_y * this.block_size);
            [this.ghost_x, this.ghost_y] = this.field.std_xy(options.ghost_x * this.block_size, options.ghost_y * this.block_size);

            this.die_F = false;

            this.items = [];
            this.move_speed = this.initial_status.move_speed;
            this.bomb_max = this.initial_status.bomb_max;
            this.burst_distance = this.initial_status.burst_distance;
            this.kick_F = this.initial_status.kick_F;
            this.punch_F = this.initial_status.punch_F;
            this.powerglove_F = this.initial_status.powerglove_F;
            this.powerglove_power = this.initial_status.powerglove_power;

            this.item_display();

            this.bombholding_F = false;

            this.sp_num = [[9, 9, 10, 10, 11, 11, 10, 10], [6, 6, 7, 7, 8, 8, 7, 7], [0, 0, 1, 1, 2, 2, 1, 1], [3, 3, 4, 4, 5, 5, 4, 4]];
            this.sp_angle = 2;

            let s = -this.display_size * 2;
            let s_array = [[0, 0], [s, 0], [s * 2, 0], [0, s], [s, s], [s * 2, s], [0, s * 2], [s, s * 2], [s * 2, s * 2], [0, s * 3], [s, s * 3], [s * 2, s * 3]];
            this.s_array = s_array;
            this.sprite = new sprite(this.field, this.player_num, this.sprite_kind, this.position_x, this.position_y, this.off_x, this.off_y, this.display_size * 2, 5, s_array, 1);
            this.bomb_sprite = new sprite(this.field, "playerbomb" + this.player_num, "bomb", this.position_x, this.position_y, this.off_x * 0.45, this.off_y * 0.40, this.field.block_size, 6, [0, 0], 0);
            this.bomb_sprite.visible(false);
            document.getElementById(this.field.field_name).innerHTML += '<div id="playername' + this.player_num + '" class="playername"></div>'
            document.getElementById("playername0").style.color = "red";
            document.getElementById("playername" + this.player_num).innerHTML = user_names[this.player_num].substr(0, 3);
            document.getElementById("playername" + this.player_num).style.left = String(this.position_x - this.display_size / 2) + "px";
            document.getElementById("playername" + this.player_num).style.top = String(this.position_y - this.display_size * 1.7) + "px";
            document.getElementById("playername" + this.player_num).style.display = "block";
            document.getElementById("playername" + this.player_num).style.zIndex = String(Math.floor(this.position_y / this.field.block_size) * 30);
        }

        player.prototype.move = function (offset_x, offset_y) {
            this.offset_x = offset_x;
            this.offset_y = offset_y;
            let tx = this.position_x;
            let ty = this.position_y;
            let [collision_adjust_x, collision_adjust_y, c_block] = this.field.collision_detect(tx, ty, this.block_size / 2 * Math.sign(offset_x) + offset_x, this.block_size / 2 * Math.sign(offset_y) + offset_y)
            let sx = tx % this.block_size - this.block_size / 2;
            let sy = ty % this.block_size - this.block_size / 2;
            let upper, lower, left, right

            if (Math.abs(collision_adjust_x - offset_x) < 0.1 && Math.abs(collision_adjust_y - offset_y) < 0.1 && c_block >= 5000 && this.kick_F) {   // ------キック判定
                this.kick(Math.sign(offset_x) * 4, Math.sign(offset_y) * 4, c_block - 5000);
            }
            if (offset_x != 0) {  //------ 横向きに衝突したときの補正
                upper = this.field.get_block(tx + this.block_size / 2 * Math.sign(offset_x) + offset_x, ty - this.size) < 1000; //--Player上端壁側
                lower = this.field.get_block(tx + this.block_size / 2 * Math.sign(offset_x) + offset_x, ty + this.size) < 1000;; //--Player下端壁側

                if (upper == true && lower == false && this.field.get_block(tx, ty - this.block_size / 2) < 1000) { //--Player上側が空いているとき
                    collision_adjust_y = Math.abs(offset_x);
                    collision_adjust_x = offset_x;
                } else if (upper == false && lower == true && this.field.get_block(tx, ty + this.block_size / 2) < 1000) { //--Player下側が空いているとき
                    collision_adjust_y = -Math.abs(offset_x);
                    collision_adjust_x = offset_x;
                } else if (upper == true && lower == true) {
                    if (Math.abs(sy) > Math.abs(offset_x)) {  //--Player上下が空いているときは通路の真ん中を通るように補正
                        collision_adjust_y = Math.abs(offset_x) * Math.sign(sy);
                        collision_adjust_x = offset_x;
                    } else if (Math.abs(sy) > 0) {
                        collision_adjust_y = sy;
                        collision_adjust_x = offset_x;
                    }
                }
            } else if (offset_y != 0) {  //------ 縦向きに衝突したときの補正
                left = this.field.get_block(tx - this.size, ty + this.block_size / 2 * Math.sign(offset_y) + offset_y) < 1000; //--Player上端壁側
                right = this.field.get_block(tx + this.size, ty + this.block_size / 2 * Math.sign(offset_y) + offset_y) < 1000;; //--Player下端壁側

                if (left == true && right == false && this.field.get_block(tx - this.block_size / 2, ty) < 1000) { //--Player左側が空いているとき
                    collision_adjust_x = Math.abs(offset_y);
                    collision_adjust_y = offset_y;
                } else if (left == false && right == true && this.field.get_block(tx + this.block_size / 2, ty) < 1000) { //--Player右側が空いているとき
                    collision_adjust_x = -Math.abs(offset_y);
                    collision_adjust_y = offset_y;
                } else if (right == true && left == true) {
                    if (Math.abs(sx) > Math.abs(offset_y)) {  //--Player左右が空いているときは通路の真ん中を通るように補正
                        collision_adjust_x = Math.abs(offset_y) * Math.sign(sx);
                        collision_adjust_y = offset_y;
                    } else if (Math.abs(sx) > 0) {
                        collision_adjust_x = sx;
                        collision_adjust_y = offset_y;
                    }
                }
            }
            tx = tx + offset_x - collision_adjust_x;
            ty = ty + offset_y - collision_adjust_y;
            this.sprite.move_to(tx, ty);

            let az, ax;
            if (this.ghost_F) {
                this.sp_angle = (ty < this.block_size * 2 ? 2 : (tx < this.block_size * 2 ? 1 : (ty > (this.field.field_size_y - 2) * this.block_size ? 0 : 3)));
                [az, ax] = [[49, 0.45], [51, -0.1], [51, 0.45], [51, 1]][this.sp_angle];
            } else {
                this.sp_angle = (offset_y <= 0 ? 0 : 2) + (offset_x > 0 ? 1 : (offset_x == 0 ? 0 : 3));
                [az, ax] = [[-2, 0.45], [0, 0.2], [0, 0.45], [0, 0.7]][this.sp_angle];
            }
            this.bomb_sprite.z_index(az);
            this.bomb_sprite.off_x = this.off_x * ax;
            this.bomb_sprite.move_to(tx, ty);

            this.position_x = tx;
            this.position_y = ty;
            document.getElementById("playername" + this.player_num).style.left = String(this.position_x - this.display_size / 2) + "px";
            document.getElementById("playername" + this.player_num).style.top = String(this.position_y - this.display_size * 1.7) + "px";
            document.getElementById("playername" + this.player_num).style.zIndex = String(Math.floor(this.position_y / this.field.block_size) * 30);
            this.sprite.change_kind(this.sp_num[this.sp_angle][Math.floor(key_counter[this.player_num] % 8)]);

            let block = this.field.get_block(tx, ty);
            if (block > 0 && block < 100) {
                this.field.put_block(tx, ty, 0);
                this.item_action(block);
                call_emit(battle_code + my_username + "item", [tx, ty]);
            }
        }

        player.prototype.kick = function (speed_x, speed_y, bomb_id) {
            bomb_array.forEach((value) => {
                if (value.bomb_id == bomb_id && value.kicked_F == false && value.punched_F == false) {
                    value.kicked_F = true;
                    value.kicked(speed_x, speed_y);
                    call_emit(battle_code + my_username + "kick", [value.bomb_id, speed_x, speed_y])
                }
            })
        }

        player.prototype.punch = function (distance_x, distance_y, bomb_id) {
            bomb_array.forEach((value) => {
                if (value.bomb_id == bomb_id && value.punched_F == false && value.kicked_F == false) {
                    value.punched(distance_x, distance_y);
                    call_emit(battle_code + my_username + "punch", [value.bomb_id, distance_x, distance_y])
                }
            })
        }

        player.prototype.powerglove = function () {
            if (this.powerglove_F == false) {
                return
            }
            let block = this.field.get_block(this.position_x, this.position_y);
            if (block >= 5000 && block < 6000) {
                bomb_array.forEach(value => {
                    if (value.bomb_id == block - 5000) {
                        this.bombholding_F = true;
                        while (value.timeout_ID.length > 0) {
                            clearTimeout(value.timeout_ID.shift());
                        }
                        value.field.field_array.forEach((value0, y) => {
                            value0.forEach((value1, x) => {
                                if (value1 == value.bomb_id + 5000) {
                                    this.field.put_array(x, y, 0)
                                }
                            })
                        })
                        value.sprite.erase();
                        value.destroy = true;
                        bomb_erase();
                        this.bomb_sprite.visible(true);
                        call_emit(battle_code + my_username + "powerglove", value.bomb_id)
                    }
                })
            }
        }

        player.prototype.powerglove_end = function (power, ghost_F) {
            let [x, y, size] = [this.position_x, this.position_y, this.block_size];
            let [x_size, y_size] = [(this.field.field_size_x - 3), (this.field.field_size_y - 3)];
            if ((x > size * 3 && x < size * x_size) || (y > size * 3 && y < size * y_size)) {
                this.bombholding_F = false;
                let bomb_id = user_order.indexOf(my_username) * 100 + bomb_counter;
                let [ox, oy] = [[0, -1], [1, 0], [0, 1], [-1, 0]][this.sp_angle];
                let [x, y] = this.field.std_xy(this.position_x, this.position_y);
                bomb_put(this.field, x, y, this.block_size / 4, this.player_num, this.burst_distance, bomb_id, this.block_size / 2, ghost_F);
                bomb_array.forEach((value) => {
                    if (value.bomb_id == bomb_id) {
                        value.punched(ox * power, oy * power);
                    }
                })
                this.bomb_sprite.visible(false);
                call_emit(battle_code + my_username + "powerglove_end", [x, y, bomb_id, this.sp_angle, power, ghost_F])
            }
        }

        player.prototype.die = function (x, y) {
            let blank = shuffle_array(this.field.get_spaceposition(0));
            let b = (blank == undefined ? 0 : blank.length);
            let l = (this.items == undefined ? 0 : this.items.length)
            for (let i = 0; i < Math.min(b, l); i++) {
                //this.field.field_array[blank[i][1]][blank[i][0]] = this.items[i];
                this.field.put_array(blank[i][0], blank[i][1], this.items[i])
                //this.field.draw_block(blank[i][0], blank[i][1], this.items[i]);
            }

            this.items = [];
            this.move_speed = this.initial_status.move_speed;
            this.bomb_max = this.initial_status.bomb_max;
            this.burst_distance = this.initial_status.burst_distance;
            this.kick_F = this.initial_status.kick_F;
            this.punch_F = this.initial_status.punch_F;
            this.powerglove_F = this.initial_status.powerglove_F;
            this.bomb_sprite.visible(false);

            this.item_display();

            this.sprite.change_kind(0);
            for (let i = 0; i < 5; i++) {
                setTimeout(function () {
                    this.sprite.jump(0, (i + 1) * 8);
                }.bind(this), i * 25)
            }
            for (let i = 0; i < 5; i++) {
                setTimeout(function () {
                    this.sprite.jump(0, (40 - (i + 1) * 8));
                }.bind(this), 125 + i * 25)
            }
            setTimeout(function () {
                this.sprite.rotate(90);
                this.sprite.jump(-15, -8);
            }.bind(this), 275)
            setTimeout(function () {
                if (singlemode_F) {
                    this.die_F = false;
                    this.sprite.rotate(0);
                    this.sprite.jump(0, 0);
                    let position_num = user_order.indexOf(user_names[this.player_num])
                    this.position_x = this.initial_x;
                    this.position_y = this.initial_y;
                    this.sprite.move_to(this.position_x, this.position_y)
                    document.getElementById("playername" + this.player_num).style.left = String(this.position_x - this.display_size / 2) + "px";
                    document.getElementById("playername" + this.player_num).style.top = String(this.position_y - this.display_size * 1.7) + "px";
                    if (this.punch_F) {
                        document.getElementById("punch_button").style.display = "block";
                        document.getElementById("punch_key").style.display = "block";
                    }
                } else {
                    this.ghost(x, y)
                }
            }.bind(this), 2000)
        }
        player.prototype.ghost = function (x, y) {
            this.die_F = false;
            this.ghost_F = true;
            this.move_speed = this.ghost_status.move_speed;
            this.bomb_max = this.ghost_status.bomb_max;
            this.burst_distance = this.ghost_status.burst_distance;
            this.kick_F = false;
            this.punch_F = false;
            this.powerglove_F = true;
            this.powerglove_power = this.ghost_status.powerglove_power;

            this.item_display();

            this.bomb_sprite.visible(false);

            this.position_x = x;
            this.position_y = y;
            this.sprite.rotate(0);
            this.sprite.jump(0, 0);
            this.sp_angle = (y < this.block_size * 2 ? 2 : (x < this.block_size * 2 ? 1 : (y > (this.field.field_size_y - 2) * this.block_size ? 0 : 3)));
            this.sprite.change_spritekind("ghost" + user_order.indexOf(user_names[this.player_num]), this.s_array, this.sp_num[this.sp_angle][0]);
            this.sprite.z_index(51);
            this.sprite.move_to(this.position_x, this.position_y);
            let [az, ax] = [[49, 0.45], [51, -0.1], [51, 0.45], [51, 1]][this.sp_angle];
            this.bomb_sprite.z_index(az);
            this.bomb_sprite.off_x = this.off_x * ax;
            this.bomb_sprite.move_to(this.position_x, this.position_y);
            document.getElementById("playername" + this.player_num).style.left = String(this.position_x - this.display_size / 2) + "px";
            document.getElementById("playername" + this.player_num).style.top = String(this.position_y - this.display_size * 1.7) + "px";
        }

        player.prototype.revive = function (x, y) {
            this.items = [];
            this.move_speed = this.initial_status.move_speed;
            this.bomb_max = this.initial_status.bomb_max;
            this.burst_distance = this.initial_status.burst_distance;
            this.kick_F = this.initial_status.kick_F;
            this.punch_F = this.initial_status.punch_F;
            this.powerglove_F = this.initial_status.powerglove_F;
            this.powerglove_power = this.initial_status.powerglove_power;
            this.bomb_sprite.visible(false);

            this.item_display();

            setTimeout(function () {
                this.ghost_F = false;
                this.position_x = x;
                this.position_y = y;
                this.sprite.change_spritekind(this.sprite_kind, this.s_array, this.sp_num[2][0])
                this.sprite.move_to(this.position_x, this.position_y)
                this.sprite.z_index(0);
                document.getElementById("playername" + this.player_num).style.left = String(this.position_x - this.display_size / 2) + "px";
                document.getElementById("playername" + this.player_num).style.top = String(this.position_y - this.display_size * 1.7) + "px";
                document.getElementById("playername" + this.player_num).style.zIndex = String(Math.floor(this.position_y / this.field.block_size) * 30);
            }.bind(this), 2000);
        }

        player.prototype.item_action = function (block) {
            this.items.push(block)
            switch (block) {
                case 1:
                    this.burst_distance += 1;
                    break;
                case 2:
                    this.bomb_max += 1;
                    break
                case 3:
                    this.move_speed += 1;
                    break;
                case 4:
                    this.kick_F = true;
                    break;
                case 5:
                    this.punch_F = true;
                    document.getElementById("punch_button").style.display = "block";
                    document.getElementById("punch_key").style.display = "block";
                    break;
                case 6:
                    this.powerglove_F = true;
                    break;
            }
            this.item_display ();
        }
        player.prototype.item_display = function () {
            document.getElementById("icon_layer").style.display = "block";
            document.getElementById("bomb_num").innerHTML = String(this.bomb_max);
            document.getElementById("fire_num").innerHTML = String(this.burst_distance);
            document.getElementById("speed_num").innerHTML = String(this.move_speed-this.initial_status.move_speed);
            if (this.kick_F) {
                document.getElementById("kick_icon").style.display ="block";
            } else {
                document.getElementById("kick_icon").style.display ="none";
            }
            if (this.punch_F) {
                document.getElementById("punch_icon").style.display ="block";
            } else {
                document.getElementById("punch_icon").style.display ="none";
            }
            if (this.powerglove_F) {
                document.getElementById("powerglove_icon").style.display ="block";
            } else {
                document.getElementById("powerglove_icon").style.display ="none";
            }
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　スプライト衝突判定　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        function sprite_collision_detect(obj1, obj2) {
            if (Math.abs(obj1.position_x - obj2.position_x) < obj1.size + obj2.size && Math.abs(obj1.position_y - obj2.position_y) < obj1.size + obj2.size) {
                return true;
            } else {
                return false;
            }

        }


        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　変数初期化　　　　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        var player_array = [];
        var bomb_array = [];
        var bomb_counter = 0;
        var burst_array = [];
        var burst_counter = 0;
        var burn_array = [];
        var burn_counter = 0;
        var key_input = [];
        var key_counter = [];
        var interval = 50;

        var game_name = "bomber"
        var users = {};
        var user_names = [];
        var user_order = [];
        var user_num = 4;
        var joining_F = false;
        var gamestart_F = false;
        var gameend_F = false;
        var singlemode_F = false;

        var spacetime = 1000;
        var spacetime_ID = [];
        var punchbutton_adjust_y = 0;

        var Field;
        var stage_order = [];

        var field_data = []
        field_data[0] = {
            title: "いつものステージ",
            field_array: [[2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004],
            [2004, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2004],
            [2004, 999, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 999, 2004],
            [2004, 999, 2004, 100, 100, 0, 0, 0, 0, 0, 0, 0, 100, 100, 2004, 999, 2004],
            [2004, 999, 2004, 100, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 100, 2004, 999, 2004],
            [2004, 999, 2004, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 999, 2004],
            [2004, 999, 2004, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2004, 999, 2004],
            [2004, 999, 2004, 100, 2004, 0, 2004, 0, 2004, 0, 2004, 0, 2004, 100, 2004, 999, 2004],
            [2004, 999, 2004, 100, 100, 0, 0, 0, 0, 0, 0, 0, 100, 100, 2004, 999, 2004],
            [2004, 999, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 999, 2004],
            [2004, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2004],
            [2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004]],
            ground_block: "field3",
            background_block: "field3",
            wall_block: 2004,
            block_size: 27,
            display_size: 54,
            softblock: 1100,
            softblock_rate: 0.4,
            items: [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6],
            initial_status: { move_speed: 4, bomb_max: 1, burst_distance: 1, kick_F: false, punch_F: false, powerglove_F: false, powerglove_power: 5 },
            ghost_status: { move_speed: 6, bomb_max: 1, burst_distance: 2, powerglove_F: false, powerglove_power: 4 },
            initial_position: [[3, 3], [13, 15], [13, 3], [3, 15]],
            ghost_position: [[1, 1], [15, 17], [15, 1], [1, 17]]
        }

        field_data[1] = {
            title: "お花畑(とおりぬけ)",
            field_array: [[2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001],
            [2001, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2001],
            [2001, 999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 999, 2001],
            [2001, 999, 2001, 100, 100, 0, 0, 0, 0, 0, 0, 0, 100, 100, 2001, 999, 2001],
            [2001, 999, 2001, 100, 2000, 1000, 2000, 1000, 2000, 1000, 2000, 1000, 2000, 100, 2001, 999, 2001],
            [2001, 999, 2001, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 1000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 2000, 0, 2002, 0, 4000, 0, 2002, 0, 2000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 1000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 2000, 0, 4000, 0, 4000, 0, 4000, 0, 2000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 1000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 2000, 0, 4000, 0, 4000, 0, 4000, 0, 2000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 1000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 2000, 0, 2002, 0, 4000, 0, 2002, 0, 2000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 1000, 0, 2001, 999, 2001],
            [2001, 999, 2001, 100, 2000, 1000, 2000, 1000, 2000, 1000, 2000, 1000, 2000, 100, 2001, 999, 2001],
            [2001, 999, 2001, 100, 100, 0, 0, 0, 0, 0, 0, 0, 100, 100, 2001, 999, 2001],
            [2001, 999, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 999, 2001],
            [2001, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2001],
            [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]],
            ground_block: "field1",
            background_block: "field1",
            wall_block: 2001,
            block_size: 27,
            display_size: 54,
            softblock: 3000,
            softblock_rate: 0.6,
            items: [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6],
            initial_status: { move_speed: 4, bomb_max: 1, burst_distance: 2, kick_F: false, punch_F: false, powerglove_F: false, powerglove_power: 5 },
            ghost_status: { move_speed: 6, bomb_max: 1, burst_distance: 2, powerglove_F: false, powerglove_power: 4 },
            initial_position: [[3, 3], [13, 15], [13, 3], [3, 15]],
            ghost_position: [[1, 1], [15, 17], [15, 1], [1, 17]]
        }
        field_data[2] = {
            title: "ギンギンパワー",
            field_array: [[2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003],
            [2003, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2003],
            [2003, 999, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 999, 2003],
            [2003, 999, 2003, 100, 100, 0, 0, 0, 0, 0, 0, 0, 100, 100, 2003, 999, 2003],
            [2003, 999, 2003, 100, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 100, 2003, 999, 2003],
            [2003, 999, 2003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 999, 2003],
            [2003, 999, 2003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2003, 999, 2003],
            [2003, 999, 2003, 100, 2003, 0, 2003, 0, 2003, 0, 2003, 0, 2003, 100, 2003, 999, 2003],
            [2003, 999, 2003, 100, 100, 0, 0, 0, 0, 0, 0, 0, 100, 100, 2003, 999, 2003],
            [2003, 999, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 999, 2003],
            [2003, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2003],
            [2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003, 2003]],
            ground_block: "field2",
            background_block: "field2",
            wall_block: 2003,
            block_size: 27,
            display_size: 54,
            softblock: 0,
            softblock_rate: 0,
            items: [],
            initial_status: { move_speed: 6, bomb_max: 6, burst_distance: 8, kick_F: true, punch_F: true, powerglove_F: true, powerglove_power: 5 },
            ghost_status: { move_speed: 6, bomb_max: 1, burst_distance: 2, powerglove_F: false, powerglove_power: 4 },
            initial_position: [[3, 3], [13, 15], [13, 3], [3, 15]],
            ghost_position: [[1, 1], [15, 17], [15, 1], [1, 17]]
        }
        field_data[3] = {
            title: "かくれんぼ",
            field_array: [[2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006],
            [2006, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2006],
            [2006, 999, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 999, 2006],
            [2006, 999, 2006, 100, 100, 0, 0, 0, 6003, 6005, 6002, 0, 0, 100, 2006, 999, 2006],
            [2006, 999, 2006, 100, 2005, 0, 2005, 0, 2005, 6001, 2005, 0, 2005, 100, 2006, 999, 2006],
            [2006, 999, 2006, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 2006, 999, 2006],
            [2006, 999, 2006, 6000, 2005, 0, 2005, 0, 2005, 0, 2005, 0, 2005, 0, 2006, 999, 2006],
            [2006, 999, 2006, 6004, 6002, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2006, 999, 2006],
            [2006, 999, 2006, 6001, 2005, 0, 2005, 6000, 2005, 6000, 2005, 0, 2005, 0, 2006, 999, 2006],
            [2006, 999, 2006, 0, 0, 0, 6003, 6005, 6005, 6005, 6002, 0, 0, 0, 2006, 999, 2006],
            [2006, 999, 2006, 0, 2005, 0, 2005, 6001, 2005, 6001, 2005, 0, 2005, 6000, 2006, 999, 2006],
            [2006, 999, 2006, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6003, 6004, 2006, 999, 2006],
            [2006, 999, 2006, 0, 2005, 0, 2005, 0, 2005, 0, 2005, 0, 2005, 6001, 2006, 999, 2006],
            [2006, 999, 2006, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2006, 999, 2006],
            [2006, 999, 2006, 100, 2005, 0, 2005, 6000, 2005, 0, 2005, 0, 2005, 100, 2006, 999, 2006],
            [2006, 999, 2006, 100, 100, 0, 6003, 6005, 6002, 0, 0, 0, 100, 100, 2006, 999, 2006],
            [2006, 999, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 999, 2006],
            [2006, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2006],
            [2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006]],
            ground_block: "field1",
            background_block: "field1",
            wall_block: 2006,
            block_size: 27,
            display_size: 54,
            softblock: 1200,
            softblock_rate: 0.4,
            items: [4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3,],
            initial_status: { move_speed: 4, bomb_max: 1, burst_distance: 2, kick_F: false, punch_F: false, powerglove_F: false, powerglove_power: 5 },
            ghost_status: { move_speed: 6, bomb_max: 1, burst_distance: 2, powerglove_F: false, powerglove_power: 4 },
            initial_position: [[3, 3], [13, 15], [13, 3], [3, 15]],
            ghost_position: [[1, 1], [15, 17], [15, 1], [1, 17]]
        }
        field_data[4] = {
            title: "がけっぷち",
            field_array: [[2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001],
            [2001, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2001],
            [2001, 999, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 999, 2001],
            [2001, 999, 4501, 100, 100, 0, 0, 0, 4501, 0, 0, 0, 100, 100, 4501, 999, 2001],
            [2001, 999, 4501, 100, 0, 0, 0, 0, 4501, 0, 0, 0, 0, 100, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 4500, 4500, 4500, 4501, 4500, 4500, 4500, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 4501, 0, 0, 0, 0, 0, 4501, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 101, 0, 4000, 0, 4000, 0, 101, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 4501, 0, 0, 0, 0, 0, 4501, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 4500, 4500, 4501, 0, 0, 4000, 0, 0, 4501, 4500, 4500, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 4501, 0, 0, 0, 0, 0, 4501, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 101, 0, 4000, 0, 4000, 0, 101, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 4501, 0, 0, 0, 0, 0, 4501, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 0, 0, 4501, 4500, 4500, 4500, 4500, 4500, 4501, 0, 0, 4501, 999, 2001],
            [2001, 999, 4501, 100, 0, 0, 0, 0, 4501, 0, 0, 0, 0, 100, 4501, 999, 2001],
            [2001, 999, 4501, 100, 100, 0, 0, 0, 4501, 0, 0, 0, 100, 100, 4501, 999, 2001],
            [2001, 999, 4501, 4500, 4500, 4500, 4500, 4500, 4501, 4500, 4500, 4500, 4500, 4500, 4501, 999, 2001],
            [2001, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2001],
            [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]],
            ground_block: "field1",
            background_block: "field1",
            wall_block: 4501,
            block_size: 27,
            display_size: 54,
            softblock: 3000,
            softblock_rate: 0.8,
            items: [1, 1, 1, 1, 1, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 3, 3, 3, 3, 3],
            initial_status: { move_speed: 4, bomb_max: 1, burst_distance: 1, kick_F: false, punch_F: false, powerglove_F: false, powerglove_power: 5 },
            ghost_status: { move_speed: 6, bomb_max: 1, burst_distance: 2, powerglove_F: false, powerglove_power: 5 },
            initial_position: [[3, 3], [13, 15], [13, 3], [3, 15]],
            ghost_position: [[1, 1], [15, 17], [15, 1], [1, 17]]
        }
        field_data[5] = {
            title: "ばくだんほうりなげ",
            field_array: [[2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007],
            [2007, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2007],
            [2007, 999, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 999, 2007],
            [2007, 999, 2007, 100, 100, 2007, 0, 0, 0, 0, 0, 0, 100, 100, 2007, 999, 2007],
            [2007, 999, 2007, 100, 0, 2007, 0, 0, 0, 0, 0, 0, 0, 100, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 2007, 0, 0, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 2007, 0, 0, 2007, 0, 0, 0, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 2007, 0, 0, 2007, 0, 0, 0, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 2007, 0, 0, 2007, 2007, 2007, 2007, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 2007, 0, 0, 2007, 0, 0, 2007, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 2007, 2007, 2007, 2007, 0, 0, 2007, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 0, 0, 0, 2007, 0, 0, 2007, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 0, 0, 0, 0, 0, 2007, 0, 0, 2007, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 0, 0, 2007, 0, 0, 2007, 999, 2007],
            [2007, 999, 2007, 100, 0, 0, 0, 0, 0, 0, 0, 2007, 0, 100, 2007, 999, 2007],
            [2007, 999, 2007, 100, 100, 0, 0, 0, 0, 0, 0, 2007, 100, 100, 2007, 999, 2007],
            [2007, 999, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 999, 2007],
            [2007, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2007],
            [2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007]],
            ground_block: "field5",
            background_block: "field5",
            wall_block: 2007,
            block_size: 27,
            display_size: 54,
            softblock: 1300,
            softblock_rate: 0.5,
            items: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
            initial_status: { move_speed: 3, bomb_max: 3, burst_distance: 3, kick_F: true, punch_F: true, powerglove_F: true, powerglove_power: 5 },
            ghost_status: { move_speed: 6, bomb_max: 1, burst_distance: 2, powerglove_F: false, powerglove_power: 4 },
            initial_position: [[3, 3], [13, 15], [13, 3], [3, 15]],
            ghost_position: [[1, 1], [15, 17], [15, 1], [1, 17]]
        }

        // 1: 爆風, 2: ボム, 3: スピードアップ, 4: キック, 5: パンチ, 6: パワーグローブ


        var battle_code = localStorage.getItem(game_name + "battle_code");
        if (battle_code == null) {
            battle_code = ("00000" + Math.floor(Math.random() * 1000)).slice(-5)
        }
        insert_chara("battle_code", battle_code)

        var user_name = localStorage.getItem(game_name + "user_name");
        if (user_name == null) {
            user_name = "AAA"
        }
        insert_chara("user_name", user_name)

        var controller_display = localStorage.getItem(game_name + "controllerdisplay");
        if (controller_display == null) {
            controller_display = "block";
        }
        if (controller_display == "none") {
            controller_nondisplay();
        }
        document.getElementById("fade_layer").style.display = "block";
        document.getElementById("title").style.display = "block";

        function stage_select() {
            if (Object.keys(users).some(value => users[my_username].users != users[value].users)) {
                return
            } else {
                joining_F = false;
                document.getElementById("join_dialog").style.display = "none";
            }
            for (let i = 0; i < field_data.length; i++) {
                let stage_data = JSON.parse(JSON.stringify(field_data[i]));
                stage_data.display_size = 15;
                stage_data.block_size = 7.5;
                stage_data.background_block = "field0"
                Stages = new field("stage_roll", "select_field" + i, (i + 1) * 150 + 25, 25, stage_data);
                Stages.refresh_field();
                document.getElementById("select_field" + i).innerHTML += '<div style="position:absolute;top:145px;font-size:10px;">' + stage_data.title + '</div>';
            }
            document.getElementById("stage_roll").innerHTML += '<div style="position:absolute;width:100px;height:1px;left:' + (field_data.length + 1) * 150 + 'px;"></div>'
            document.getElementById("stageselect_dialog").style.display = "block"
            stage_roll.display(150, field_data.length, function (input) {
                let seed = 0;
                for (i in users) {
                    seed += parseInt(i.slice(3))
                }
                initialize_random();
                Math.random.seed(seed);
                user_names = Object.keys(users)
                user_order = user_names.slice().sort((a, b) => parseInt(a.slice(3)) - parseInt(b.slice(3)));
                if (user_names.length == 1) {
                    singlemode_F = true;
                } else {
                    initialize_snapshot();
                }
                start(input)
            })
        }

        function start(stage_num) {
            if (singlemode_F) {
                gamestart_F = true;
                game_start(stage_num);
            } else {
                document.getElementById("wait_dialog").style.display = "block";
                call_emit(battle_code + my_username + "start", { stage: stage_num });
            }

        }

        function game_start(stage_num) {
            document.getElementById("wait_dialog").style.display = "none";
            document.getElementById("fade_layer").style.display = "none";
            //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
            //～～～～～～～～～　　　　インスタンス生成　　　～～～～～～～～～
            //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
            Field = new field("field_layer", "main_field", 0, 0, field_data[stage_num])
            Field.refresh_field();

            for (let i = 0; i < user_names.length; i++) {
                let options = {
                    field: Field,
                    player_number: i,
                    sprite_kind: "player" + user_order.indexOf(user_names[i]),
                    position_x: field_data[stage_num].initial_position[user_order.indexOf(user_names[i])][0],
                    position_y: field_data[stage_num].initial_position[user_order.indexOf(user_names[i])][1],
                    ghost_x: field_data[stage_num].ghost_position[user_order.indexOf(user_names[i])][0],
                    ghost_y: field_data[stage_num].ghost_position[user_order.indexOf(user_names[i])][1],
                    offset_x: field_data[stage_num].block_size,
                    offset_y: field_data[stage_num].block_size * 1.5,
                    size: field_data[stage_num].block_size * 0.3,
                    display_size: field_data[stage_num].display_size / 2,
                    initial_status: field_data[stage_num].initial_status,
                    ghost_status: field_data[stage_num].ghost_status
                }
                player_array.push(new player(options));
                key_counter[i] = 0;
            }

            if (player_array[0].punch_F) {
                document.getElementById("punch_button").style.display = "block";
                document.getElementById("punch_key").style.display = "block";
            }
            if (singlemode_F == false) {
                Field.set_hurryblock(57);
            }
        }

        function initialize_random() {
            Math.random.seed = (function me(s) {
                // Xorshift128 (init seed with Xorshift32)
                s ^= s << 13; s ^= 2 >>> 17; s ^= s << 5;
                let x = 123456789 ^ s;
                s ^= s << 13; s ^= 2 >>> 17; s ^= s << 5;
                let y = 362436069 ^ s;
                s ^= s << 13; s ^= 2 >>> 17; s ^= s << 5;
                let z = 521288629 ^ s;
                s ^= s << 13; s ^= 2 >>> 17; s ^= s << 5;
                let w = 88675123 ^ s;
                let t;
                Math.random = function () {
                    t = x ^ (x << 11);
                    x = y; y = z; z = w;
                    // >>>0 means 'cast to uint32'
                    w = ((w ^ (w >>> 19)) ^ (t ^ (t >>> 8))) >>> 0;
                    return w / 0x100000000;
                };
                Math.random.seed = me;
                return me;
            })(0);
        }

        function game_end() {
            while (Field.hurryblocks_time_ID.length > 0) {
                clearTimeout(Field.hurryblocks_time_ID.shift());
            }
            document.onkeydown = "";
            let rank = Object.keys(users).filter(value => users[value].endtime > users[my_username].endtime).length
            document.getElementById("fade_layer").style.display = "block";
            document.getElementById("end_dialog").style.display = "block"
            document.getElementById("end_message").innerHTML += "<br><br>" + (rank + 1) + " 位"
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　Socket.io 処理　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        function call_emit(code, data) {
            if (singlemode_F == false) {
                socket.emit("call", { [code]: data })
            }
        }

        function initialize_snapshot() {
            for (let i = 0; i < user_names.length - 1; i++) {
                socket.on(battle_code + user_names[i + 1] + "move", function (doc) {
                    let p = player_array[i + 1]
                    p.sprite.move_to(doc[0], doc[1]);
                    p.position_x = doc[0];
                    p.position_y = doc[1];
                    document.getElementById("playername" + p.player_num).style.left = String(p.position_x - p.display_size / 2) + "px";
                    document.getElementById("playername" + p.player_num).style.top = String(p.position_y - p.display_size * 1.7) + "px";
                    document.getElementById("playername" + p.player_num).style.zIndex = String(Math.floor(p.position_y / p.field.block_size) * 30);
                    let block = p.field.get_block(doc[0], doc[1])
                    if (block > 0 && block < 999) {
                        p.field.put_block(doc[0], doc[1], block - block % 100);
                    }
                    p.sprite.change_kind(doc[2]);
                    let az, ax;
                    if (p.ghost_F) {
                        [az, ax] = [[49, 0.45], [51, -0.1], [51, 0.45], [51, 1]][doc[3]];
                    } else {
                        [az, ax] = [[-2, 0.45], [0, 0.2], [0, 0.45], [0, 0.7]][doc[3]];
                    }
                    p.bomb_sprite.z_index(az);
                    p.bomb_sprite.off_x = p.off_x * ax;
                    p.bomb_sprite.move_to(doc[0], doc[1]);
                })
                socket.on(battle_code + user_names[i + 1] + "bomb", function (doc) {
                    let p = player_array[i + 1]
                    let x, y
                    [x, y] = p.field.conv_xy(doc[0], doc[1]).map(value => value * p.field.block_size + p.field.block_size / 2)
                    bomb_put(p.field, x, y, p.block_size / 4, i + 1, doc[2], doc[3], p.block_size / 2, doc[4]);
                })

                socket.on(battle_code + user_names[i + 1] + "item", function (doc) {
                    player_array[i + 1].field.put_block(doc[0], doc[1], 0);
                })
                socket.on(battle_code + user_names[i + 1] + "kick", function (doc) {
                    let [bomb_id, speed_x, speed_y] = doc;
                    bomb_array.forEach((value) => {
                        if (value.bomb_id == bomb_id) {
                            value.kicked(speed_x, speed_y);
                        }
                    })
                })
                socket.on(battle_code + user_names[i + 1] + "punch", function (doc) {
                    let [bomb_id, distance_x, distance_y] = doc;
                    bomb_array.forEach((value) => {
                        if (value.bomb_id == bomb_id) {
                            value.punched(distance_x, distance_y);
                        }
                    })
                })

                socket.on(battle_code + user_names[i + 1] + "powerglove", function (doc) {
                    bomb_array.forEach((value) => {
                        if (value.bomb_id == doc) {
                            while (value.timeout_ID.length > 0) {
                                clearTimeout(value.timeout_ID.shift());
                            }
                            value.field.field_array.forEach((value0, y) => {
                                value0.forEach((value1, x) => {
                                    if (value1 == value.bomb_id + 5000) {
                                        value.field.put_array(x, y, 0);
                                    }
                                })
                            })
                            value.sprite.erase();
                            value.destroy = true;
                            bomb_erase();
                        }
                    })
                    player_array[i + 1].bomb_sprite.visible(true);
                })

                socket.on(battle_code + user_names[i + 1] + "powerglove_end", function (doc) {
                    let p = player_array[i + 1]
                    let [ox, oy] = [[0, -1], [1, 0], [0, 1], [-1, 0]][doc[3]];
                    bomb_put(p.field, doc[0], doc[1], p.block_size / 4, p.player_num, p.burst_distance, doc[2], p.block_size / 2, doc[5]);
                    bomb_array.forEach((value) => {
                        if (value.bomb_id == doc[2]) {
                            value.punched(ox * doc[4], oy * doc[4]);
                        }
                    })
                    p.bomb_sprite.visible(false);
                })
            }

            for (let i = 0; i < user_names.length; i++) {
                socket.on(battle_code + user_names[i] + "start", function (doc) {
                    users[user_names[i]].start = true;
                    users[user_names[i]].stage = doc.stage;
                    if (Object.keys(users).map(value => users[value].start).every(value => value) == true) {
                        call_emit(battle_code + user_names[i] + "allstarted", Object.keys(users).map(value => users[value].stage));
                    }
                })
                socket.on(battle_code + user_names[i] + "allstarted", function (doc) {
                    stage_order = shuffle_array(doc)
                    if (gamestart_F == false) {
                        gamestart_F = true;
                        game_start(stage_order[0]);
                    }
                })
                socket.on(battle_code + user_names[i] + "end", function (doc) {
                    if (gameend_F == true) {
                        return;
                    }
                    let [x, y] = [player_array[i].ghost_x, player_array[i].ghost_y];
                    if (users[doc["player"]] != undefined) {
                        if (users[doc["player"]].end && doc["ghost_F"]) {
                            users[doc["player"]].end = undefined;
                            [x, y] = [doc["position"][0], doc["position"][1]];
                            if (doc["player"] == my_username) {
                                call_emit(battle_code + my_username + "revive", [player_array[i].position_x, player_array[i].position_y])
                            }
                        }
                    }
                    users[user_names[i]].endtime = performance.now();
                    users[user_names[i]].end = doc["died"];      // true: died  false: end without death
                    player_array[i].items = doc["items"];
                    if (users[user_names[i]].end) {
                        player_array[i].die(x, y);
                    }
                    if (Object.keys(users).map(value => users[value].end).every(value => value == true || value == false)) {   //生死を問わず全員ゲーム終了
                        gameend_F = true;
                        setTimeout(game_end, 750);
                    } else if (users[my_username].end == undefined && Object.keys(users).map(value => users[value].end).filter(value => value).length == user_names.length - 1) {
                        //自分は終わっていないが、敵が全員死亡した場合
                        call_emit(battle_code + my_username + "end", { died: false, player: undefined, ghost_F: false })
                    }
                })
                socket.on(battle_code + user_names[i] + "burst", function (doc) {
                    bomb_array.forEach(value => {
                        if (value.bomb_id == doc[0]) {
                            value.position_x = doc[1];
                            value.position_y = doc[2];
                            value.burst();
                        }
                    })
                })
                socket.on(battle_code + user_names[i] + "vanish", function (doc) {
                    bomb_array.forEach(value => {
                        if (value.bomb_id == doc) {
                            value.vanish();
                        }
                    })
                })
                socket.on(battle_code + user_names[i] + "revive", function (doc) {
                    player_array[i].revive(doc[0], doc[1]);
                })


            }

        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　Playerのアクション　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        function input_to_action(player_num) {
            let move_F = false;
            let p = player_array[player_num]

            if (player_array[player_num].die_F) {
                return
            }
            if (key_input[player_num]["up"]) {
                p.move(0, -p.move_speed * key_input[player_num]["strength"]);
                move_F = true;
            }
            if (key_input[player_num]["down"]) {
                p.move(0, p.move_speed * key_input[player_num]["strength"]);
                move_F = true;
            }
            if (key_input[player_num]["right"]) {
                p.move(p.move_speed * key_input[player_num]["strength"], 0);
                move_F = true;
            }
            if (key_input[player_num]["left"]) {
                p.move(- p.move_speed * key_input[player_num]["strength"], 0);
                move_F = true;
            }

            if (player_num == 0 && move_F) {
                call_emit(battle_code + my_username + "move", [p.position_x, p.position_y, p.sp_num[p.sp_angle][Math.floor(key_counter[0] % 8)], p.sp_angle]);
            }
        }

        function space_to_action(player_num) {
            if (player_array[player_num].die_F) {
                return
            }
            let p = player_array[player_num]
            let bomb_id = user_order.indexOf(my_username) * 100 + bomb_counter;
            if (p.ghost_F) {
                let bomb_num = bomb_array.filter((value) => value.player_num == player_num).length;
                if (bomb_num < p.bomb_max) {
                    let x, y
                    [x, y] = p.field.conv_xy(p.position_x, p.position_y).map(value => value * p.field.block_size + p.field.block_size / 2)
                    player_array[player_num].bombholding_F = true;
                    player_array[player_num].bomb_sprite.visible(true);
                    call_emit(battle_code + my_username + "powerglove", bomb_id)
                }
            } else {
                spacetime_ID.push(setTimeout(function () { player_array[player_num].powerglove() }.bind(this), spacetime));
                let bomb_num = bomb_array.filter((value) => value.player_num == player_num).length;
                if (bomb_num < p.bomb_max) {
                    let [x, y] = p.field.std_xy(p.position_x, p.position_y);
                    bomb_put(p.field, x, y, p.block_size / 4, player_num, p.burst_distance, bomb_id, p.block_size / 2, false);
                    call_emit(battle_code + my_username + "bomb", [p.position_x, p.position_y, p.burst_distance, bomb_id, p.ghost_F]);
                }
            }
        }

        function punch_action(player_num) {
            let p = player_array[player_num]
            if (p.punch_F) {
                let [ox, oy] = [[0, -1], [1, 0], [0, 1], [-1, 0]][p.sp_angle];
                let [x, y] = p.field.conv_xy(p.position_x, p.position_y)
                let block = p.field.field_array[y + oy][x + ox]
                if (block >= 5000) {
                    p.punch(ox * 3, oy * 3, block - 5000)
                }
            }
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　ボタン設置　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        function active_button_set(button_name, callback1, callback2) {
            if (!navigator.userAgent.match(/(iPhone|iPad|iPod|Android)/)) {
                document.getElementById(button_name).onmousedown = callback1;
                document.getElementById(button_name).onmouseup = callback2;
            }

            let touch_target = document.getElementById(button_name);
            touch_target.addEventListener("touchstart", function (event) {
                event.target.classList.add('pressed')
                callback1()
            }, false);
            touch_target.addEventListener("touchend", function (event) {
                event.target.classList.remove('pressed')
                callback2();
            }, false);
        }


        function button_set(button_name, callback) {
            if (!navigator.userAgent.match(/(iPhone|iPad|iPod|Android)/)) {
                document.getElementById(button_name).onmouseup = callback;
            }
            document.getElementById(button_name).addEventListener("touchstart", function (event) {
                event.target.classList.add('pressed')
            }, false);
            document.getElementById(button_name).addEventListener("touchend", function (event) {
                event.target.classList.remove('pressed')
                callback();
            }, false);

        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　キーボード入力　　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

        var key_event_ID;
        key_input[0] = { space: false, n: false };

        document.onkeydown = function () { keyboard(event.keyCode) }

        function keyboard(keycode) {
            if (gamestart_F == false) {
                return;
            }
            let key_change_F = false;
            let key_space_F = false;
            switch (keycode) {
                case 38:	// 上
                    key_change_F = (key_input[0]["up"] ? false : true);
                    key_input[0]["up"] = true;
                    key_input[0]["strength"] = 1;
                    break;
                case 40:	//下
                    key_change_F = (key_input[0]["down"] ? false : true);
                    key_input[0]["down"] = true;
                    key_input[0]["strength"] = 1;
                    break;
                case 39:	//右
                    key_change_F = (key_input[0]["right"] ? false : true);
                    key_input[0]["right"] = true;
                    key_input[0]["strength"] = 1;
                    break;
                case 37:	//左
                    key_change_F = (key_input[0]["left"] ? false : true);
                    key_input[0]["left"] = true;
                    key_input[0]["strength"] = 1;
                    break;
                case 32:	//スペース
                    if (key_input[0]["space"] == false) {
                        key_input[0]["space"] = true;
                        space_to_action(0);
                    }
                    break;
                case 78:	// n パンチ
                    if (key_input[0]["n"] == false) {
                        key_input[0]["n"] = true;
                        punch_action(0);
                    }
                    break;
            }
            if (key_change_F) {
                clearTimeout(key_event_ID);
                key_press(0);
            }
        }


        document.onkeyup = function () { keyboardup(event.keyCode) }
        function keyboardup(keycode) {
            switch (keycode) {
                case 38:	// 上
                    key_input[0]["up"] = false;
                    break;
                case 40:	//下
                    key_input[0]["down"] = false;
                    break;
                case 39:	//右
                    key_input[0]["right"] = false;
                    break;
                case 37:	//左
                    key_input[0]["left"] = false;
                    break;
                case 32:	//スーペース
                    if (key_input[0]["space"] == true) {
                        while (spacetime_ID.length > 0) {
                            clearTimeout(spacetime_ID.shift());
                        }
                        key_input[0]["space"] = false;
                        if (player_array[0].bombholding_F && player_array[0].powerglove_F) {
                            player_array[0].powerglove_end(player_array[0].powerglove_power, player_array[0].ghost_F);
                        }
                    }
                    break;
                case 78:	// n パンチ
                    key_input[0]["n"] = false;
                    break;
            }
            if (Object.keys(key_input[0]).every(value => value == "strength" || value == "space" || value == "n" || key_input[0][value] == false)) {
                key_unpress(0);
            }
        }

        function key_press(player_num) {
            input_to_action(player_num);
            key_counter[player_num] += key_input[0]["strength"];
            key_event_ID = setTimeout(function () { key_press(player_num) }, 25);
        }

        function key_unpress(player_num) {
            clearTimeout(key_event_ID);
            key_counter[player_num] = 0;
        }

        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        //～～～～～～～～～　　　　タッチパネル入力　　　　～～～～～～～～～
        //～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
        document.getElementById("whole").addEventListener('touchstart', function (event) {
            event.preventDefault();
        }, { passive: false });

        var touch_area = document.getElementById('touch_area');

        let move_sense = 1;
        let movesense_max = 25;
        let touch_start_x, touch_start_y, touch_move_x, touch_move_y, slidepadback_x, slidepadback_y;
        let touch_adjust_x = 20;

        touch_area.addEventListener('touchstart', function (event) {
            touch_start_x = slidepadback_x = event.targetTouches[0].pageX;
            touch_start_y = slidepadback_y = event.targetTouches[0].pageY;
            document.getElementById("slidepadback").style.left = String(touch_start_x - 52 + touch_adjust_x) + "px"
            document.getElementById("slidepadback").style.top = String(touch_start_y - 52) + "px"
            document.getElementById("slidepad").style.left = String(touch_start_x - 25 + touch_adjust_x) + "px"
            document.getElementById("slidepad").style.top = String(touch_start_y - 25) + "px"
        }, false);


        touch_area.addEventListener('touchmove', function (event) {
            event.preventDefault(); // タッチによる画面スクロールを止める
            touch_move_x = event.targetTouches[0].pageX;
            touch_move_y = event.targetTouches[0].pageY;
            let strength = 0;
            let l = Math.sqrt(Math.pow(touch_move_x - slidepadback_x, 2) + Math.pow(touch_move_y - slidepadback_y, 2));
            if (l > 25) {
                slidepadback_x += touch_move_x - slidepadback_x - (touch_move_x - slidepadback_x) * 25 / l;
                slidepadback_y += touch_move_y - slidepadback_y - (touch_move_y - slidepadback_y) * 25 / l;
                document.getElementById("slidepadback").style.left = String(slidepadback_x - 52 + touch_adjust_x) + "px"
                document.getElementById("slidepadback").style.top = String(slidepadback_y - 52) + "px"
            }
            document.getElementById("slidepad").style.left = String(touch_move_x - 25 + touch_adjust_x) + "px"
            document.getElementById("slidepad").style.top = String(touch_move_y - 25) + "px"
            let key_change_F = false;

            let a = (touch_move_y - (slidepadback_y + 0)) / (touch_move_x - slidepadback_x)

            if ((a > 1 || a < -1) && (slidepadback_y + 0) - touch_move_y > move_sense) {
                if (key_input[0]["up"] != true) {
                    key_change_F = true;
                }
                key_input[0]["up"] = true;
                key_input[0]["left"] = false;
                key_input[0]["right"] = false;
                key_input[0]["down"] = false;

                strength = (slidepadback_y + 0) - touch_move_y;
                strength = (strength > movesense_max ? movesense_max : strength) / movesense_max;
                key_input[0]["strength"] = strength;
                touch_start_x = touch_move_x;
                touch_start_y = touch_move_y;

            } else if ((a > 1 || a < -1) && touch_move_y - (slidepadback_y + 0) > move_sense) {
                if (key_input[0]["down"] != true) {
                    key_change_F = true;
                }
                key_input[0]["down"] = true;
                key_input[0]["left"] = false;
                key_input[0]["up"] = false;
                key_input[0]["right"] = false;

                strength = touch_move_y - (slidepadback_y + 0);
                strength = (strength > movesense_max ? movesense_max : strength) / movesense_max;
                key_input[0]["strength"] = strength;
                touch_start_x = touch_move_x;
                touch_start_y = touch_move_y;

            } else if ((a <= 1 && a >= -1) && (slidepadback_x + 0) - touch_move_x > move_sense) {
                if (key_input[0]["left"] != true) {
                    key_change_F = true;
                }
                key_input[0]["left"] = true;
                key_input[0]["right"] = false;
                key_input[0]["up"] = false;
                key_input[0]["down"] = false;

                strength = (slidepadback_x + 0) - touch_move_x;
                strength = (strength > movesense_max ? movesense_max : strength) / movesense_max;
                key_input[0]["strength"] = strength;
                touch_start_x = touch_move_x;
                touch_start_y = touch_move_y;

            } else if ((a <= 1 && a >= -1) && touch_move_x - (slidepadback_x + 0) > move_sense) {
                if (key_input[0]["right"] != true) {
                    key_change_F = true;
                }
                key_input[0]["right"] = true;
                key_input[0]["left"] = false;
                key_input[0]["up"] = false;
                key_input[0]["down"] = false;

                strength = touch_move_x - (slidepadback_x + 0);
                strength = (strength > movesense_max ? movesense_max : strength) / movesense_max;
                key_input[0]["strength"] = strength;
                touch_start_x = touch_move_x;
                touch_start_y = touch_move_y;
            }

            if (key_change_F) {
                clearTimeout(key_event_ID);
                key_press(0);
            }
        }, false);

        touch_area.addEventListener('touchend', function (event) {
            key_input[0]["right"] = false;
            key_input[0]["left"] = false;
            key_input[0]["up"] = false;
            key_input[0]["down"] = false;
            document.getElementById("slidepadback").style.left = "30px"
            document.getElementById("slidepadback").style.top = ""
            document.getElementById("slidepadback").style.bottom = (140 - punchbutton_adjust_y) + "px"
            document.getElementById("slidepad").style.left = "57px"
            document.getElementById("slidepad").style.top = ""
            document.getElementById("slidepad").style.bottom = (167 - punchbutton_adjust_y) + "px"
            key_unpress(0);

        }, false);
    </script>

</body>

</html>